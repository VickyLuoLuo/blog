{"meta":{"version":1,"warehouse":"3.0.2"},"models":{"Asset":[{"_id":"source/CNAME","path":"CNAME","modified":0,"renderable":0},{"_id":"source/LICENSE","path":"LICENSE","modified":0,"renderable":0},{"_id":"themes/livemylife/source/baidu_verify_code-jayy2pLM52.html","path":"baidu_verify_code-jayy2pLM52.html","modified":0,"renderable":1},{"_id":"themes/livemylife/source/baidu_verify_code-rpJMBPgyFA.html","path":"baidu_verify_code-rpJMBPgyFA.html","modified":0,"renderable":1},{"_id":"themes/livemylife/source/google0915f5e354aeae89.html","path":"google0915f5e354aeae89.html","modified":0,"renderable":1},{"_id":"source/img/avatar/avatar.png","path":"img/avatar/avatar.png","modified":0,"renderable":0},{"_id":"source/img/avatar/fatpeople.jpg","path":"img/avatar/fatpeople.jpg","modified":0,"renderable":0},{"_id":"source/img/signature/vicky-white.png","path":"img/signature/vicky-white.png","modified":0,"renderable":0},{"_id":"themes/livemylife/source/css/archive.styl","path":"css/archive.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/catalog.styl","path":"css/catalog.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/highlight.styl","path":"css/highlight.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/gitalk.css","path":"css/gitalk.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/highlight_normal.css","path":"css/highlight_normal.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/hux-blog.min.css","path":"css/hux-blog.min.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/search.css","path":"css/search.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/rocket.styl","path":"css/rocket.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/scroll.css","path":"css/scroll.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/livemylife.css","path":"css/livemylife.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/signature.styl","path":"css/signature.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/top.css","path":"css/top.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/viewer.min.css","path":"css/viewer.min.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/themecolor.css","path":"css/themecolor.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/wave.css","path":"css/wave.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/widget.styl","path":"css/widget.styl","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/beantech.css","path":"css/beantech.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.eot","path":"fonts/glyphicons-halflings-regular.eot","modified":0,"renderable":1},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.woff2","path":"fonts/glyphicons-halflings-regular.woff2","modified":0,"renderable":1},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.ttf","path":"fonts/glyphicons-halflings-regular.ttf","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/beantech.min.css","path":"css/beantech.min.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.woff","path":"fonts/glyphicons-halflings-regular.woff","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/busuanzi.pure.mini.js","path":"js/busuanzi.pure.mini.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/bootstrap.min.js","path":"js/bootstrap.min.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/catalog.js","path":"js/catalog.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/hux-blog.min.js","path":"js/hux-blog.min.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/hux-blog.js","path":"js/hux-blog.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/jquery.nav.js","path":"js/jquery.nav.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/jquery.tagcloud.js","path":"js/jquery.tagcloud.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/scroll.js","path":"js/scroll.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/themecolor.js","path":"js/themecolor.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/totop.js","path":"js/totop.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/ziploader.js","path":"js/ziploader.js","modified":0,"renderable":1},{"_id":"source/img/avatar/about-me.jpg","path":"img/avatar/about-me.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/archive_bg.jpg","path":"img/header_img/archive_bg.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/categories_bg.jpg","path":"img/header_img/categories_bg.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/post-bg-desk.jpg","path":"img/header_img/post-bg-desk.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/home-bg.jpg","path":"img/header_img/home-bg.jpg","modified":0,"renderable":0},{"_id":"source/img/scenery/about_bg.jpg","path":"img/scenery/about_bg.jpg","modified":0,"renderable":0},{"_id":"themes/livemylife/source/css/bootstrap.min.css","path":"css/bootstrap.min.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.svg","path":"fonts/glyphicons-halflings-regular.svg","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/bootstrap.js","path":"js/bootstrap.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/jquery.min.js","path":"js/jquery.min.js","modified":0,"renderable":1},{"_id":"source/img/1-work/tools/create_gitee_repo.png","path":"img/1-work/tools/create_gitee_repo.png","modified":0,"renderable":0},{"_id":"source/img/1-work/tools/import-github-repo.png","path":"img/1-work/tools/import-github-repo.png","modified":0,"renderable":0},{"_id":"source/img/header_img/404_bg.jpg","path":"img/header_img/404_bg.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/ebooks-bg.jpg","path":"img/header_img/ebooks-bg.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/post-bg-swift.jpg","path":"img/header_img/post-bg-swift.jpg","modified":0,"renderable":0},{"_id":"source/img/scenery/about_bg4.jpg","path":"img/scenery/about_bg4.jpg","modified":0,"renderable":0},{"_id":"source/img/scenery/treat_me_to_coffee.jpg","path":"img/scenery/treat_me_to_coffee.jpg","modified":0,"renderable":0},{"_id":"themes/livemylife/source/css/bootstrap.css","path":"css/bootstrap.css","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/images/beside_up2.png","path":"css/images/beside_up2.png","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/images/beside_up.png","path":"css/images/beside_up.png","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/images/beside_up_white.png","path":"css/images/beside_up_white.png","modified":0,"renderable":1},{"_id":"themes/livemylife/source/css/images/beside_up_white2.png","path":"css/images/beside_up_white2.png","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/china-contour.js","path":"js/echarts/china-contour.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/src/chinamap.js","path":"js/src/chinamap.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/viewer/pic-viewer.js","path":"js/viewer/pic-viewer.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/viewer/viewer.min.js","path":"js/viewer/viewer.min.js","modified":0,"renderable":1},{"_id":"source/img/header_img/tag_bg.jpg","path":"img/header_img/tag_bg.jpg","modified":0,"renderable":0},{"_id":"source/img/scenery/about_bg2.jpg","path":"img/scenery/about_bg2.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/dawn.jpg","path":"img/header_img/dawn.jpg","modified":0,"renderable":0},{"_id":"themes/livemylife/source/js/echarts/china.js","path":"js/echarts/china.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/anhui.js","path":"js/echarts/province/anhui.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/aomen.js","path":"js/echarts/province/aomen.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/beijing.js","path":"js/echarts/province/beijing.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/fujian.js","path":"js/echarts/province/fujian.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/guizhou.js","path":"js/echarts/province/guizhou.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/hainan.js","path":"js/echarts/province/hainan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/hebei.js","path":"js/echarts/province/hebei.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/henan.js","path":"js/echarts/province/henan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/hubei.js","path":"js/echarts/province/hubei.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/jiangsu.js","path":"js/echarts/province/jiangsu.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/jilin.js","path":"js/echarts/province/jilin.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/liaoning.js","path":"js/echarts/province/liaoning.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/ningxia.js","path":"js/echarts/province/ningxia.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/jiangxi.js","path":"js/echarts/province/jiangxi.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/qinghai.js","path":"js/echarts/province/qinghai.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/shanghai.js","path":"js/echarts/province/shanghai.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/shandong.js","path":"js/echarts/province/shandong.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/shanxi.js","path":"js/echarts/province/shanxi.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/shanxi1.js","path":"js/echarts/province/shanxi1.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/taiwan.js","path":"js/echarts/province/taiwan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/xizang.js","path":"js/echarts/province/xizang.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/xianggang.js","path":"js/echarts/province/xianggang.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/tianjin.js","path":"js/echarts/province/tianjin.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/jquery.js","path":"js/jquery.js","modified":0,"renderable":1},{"_id":"source/img/avatar/roguerabbit.jpg","path":"img/avatar/roguerabbit.jpg","modified":0,"renderable":0},{"_id":"source/img/header_img/squirrel.jpg","path":"img/header_img/squirrel.jpg","modified":0,"renderable":0},{"_id":"themes/livemylife/source/js/echarts/province/chongqing.js","path":"js/echarts/province/chongqing.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/gansu.js","path":"js/echarts/province/gansu.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/guangxi.js","path":"js/echarts/province/guangxi.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/hunan.js","path":"js/echarts/province/hunan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/heilongjiang.js","path":"js/echarts/province/heilongjiang.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/neimenggu.js","path":"js/echarts/province/neimenggu.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/sichuan.js","path":"js/echarts/province/sichuan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/world.js","path":"js/echarts/world.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/xinjiang.js","path":"js/echarts/province/xinjiang.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/yunnan.js","path":"js/echarts/province/yunnan.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/zhejiang.js","path":"js/echarts/province/zhejiang.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/province/guangdong.js","path":"js/echarts/province/guangdong.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/comment/gitalk.js","path":"js/comment/gitalk.js","modified":0,"renderable":1},{"_id":"themes/livemylife/source/js/echarts/echarts.min.js","path":"js/echarts/echarts.min.js","modified":0,"renderable":1}],"Cache":[{"_id":"source/404.md","hash":"3bdf0ec6214c65c8e924c8f716fe73f13471ae3c","modified":1636551796135},{"_id":"source/CNAME","hash":"fa4ed0bd15b8167ee4e134821e3bb58a69a4d1a9","modified":1636551796135},{"_id":"source/LICENSE","hash":"7df059597099bb7dcf25d2a9aedfaf4465f72d8d","modified":1636551796135},{"_id":"source/_readme.txt","hash":"1d6fc9b02cb7b2438e9e32dc211c801e672c786a","modified":1636551796138},{"_id":"themes/livemylife/_config.yml","hash":"7638a858e59f075c4066eb9ca880f3bce75ccd04","modified":1636551796424},{"_id":"themes/livemylife/LICENSE","hash":"2b209f06bebeb2a8c2b7e187e436f3e1e1fbc8a7","modified":1636551796424},{"_id":"source/_posts/algorithm-datastructure-outline.md","hash":"d8f9a5534bebf646a6d601b7b1001df570936f9c","modified":1649574272800},{"_id":"source/_posts/algorithm-dp-thinking.md","hash":"624c70cefbf770fe944a67e42138eece3d71480b","modified":1650704009786},{"_id":"source/_posts/HTTP.md","hash":"f55d554707d631567a39a6c8f3adadc2b3b56870","modified":1650704341133},{"_id":"source/_posts/algorithm-heap.md","hash":"c2ab6bf954ca98157a7bd14a3d14c03e30f62891","modified":1636551796135},{"_id":"source/_posts/bio-nio-netty.md","hash":"f83a3a8f7fe527097c2f681d545e2d6a5822ec5a","modified":1650704219737},{"_id":"source/_posts/algorithm-segment-tree.md","hash":"16e4f215544617d5d3c3b7d8d7b40878a9ba678d","modified":1650699959865},{"_id":"source/_posts/algorithm-tree.md","hash":"62e1eaba26fc8bb29ebfcc7dfd11a2886a324bc3","modified":1636551796136},{"_id":"source/_posts/algorithm-sort.md","hash":"b900e09094f17b71f9be5349b2df8ceae8516694","modified":1636551796135},{"_id":"source/_posts/centos-config.md","hash":"c8ae6e13e7000b84758496727f971745649225d2","modified":1650704099571},{"_id":"source/_posts/chinamap.md","hash":"36ba243694e51d850ee19e8dcb02895c0bcf64c1","modified":1650704050182},{"_id":"source/_posts/git-reset.md","hash":"e9fc05c89b4593f6e923956812745ded869a3b0f","modified":1650704026153},{"_id":"source/_posts/git-push-error.md","hash":"cd692fa386fb321333c589afa254b4b3526cb7bf","modified":1650704032245},{"_id":"source/_posts/git-push-two-repo.md","hash":"f75811e034b6cd6ea114962ff8661db68c756838","modified":1636551796136},{"_id":"source/_posts/io.md","hash":"d6bb84b5bd979ec853769a3e992ebcb3d09bc447","modified":1636551796137},{"_id":"source/_posts/nginx-cors.md","hash":"3118cb2c56a83c81bdbaf11337687632215c9b75","modified":1636551796138},{"_id":"source/_posts/read-test.md","hash":"2c48de686846485145693e17f559f9d433ceb042","modified":1636551796138},{"_id":"source/_posts/java-nio.md","hash":"478eab136a9c459b02fb55c1f909abfa5bf662dc","modified":1636551796137},{"_id":"source/_posts/java-outline.md","hash":"09460a7ec2a644e1d3ffbc670bb3f077151070e4","modified":1636551796137},{"_id":"source/_posts/read-test2.md","hash":"e1e2a7fb899b4bea2da057e5fdfab40cc87b3533","modified":1636551796138},{"_id":"source/_posts/source-code.md","hash":"690d6a90e2bc397cecfbeb92dad8a4ed889cc635","modified":1650703961839},{"_id":"source/_posts/redis.md","hash":"698cabf5d93675d7b2b5acdc1ffc6ceb3de910f5","modified":1650704066582},{"_id":"source/ebooks/index.md","hash":"2b64f3f75175fb2fe119cf1e3f9623ded7ab2c9e","modified":1638972933827},{"_id":"source/about/index.md","hash":"00bbdbf721b12f9db3eb0aed17c549286812c2f5","modified":1636551796138},{"_id":"source/categories/index.md","hash":"91fff40dea4be55c903b76375ed43a88f67cf4f9","modified":1636551796139},{"_id":"source/archive/index.md","hash":"f7439e98582e265745f2301fb980a1940426c8b7","modified":1636551796139},{"_id":"source/tags/index.md","hash":"e4060fc3a8aa9de589a6b5ab12ae2210d3db2b51","modified":1636551796424},{"_id":"themes/livemylife/languages_to_be_added/de.yml","hash":"424a9c1e6ab69334d7873f6574da02ca960aa572","modified":1636551796425},{"_id":"themes/livemylife/languages_to_be_added/default.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1636551796425},{"_id":"themes/livemylife/languages_to_be_added/es.yml","hash":"cb4eeca0ed3768a77e0cd216300f2b2549628b1b","modified":1636551796426},{"_id":"themes/livemylife/languages_to_be_added/en.yml","hash":"97326c9e6518d9f379778178b3b8f9a58434725d","modified":1636551796426},{"_id":"themes/livemylife/languages_to_be_added/pl.yml","hash":"de7eb5850ae65ba7638e907c805fea90617a988c","modified":1636551796426},{"_id":"themes/livemylife/languages_to_be_added/no.yml","hash":"8ca475a3b4f8efe6603030f0013aae39668230e1","modified":1636551796426},{"_id":"themes/livemylife/languages_to_be_added/ru.yml","hash":"42df7afeb7a35dc46d272b7f4fb880a9d9ebcaa5","modified":1636551796426},{"_id":"themes/livemylife/layout/404.ejs","hash":"a4d73541a53e56b7dd46249c6d27cb59f4d97422","modified":1636551796427},{"_id":"themes/livemylife/languages_to_be_added/zh-CN.yml","hash":"7bfcb0b8e97d7e5edcfca8ab26d55d9da2573c1c","modified":1636551796427},{"_id":"themes/livemylife/layout/archive.ejs","hash":"13df65b0707210c0960d193001cce7f363df509a","modified":1636551796431},{"_id":"themes/livemylife/layout/about.ejs","hash":"9dbbb4fd7d0a08c766e71a161650704a507b854c","modified":1636551796431},{"_id":"themes/livemylife/layout/categories.ejs","hash":"fa1d1bebf4c696929c8c89a127fa4b64cd478d0f","modified":1636551796431},{"_id":"themes/livemylife/layout/index.ejs","hash":"0e06c2c74b646a8610b4c1e014935617b4871cc0","modified":1636551796431},{"_id":"themes/livemylife/layout/keynote.ejs","hash":"549ab47e8b6b384cd935882d67a8ceb3e9c3f6f5","modified":1636551796431},{"_id":"themes/livemylife/languages_to_be_added/zh-TW.yml","hash":"9acac6cc4f8002c3fa53ff69fb8cf66c915bd016","modified":1636551796427},{"_id":"themes/livemylife/layout/layout.ejs","hash":"2d2ca4424de53e9b52318750e4b1b8aa27ee3101","modified":1636551796432},{"_id":"themes/livemylife/layout/page.ejs","hash":"5b894299659f66162e01ee8bc73678aad1ac04c6","modified":1636551796432},{"_id":"themes/livemylife/layout/post.ejs","hash":"62dac197816ff4b2e95ceb57bdf6c501b393d13d","modified":1636551796432},{"_id":"themes/livemylife/layout/tags.ejs","hash":"bcbde51624034c243ea0649099d0f1600ae00f71","modified":1636551796432},{"_id":"themes/livemylife/source/baidu_verify_code-jayy2pLM52.html","hash":"58fc353e353e2dedb8bcd7f9ffe62ec1b2ba81d7","modified":1636551796432},{"_id":"themes/livemylife/source/baidu_verify_code-rpJMBPgyFA.html","hash":"7ee3e15a6b854a6f1131bf731fff4c9d61b8f431","modified":1636551796432},{"_id":"themes/livemylife/source/google0915f5e354aeae89.html","hash":"dacc570438035c30f92d0c9d97eacc9b0f09cc46","modified":1636551796442},{"_id":"source/img/avatar/avatar.png","hash":"e6c1c40fb523d94779d95aa2dc7bf0b4259bacf2","modified":1636551796140},{"_id":"source/img/avatar/fatpeople.jpg","hash":"04cc046c50473ab78aee784df62f05448be8b884","modified":1636551796141},{"_id":"source/img/signature/vicky-white.png","hash":"efb6c7e1ccbded551759c9997b108a20c15f0c09","modified":1636551796424},{"_id":"themes/livemylife/layout/_partial/catalog.ejs","hash":"98e4dece360e03ac0e43acec95239b9b3157f398","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/comment.ejs","hash":"842c1afa76d8d802db0a5dbe02967e2bf87289cc","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/footer.ejs","hash":"61418f8e06c8f7b4cace484ebcccffc1eed9deb2","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/gitter.ejs","hash":"a492bfd63baddc70a082643178d0bdf4385ea126","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/anchorjs.ejs","hash":"9a9ff58f3767c7d23c029fcb2030ea353824f79a","modified":1636551796427},{"_id":"themes/livemylife/layout/_partial/head.ejs","hash":"9abb5ef8026a44bb8b3d149dfc728537322cdeb6","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/pagination.ejs","hash":"557d6bb069a1d48af49ae912994653f44b32a570","modified":1636551796429},{"_id":"themes/livemylife/layout/_partial/search.ejs","hash":"3651c99b9284cdad8a22979c4e6e03e7ca1b5151","modified":1636551796429},{"_id":"themes/livemylife/layout/_partial/header.ejs","hash":"c2299bfff6d8437417960a814ef887bbd232634e","modified":1636551796428},{"_id":"themes/livemylife/layout/_partial/socialshare.ejs","hash":"1df693cf21a2f4af133fb0da0d2352ee2aa556e0","modified":1636551796429},{"_id":"themes/livemylife/layout/_partial/sidebar.ejs","hash":"2e4e528a555917b2a267da4db2440bcc4a7a65ab","modified":1636551796429},{"_id":"themes/livemylife/layout/_partial/themecolor.ejs","hash":"e9472d324af1eb821550b64834e198753b46e4d7","modified":1636551796429},{"_id":"themes/livemylife/layout/_partial/nav.ejs","hash":"5245e5f32f041a78163c31187634960bc373cb49","modified":1637991881476},{"_id":"themes/livemylife/layout/_widget/archive.ejs","hash":"f896506edb810b1d3fe479c03ac92ab627ea21e6","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/featured-tags.ejs","hash":"4e8fdc9890d281e6a22a9032098d6ef15eef7848","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/recent-posts.ejs","hash":"257a486fd4bfac693201818efb198d7c8fcf19ba","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/category.ejs","hash":"15f667fc7a69eb2b738672ccb7a9072d2bdec140","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/friends-blog.ejs","hash":"4fe9d34bc9b8fc89b2b339496f3f0dae1e0c7fee","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/short-about.ejs","hash":"038032cf6e205aa8f07d65819deec2339d9376a4","modified":1636551796430},{"_id":"themes/livemylife/layout/_widget/visitor.ejs","hash":"61f5d15d6be1f047b06a736c3e39457bd36dedcd","modified":1636551796431},{"_id":"themes/livemylife/source/css/archive.styl","hash":"715bcbd085eb95ec26c9805c11c374919cde971c","modified":1636551796433},{"_id":"themes/livemylife/source/css/catalog.styl","hash":"6c9a2d5f6f981624e0c4b64323493e8614efea29","modified":1636551796435},{"_id":"themes/livemylife/source/css/highlight.styl","hash":"e842080e6d580f0f70a7df71fbde3c4e49463c19","modified":1636551796435},{"_id":"themes/livemylife/source/css/gitalk.css","hash":"51783fd60dff05e8e339ff83b41504538662f6ca","modified":1636551796435},{"_id":"themes/livemylife/source/css/highlight_normal.css","hash":"6a40a9a0f268fb17d9002cb49a16946444ef5f34","modified":1636551796436},{"_id":"themes/livemylife/source/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1636551796436},{"_id":"themes/livemylife/source/css/search.css","hash":"a941f2f3d05d43e0a1517ae6923e848638b9ff7c","modified":1636551796439},{"_id":"themes/livemylife/source/css/rocket.styl","hash":"7c08bbc803a9d191e495ffc22a6530d602ec45cf","modified":1636551796439},{"_id":"themes/livemylife/source/css/scroll.css","hash":"254c14f514de149e1d95a9c583e8af0dbacb306d","modified":1636551796439},{"_id":"themes/livemylife/source/css/livemylife.css","hash":"dbf2b89627f55e7f8ef12730e822319859f25767","modified":1636551796439},{"_id":"themes/livemylife/source/css/signature.styl","hash":"88159b31c59d59c01a0b534af57242662a2a3969","modified":1636551796440},{"_id":"themes/livemylife/source/css/top.css","hash":"0303375fbe2ca942cd3d86f31d12fef9bf5785af","modified":1636551796440},{"_id":"themes/livemylife/source/css/viewer.min.css","hash":"0e045aa3df1be7d138caa701ec3aa623ccc7a52d","modified":1636551796440},{"_id":"themes/livemylife/source/css/themecolor.css","hash":"725b0e534f7c6c80e2e9a47d1c93ee9f03d7458a","modified":1636551796440},{"_id":"themes/livemylife/source/css/wave.css","hash":"041f3b4a78e2840ba17679cea05fb14bb646722f","modified":1636551796440},{"_id":"themes/livemylife/source/css/widget.styl","hash":"7a9f735f5ef323dc2950fbd9d76daa16c9a0f1a9","modified":1636551796441},{"_id":"themes/livemylife/source/css/beantech.css","hash":"c192d3170301f774fa4c2185dc125cb3d6ec4929","modified":1636551796433},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1636551796441},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1636551796442},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1636551796442},{"_id":"themes/livemylife/source/css/beantech.min.css","hash":"66f124242893cae4517119e39e75d7f23eef01ae","modified":1636551796433},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1636551796442},{"_id":"themes/livemylife/source/js/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1636551796443},{"_id":"themes/livemylife/source/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1636551796443},{"_id":"themes/livemylife/source/js/catalog.js","hash":"059f3f31492e5b1a9dddf422a48c32969d247415","modified":1636551796443},{"_id":"themes/livemylife/source/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1636551796472},{"_id":"themes/livemylife/source/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1636551796472},{"_id":"themes/livemylife/source/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1636551796475},{"_id":"themes/livemylife/source/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1636551796475},{"_id":"themes/livemylife/source/js/scroll.js","hash":"265a4c4fc33b5b44b620db64ff31d2bc05d233e9","modified":1636551796475},{"_id":"themes/livemylife/source/js/themecolor.js","hash":"8295e112233778d8f20c31b06c19659f60edbb22","modified":1636551796475},{"_id":"themes/livemylife/source/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1636551796476},{"_id":"themes/livemylife/source/js/ziploader.js","hash":"9c25324caf53b56cb68839dcfb34e61e5a6a63f3","modified":1636551796477},{"_id":"source/img/avatar/about-me.jpg","hash":"4fc7c645f502bb38cb2a672bd95d478e8be0493a","modified":1636551796140},{"_id":"source/img/header_img/archive_bg.jpg","hash":"fc4bdf7fa98346ea35115151e4914cd1e5a946d9","modified":1636551796329},{"_id":"source/img/header_img/categories_bg.jpg","hash":"a8a46a06f566e13a919d9cbca6a66ae5a3b78b1e","modified":1636551796371},{"_id":"source/img/header_img/post-bg-desk.jpg","hash":"6bbe3de397f929a7ca0a49c88779a4a8dd904a88","modified":1636551796413},{"_id":"source/img/header_img/home-bg.jpg","hash":"6bbe3de397f929a7ca0a49c88779a4a8dd904a88","modified":1636551796373},{"_id":"source/img/scenery/about_bg.jpg","hash":"462c14b9b00ab2153e579f14cb1e44aa56704ce8","modified":1636551796417},{"_id":"themes/livemylife/source/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1636551796435},{"_id":"themes/livemylife/source/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1636551796441},{"_id":"themes/livemylife/source/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1636551796443},{"_id":"themes/livemylife/source/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1636551796474},{"_id":"source/img/1-work/tools/create_gitee_repo.png","hash":"ebd7bd2ba944d5428c2f8b0f58e2d4477952ee63","modified":1636551796139},{"_id":"source/img/1-work/tools/import-github-repo.png","hash":"4ecfeb1dd598d0a17e278da065c38a5523823250","modified":1636551796140},{"_id":"source/img/header_img/404_bg.jpg","hash":"e51ce60c4e13cfd57c825d241dae23ac988cd796","modified":1650704342329},{"_id":"source/img/header_img/ebooks-bg.jpg","hash":"84b61541d90457dbc74fd3a6aa91029e61524a2a","modified":1637991881475},{"_id":"source/img/header_img/post-bg-swift.jpg","hash":"12552e545ca35a93f0050a5417de5d302f1a4f5e","modified":1636551796414},{"_id":"source/img/scenery/about_bg4.jpg","hash":"272f0d4233aea38f32311439f8528d2b3bebd546","modified":1636551796419},{"_id":"source/img/scenery/treat_me_to_coffee.jpg","hash":"e307178429b98962ff3918e12427b3e7db6d10df","modified":1636551796420},{"_id":"themes/livemylife/source/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1636551796434},{"_id":"themes/livemylife/source/css/images/beside_up2.png","hash":"ef066ba2e93a4738df45ae05020726e066c4dd1f","modified":1636551796436},{"_id":"themes/livemylife/source/css/images/beside_up.png","hash":"183d87f1a99e93fc663ec798fa8c94cb87c83bcb","modified":1636551796436},{"_id":"themes/livemylife/source/css/images/beside_up_white.png","hash":"49c5922a8de63dcf9468fbcffc70d2ec36b1b527","modified":1636551796439},{"_id":"themes/livemylife/source/css/images/beside_up_white2.png","hash":"52e9d5715def1d3d09ab076d5eb3d22916d8f7d7","modified":1636551796439},{"_id":"themes/livemylife/source/js/echarts/china-contour.js","hash":"46069d796fb1dd191cdd6a0806570700ae9c0347","modified":1636551796447},{"_id":"themes/livemylife/source/js/src/chinamap.js","hash":"37bb53e16eca9e5f0f8ff1b5581286d651aec3b4","modified":1636551796475},{"_id":"themes/livemylife/source/js/viewer/pic-viewer.js","hash":"9bf7c37cce781628346803ed7ce8f02623c2d013","modified":1636551796476},{"_id":"themes/livemylife/source/js/viewer/viewer.min.js","hash":"ae5380974b6fb8b0e15356c8418186c6c0821222","modified":1636551796476},{"_id":"source/img/header_img/tag_bg.jpg","hash":"35131c8b7ab3943c9fe4577329cd1c412d1c4fac","modified":1636551796417},{"_id":"source/img/scenery/about_bg2.jpg","hash":"bdffbe6a94f9c5be1b9353fc2b4f28a74677939f","modified":1636551796418},{"_id":"source/img/header_img/dawn.jpg","hash":"2e9291c0a9d255c203fb11fd4f471b28459287b0","modified":1636551796373},{"_id":"themes/livemylife/source/js/echarts/china.js","hash":"0aaf91ed666621d0aa269d4ee5e1c0a9dc06235e","modified":1636551796447},{"_id":"themes/livemylife/source/js/echarts/province/anhui.js","hash":"a17708654277222014c1ba7005dd58bc7b6d54ce","modified":1636551796453},{"_id":"themes/livemylife/source/js/echarts/province/aomen.js","hash":"8558d9a5bf394a03d93ea85159c828d23b9b56d6","modified":1636551796453},{"_id":"themes/livemylife/source/js/echarts/province/beijing.js","hash":"1f33aeb4ff666ceefa75c304f3f853f5dd3591a1","modified":1636551796454},{"_id":"themes/livemylife/source/js/echarts/province/fujian.js","hash":"9c125baa9912134be8b28336ef70cdec842f195a","modified":1636551796455},{"_id":"themes/livemylife/source/js/echarts/province/guizhou.js","hash":"9eac20cb6f36e717d364ca2c4860292b8fe1128e","modified":1636551796457},{"_id":"themes/livemylife/source/js/echarts/province/hainan.js","hash":"10b313c1fdfe1a966163c92c333a766e10e96d27","modified":1636551796458},{"_id":"themes/livemylife/source/js/echarts/province/hebei.js","hash":"d76f7ffba58d553d50acba3114c9cc776d0d59e4","modified":1636551796458},{"_id":"themes/livemylife/source/js/echarts/province/henan.js","hash":"a7c25e0f04470c5da5f36d70738156c35228ef7e","modified":1636551796459},{"_id":"themes/livemylife/source/js/echarts/province/hubei.js","hash":"4797d4615ee167b8711091ab4eea1e97a4c545bd","modified":1636551796460},{"_id":"themes/livemylife/source/js/echarts/province/jiangsu.js","hash":"15a2820d2b1829614befd24fde73b69568ff7d4f","modified":1636551796461},{"_id":"themes/livemylife/source/js/echarts/province/jilin.js","hash":"737c4416708b1ef3b49be328ed7a9896439df1d3","modified":1636551796461},{"_id":"themes/livemylife/source/js/echarts/province/liaoning.js","hash":"250fbaa3cb8297139e348249243eab6b277d24b6","modified":1636551796462},{"_id":"themes/livemylife/source/js/echarts/province/ningxia.js","hash":"c25daa696558129fe018ff7c5de6126eabfda663","modified":1636551796463},{"_id":"themes/livemylife/source/js/echarts/province/jiangxi.js","hash":"dc078183c43df9e91cfb46b02e9e7fdcb7a96ca3","modified":1636551796461},{"_id":"themes/livemylife/source/js/echarts/province/qinghai.js","hash":"25dd767a0d1ddbea6db57f0ab86ab315215dec1d","modified":1636551796464},{"_id":"themes/livemylife/source/js/echarts/province/shanghai.js","hash":"456974123ab5ed51993e6e7fba8f200f556c0751","modified":1636551796465},{"_id":"themes/livemylife/source/js/echarts/province/shandong.js","hash":"2f8035028a27dc47fe85bb8c8f3700c08c546a55","modified":1636551796465},{"_id":"themes/livemylife/source/js/echarts/province/shanxi.js","hash":"da043410b84996e2fc7c27b8010497ad45a9e464","modified":1636551796465},{"_id":"themes/livemylife/source/js/echarts/province/shanxi1.js","hash":"d16d41750d066776846329dd44691d39cc9a133e","modified":1636551796466},{"_id":"themes/livemylife/source/js/echarts/province/taiwan.js","hash":"1a18b39463a2a15dfb96d1823f84bd91b0099a04","modified":1636551796467},{"_id":"themes/livemylife/source/js/echarts/province/xizang.js","hash":"9e51acbff27c6b4664dbaf37adcfb851e8acd025","modified":1636551796469},{"_id":"themes/livemylife/source/js/echarts/province/xianggang.js","hash":"c34ca0c6974964b776ab64aff135a6630dac86ed","modified":1636551796468},{"_id":"themes/livemylife/source/js/echarts/province/tianjin.js","hash":"c0f4bb6ae03bd3175203fd9cd70983059a3a636f","modified":1636551796467},{"_id":"themes/livemylife/source/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1636551796474},{"_id":"source/img/avatar/roguerabbit.jpg","hash":"3c71801016fc2b587c128d42f45438f523bb1a1a","modified":1636551796142},{"_id":"source/img/header_img/squirrel.jpg","hash":"6d9fe36a3a2d362fa2308e894088a11b39426c96","modified":1636551796416},{"_id":"themes/livemylife/source/js/echarts/province/chongqing.js","hash":"55661b00c1bfc3d505466c6b3c9a06df826ffa45","modified":1636551796454},{"_id":"themes/livemylife/source/js/echarts/province/gansu.js","hash":"e030cf4fbe48b2467176771dbee9adc4111f47de","modified":1636551796455},{"_id":"themes/livemylife/source/js/echarts/province/guangxi.js","hash":"31ed274566e6369e568be67588033f43c2e902be","modified":1636551796457},{"_id":"themes/livemylife/source/js/echarts/province/hunan.js","hash":"b49abde15a3e60ae3898c0f2f5989c7a759c20c2","modified":1636551796460},{"_id":"themes/livemylife/source/js/echarts/province/heilongjiang.js","hash":"bd0453fc68288a5f1886ce233a54823377e73132","modified":1636551796459},{"_id":"themes/livemylife/source/js/echarts/province/neimenggu.js","hash":"f26fcccdce99132d24c54f99d52179a11b30269a","modified":1636551796463},{"_id":"themes/livemylife/source/js/echarts/province/sichuan.js","hash":"917d59cccf0a4eb98ae71f3e4ef5b5e508415352","modified":1636551796467},{"_id":"themes/livemylife/source/js/echarts/world.js","hash":"7c57299eabf0e80868d447830ddfef1290695193","modified":1636551796472},{"_id":"themes/livemylife/source/js/echarts/province/xinjiang.js","hash":"f432c61109275274fac2c20e69103f6c96f287c9","modified":1636551796468},{"_id":"themes/livemylife/source/js/echarts/province/yunnan.js","hash":"183aeee5c67ea236a51bf31ad1e89aeb2feacd4b","modified":1636551796470},{"_id":"themes/livemylife/source/js/echarts/province/zhejiang.js","hash":"4768c4a4aee38ff6f2568fe8c7b33a3555145220","modified":1636551796471},{"_id":"themes/livemylife/source/js/echarts/province/guangdong.js","hash":"e199d2277a076aafea04e8531ed621b792ae63cd","modified":1636551796456},{"_id":"themes/livemylife/source/js/comment/gitalk.js","hash":"560f027317869f39da9d13b0393e3bf98d081b12","modified":1636551796447},{"_id":"themes/livemylife/source/js/echarts/echarts.min.js","hash":"eec6c0cc35c819602747de4574b4d77a773ae6bc","modified":1636551796453},{"_id":"public/baidusitemap.xml","hash":"56bdc4a5622e1889f33f8445e2bdd7b6bf4ed1df","modified":1650704600325},{"_id":"public/sitemap.xml","hash":"bca897960eea861b7bfe52eded0f6b40a9a47bbe","modified":1650704600325},{"_id":"public/searchVersion.json","hash":"e4bef14fbe7bf58e96eab49766c4ea6e7e3183ad","modified":1650704600325},{"_id":"public/ebooks/index.html","hash":"11013c5747b9a1c81fa6b54f90cca858c47e45cb","modified":1650704600325},{"_id":"public/404.html","hash":"268b446ad39cc8d6d56ddac0a78c7d8b2beb329b","modified":1650704600325},{"_id":"public/categories/index.html","hash":"d79c18f77ed26aa7c653c11f39c2b339b78b03bb","modified":1650704600325},{"_id":"public/tags/index.html","hash":"45c9a29f68cec253026d4abb5567062faba3938f","modified":1650704600325},{"_id":"public/2022/04/10/f82e.html","hash":"7ea84997d31e304efafef95a1133ddb32f4a91f9","modified":1650704600325},{"_id":"public/2021/10/28/9f48.html","hash":"8759dd8380949de4a0a4aa0c3c71d915c9c66905","modified":1650704600325},{"_id":"public/2021/11/10/6fff.html","hash":"aacc0f3481a422161a3e0c57de41516b80212dd5","modified":1650704600325},{"_id":"public/2021/08/25/5dae.html","hash":"229559a433e188cab400c4e6a464320ed180889a","modified":1650704600325},{"_id":"public/2021/08/18/86e5.html","hash":"4978914c13366ef56740a5e6c1f7bad648242f5f","modified":1650704600325},{"_id":"public/2021/07/15/f6ae.html","hash":"c5096aa241e465c3ebb52f535dbfdc5ad0921bb8","modified":1650704600325},{"_id":"public/2021/04/15/a10a.html","hash":"5290bfde4fcdfa468c8040d2e8bb233920c28c61","modified":1650704600325},{"_id":"public/2021/06/04/9f70.html","hash":"71e6d363d21ed3ed7e291fdd5f4e9ff8934699de","modified":1650704600325},{"_id":"public/2021/03/31/57bd.html","hash":"04da9ddfb5c3ae426268852ca1d8b09ce17bdc29","modified":1650704600325},{"_id":"public/2021/03/24/1af5.html","hash":"beed922534264a578518a52f8bad65aa9a39e8ba","modified":1650704600325},{"_id":"public/2020/12/22/73b3.html","hash":"43a81549bb72a2413aa022dc1db9530bc8c4d571","modified":1650704600325},{"_id":"public/2020/12/21/c608.html","hash":"7b7276e2f13778d5c38fb4f535b21e831f7d5c9c","modified":1650704600325},{"_id":"public/2020/12/21/211a.html","hash":"b87fbcfae3c08b12a513ed2e681d4edd5b8c2f0f","modified":1650704600325},{"_id":"public/2020/12/20/c15d.html","hash":"d83c88bae5779c2b727a86a448412ad9f34d44f8","modified":1650704600325},{"_id":"public/2020/12/19/7b21.html","hash":"1ef8e6cd66f4470c1d92b96c640003cf80c078b1","modified":1650704600325},{"_id":"public/2020/12/18/1af5.html","hash":"5be3c7a10d0701986dc1f30b3a11e19543782bad","modified":1650704600325},{"_id":"public/2020/12/09/8c68.html","hash":"064f4034536ece9d2c24f6ed97863218eada95ce","modified":1650704600325},{"_id":"public/2020/11/26/2312.html","hash":"ccb05a457f478cfcdf3bffa98626770f83732cbd","modified":1650704600325},{"_id":"public/2020/11/26/6186.html","hash":"ef7c6a8b7c92f1e002d83c78b8b810322d2a3e54","modified":1650704600325},{"_id":"public/2020/10/23/130.html","hash":"82fb50970dbdb7b50c2262f1c519422e27a63895","modified":1650704600325},{"_id":"public/2020/10/15/2de3.html","hash":"b28bfa00d8fef648d0b8a24dfb4822be90ae6296","modified":1650704600325},{"_id":"public/about/index.html","hash":"b503884952d2396f306d6df176be284e0a15f746","modified":1650704600325},{"_id":"public/archive/index.html","hash":"30529742524021314cfca5c9829ed2954d1bb481","modified":1650704600325},{"_id":"public/archives/index.html","hash":"9da89aecf405902a75094c2fcd65e69961adf8e2","modified":1650704600325},{"_id":"public/archives/archives/2/index.html","hash":"37c4d6549a23aa5e7e9172c835f79f98e0809cad","modified":1650704600325},{"_id":"public/archives/archives/3/index.html","hash":"62546928397db33ff5fe64b367d3c84d43dec6f9","modified":1650704600325},{"_id":"public/archives/2020/index.html","hash":"0bb31c1c627f4283f978c3e73d6a9c5845d6c648","modified":1650704600325},{"_id":"public/archives/2020/archives/2/index.html","hash":"edcfdab6d46e3a0ebbc7586423db581d856dc969","modified":1650704600325},{"_id":"public/archives/2020/10/index.html","hash":"ea51ccc15277e4dfa3e9d7f494b2db58afeb8ddd","modified":1650704600325},{"_id":"public/archives/2020/11/index.html","hash":"3d3392df8b96d94be3dd2a6fcb16b9cf4ff6a265","modified":1650704600325},{"_id":"public/archives/2020/12/index.html","hash":"7ef954b8ecee4927e8db200f5d30b97b2710b294","modified":1650704600325},{"_id":"public/archives/2021/index.html","hash":"6bbc512f7c199a4995d8b986fc5234042e7d13e5","modified":1650704600325},{"_id":"public/archives/2021/03/index.html","hash":"43778ce9fb1326d8a2252aff8ccec48018c767bf","modified":1650704600325},{"_id":"public/archives/2021/04/index.html","hash":"4dc1c9d3e411b99163be96291504c39294966b78","modified":1650704600325},{"_id":"public/archives/2021/06/index.html","hash":"7be010a97714f894443ced8d665e97c638bf4d5e","modified":1650704600325},{"_id":"public/archives/2021/08/index.html","hash":"ac14de797dceba79357306ba113d9e0aaaf248b0","modified":1650704600325},{"_id":"public/archives/2021/07/index.html","hash":"d506bbaf00434668cdaa52de1947da3cc85b0bcf","modified":1650704600325},{"_id":"public/archives/2021/11/index.html","hash":"8fb814629b097c012e530bb4152c1b4639352a2b","modified":1650704600325},{"_id":"public/archives/2021/10/index.html","hash":"fc4077e476b2f634d18efa83c1cd70c2c0bbcbb9","modified":1650704600325},{"_id":"public/archives/2022/index.html","hash":"02a9556ed76f62650ffcc52105e97c10fbe17302","modified":1650704600325},{"_id":"public/archives/2022/04/index.html","hash":"008589d7bb3cf77214de65fe2c80e74fd76b3ff2","modified":1650704600325},{"_id":"public/archives/2/index.html","hash":"1e15dc563b27daeb9c1da4d50cbac815c3e70a35","modified":1650704600325},{"_id":"public/index.html","hash":"5b38b00b57a6f990b2e0e2fcd8ab0e5859c29e9d","modified":1650704600325},{"_id":"public/archives/3/index.html","hash":"545e9bc53e43a2b5474742324827543dbe639aed","modified":1650704600325},{"_id":"public/categories/work/index.html","hash":"c094d0254c2c93283ab2706e041ba75b9b96e450","modified":1650704600325},{"_id":"public/categories/work/archives/2/index.html","hash":"c1caca56dba2f6f7c9b16699da84bdd412443205","modified":1650704600325},{"_id":"public/categories/life/index.html","hash":"90aa19815d741c04ce0a783498b1d4f066a4097c","modified":1650704600325},{"_id":"public/tags/algorithm/index.html","hash":"1a13b1ca142bdca91a46da56e927c4d989296e2f","modified":1650704600325},{"_id":"public/tags/data-structure/index.html","hash":"90ffdd64b747c6c2b9a7add7de6386aeade7fa94","modified":1650704600325},{"_id":"public/tags/http/index.html","hash":"476f8561af96ed0f3094d49ed643bb94cc7dbce6","modified":1650704600325},{"_id":"public/tags/IO/index.html","hash":"d00e9b046be275c730eab7e5de53a685cd4dd833","modified":1650704600325},{"_id":"public/tags/netty/index.html","hash":"d8ee8148b2caaa643cb50afb0cb4b9f9bb4295cb","modified":1650704600325},{"_id":"public/tags/tools/index.html","hash":"72800d5626cec330be142a8e848d1e8c39fab6e1","modified":1650704600325},{"_id":"public/tags/map/index.html","hash":"e25a332793f8ac8e55d023f744b427c2a7044929","modified":1650704600325},{"_id":"public/tags/git/index.html","hash":"1021ee76aa2bf999e8014888d412293accb29bf8","modified":1650704600325},{"_id":"public/tags/finance/index.html","hash":"73e706f0eb7c074d784e5ec66065f289672b1570","modified":1650704600325},{"_id":"public/tags/nginx/index.html","hash":"6b468599a47b5db3da5ec40b68ca07807c5eb7fa","modified":1650704600325},{"_id":"public/tags/java/index.html","hash":"50ee043815467daf40eebfeb47e0add932baaf2f","modified":1650704600325},{"_id":"public/tags/spring/index.html","hash":"399d5ed231e3db5c6139d3272dff3f5c3ec726ee","modified":1650704600325},{"_id":"public/tags/mysql/index.html","hash":"354acd90beffddd913de8e16da1c0dc1ebc95921","modified":1650704600325},{"_id":"public/tags/source-code/index.html","hash":"f6c6bc31b4bf807626693f3ad514724bb869499e","modified":1650704600325},{"_id":"public/tags/redis/index.html","hash":"fb4dcdbc7d824843f79994606ba9c41b32e91a03","modified":1650704600325},{"_id":"public/CNAME","hash":"fa4ed0bd15b8167ee4e134821e3bb58a69a4d1a9","modified":1650704600325},{"_id":"public/LICENSE","hash":"7df059597099bb7dcf25d2a9aedfaf4465f72d8d","modified":1650704600325},{"_id":"public/img/avatar/avatar.png","hash":"e6c1c40fb523d94779d95aa2dc7bf0b4259bacf2","modified":1650704600325},{"_id":"public/img/avatar/fatpeople.jpg","hash":"04cc046c50473ab78aee784df62f05448be8b884","modified":1650704600325},{"_id":"public/img/signature/vicky-white.png","hash":"efb6c7e1ccbded551759c9997b108a20c15f0c09","modified":1650704600325},{"_id":"public/fonts/glyphicons-halflings-regular.eot","hash":"86b6f62b7853e67d3e635f6512a5a5efc58ea3c3","modified":1650704600325},{"_id":"public/fonts/glyphicons-halflings-regular.woff2","hash":"ca35b697d99cae4d1b60f2d60fcd37771987eb07","modified":1650704600325},{"_id":"public/fonts/glyphicons-halflings-regular.ttf","hash":"44bc1850f570972267b169ae18f1cb06b611ffa2","modified":1650704600325},{"_id":"public/fonts/glyphicons-halflings-regular.woff","hash":"278e49a86e634da6f2a02f3b47dd9d2a8f26210f","modified":1650704600325},{"_id":"public/img/1-work/tools/import-github-repo.png","hash":"4ecfeb1dd598d0a17e278da065c38a5523823250","modified":1650704600325},{"_id":"public/img/1-work/tools/create_gitee_repo.png","hash":"ebd7bd2ba944d5428c2f8b0f58e2d4477952ee63","modified":1650704600325},{"_id":"public/css/images/beside_up2.png","hash":"ef066ba2e93a4738df45ae05020726e066c4dd1f","modified":1650704600325},{"_id":"public/css/images/beside_up.png","hash":"183d87f1a99e93fc663ec798fa8c94cb87c83bcb","modified":1650704600325},{"_id":"public/css/images/beside_up_white.png","hash":"49c5922a8de63dcf9468fbcffc70d2ec36b1b527","modified":1650704600325},{"_id":"public/css/images/beside_up_white2.png","hash":"52e9d5715def1d3d09ab076d5eb3d22916d8f7d7","modified":1650704600325},{"_id":"public/img/avatar/about-me.jpg","hash":"4fc7c645f502bb38cb2a672bd95d478e8be0493a","modified":1650704600325},{"_id":"public/img/header_img/archive_bg.jpg","hash":"fc4bdf7fa98346ea35115151e4914cd1e5a946d9","modified":1650704600325},{"_id":"public/img/header_img/categories_bg.jpg","hash":"a8a46a06f566e13a919d9cbca6a66ae5a3b78b1e","modified":1650704600325},{"_id":"public/img/header_img/post-bg-desk.jpg","hash":"6bbe3de397f929a7ca0a49c88779a4a8dd904a88","modified":1650704600325},{"_id":"public/img/header_img/home-bg.jpg","hash":"6bbe3de397f929a7ca0a49c88779a4a8dd904a88","modified":1650704600325},{"_id":"public/fonts/glyphicons-halflings-regular.svg","hash":"de51a8494180a6db074af2dee2383f0a363c5b08","modified":1650704600325},{"_id":"public/img/scenery/about_bg.jpg","hash":"462c14b9b00ab2153e579f14cb1e44aa56704ce8","modified":1650704600325},{"_id":"public/img/scenery/about_bg4.jpg","hash":"272f0d4233aea38f32311439f8528d2b3bebd546","modified":1650704600325},{"_id":"public/css/catalog.css","hash":"2062bf4e5b219654e0d4bf470f5eef1be213da95","modified":1650704600325},{"_id":"public/css/highlight.css","hash":"03d1f0a648e9bdf7b1f57d217313cbac5d0c7eb1","modified":1650704600325},{"_id":"public/css/archive.css","hash":"8db895ebaeff19ac145c961abcfd5d4a8d67a8ea","modified":1650704600325},{"_id":"public/css/gitalk.css","hash":"51783fd60dff05e8e339ff83b41504538662f6ca","modified":1650704600325},{"_id":"public/css/highlight_normal.css","hash":"6a40a9a0f268fb17d9002cb49a16946444ef5f34","modified":1650704600325},{"_id":"public/css/search.css","hash":"a941f2f3d05d43e0a1517ae6923e848638b9ff7c","modified":1650704600325},{"_id":"public/css/rocket.css","hash":"ec8abdba1cdd362d03fd8ffe182213aa4cbd449c","modified":1650704600325},{"_id":"public/css/hux-blog.min.css","hash":"1baef04de262aeb7023d835429b49a805ac4ab40","modified":1650704600325},{"_id":"public/css/scroll.css","hash":"254c14f514de149e1d95a9c583e8af0dbacb306d","modified":1650704600325},{"_id":"public/css/livemylife.css","hash":"dbf2b89627f55e7f8ef12730e822319859f25767","modified":1650704600325},{"_id":"public/css/signature.css","hash":"820fa4743cea34a61808cd8f7de528605c32d7e3","modified":1650704600325},{"_id":"public/css/themecolor.css","hash":"725b0e534f7c6c80e2e9a47d1c93ee9f03d7458a","modified":1650704600325},{"_id":"public/css/viewer.min.css","hash":"0e045aa3df1be7d138caa701ec3aa623ccc7a52d","modified":1650704600325},{"_id":"public/css/wave.css","hash":"041f3b4a78e2840ba17679cea05fb14bb646722f","modified":1650704600325},{"_id":"public/css/top.css","hash":"0303375fbe2ca942cd3d86f31d12fef9bf5785af","modified":1650704600325},{"_id":"public/css/widget.css","hash":"da95ad3f1938f24d20f1fa77d7a38f0c392b5ec8","modified":1650704600325},{"_id":"public/css/beantech.css","hash":"c192d3170301f774fa4c2185dc125cb3d6ec4929","modified":1650704600325},{"_id":"public/css/beantech.min.css","hash":"66f124242893cae4517119e39e75d7f23eef01ae","modified":1650704600325},{"_id":"public/js/busuanzi.pure.mini.js","hash":"6e41f31100ae7eb3a6f23f2c168f6dd56e7f7a9a","modified":1650704600325},{"_id":"public/js/bootstrap.min.js","hash":"b3f2ef9f985e7906c9360756b73cd64bf7733647","modified":1650704600325},{"_id":"public/js/hux-blog.min.js","hash":"1563e7f70550ac6b30803d6f449719b853200e35","modified":1650704600325},{"_id":"public/js/catalog.js","hash":"059f3f31492e5b1a9dddf422a48c32969d247415","modified":1650704600325},{"_id":"public/js/hux-blog.js","hash":"4b4d3c557405d04c3087d36c13e2834fe05c0f73","modified":1650704600325},{"_id":"public/js/jquery.nav.js","hash":"ef2160a456176a4d09cc0b95d52b27dfbbadf2d8","modified":1650704600325},{"_id":"public/js/jquery.tagcloud.js","hash":"4e5fd0b07f3bd935f2e603710447e039e3677211","modified":1650704600325},{"_id":"public/js/scroll.js","hash":"265a4c4fc33b5b44b620db64ff31d2bc05d233e9","modified":1650704600325},{"_id":"public/js/themecolor.js","hash":"8295e112233778d8f20c31b06c19659f60edbb22","modified":1650704600325},{"_id":"public/js/totop.js","hash":"c05360f6fc699ac12e794b1764b4a952713a3017","modified":1650704600325},{"_id":"public/js/ziploader.js","hash":"9c25324caf53b56cb68839dcfb34e61e5a6a63f3","modified":1650704600325},{"_id":"public/css/bootstrap.min.css","hash":"fec7b176a4b9a67c0eb5d184f57b84297efc23aa","modified":1650704600325},{"_id":"public/js/jquery.min.js","hash":"41b4bfbaa96be6d1440db6e78004ade1c134e276","modified":1650704600325},{"_id":"public/js/bootstrap.js","hash":"f8752e9ae24daec0a0baffd7819122f8c6fd9103","modified":1650704600325},{"_id":"public/css/bootstrap.css","hash":"41c54bf695145ae0b4d9020a1da308ceb05dcaf3","modified":1650704600325},{"_id":"public/js/echarts/china-contour.js","hash":"46069d796fb1dd191cdd6a0806570700ae9c0347","modified":1650704600325},{"_id":"public/js/src/chinamap.js","hash":"37bb53e16eca9e5f0f8ff1b5581286d651aec3b4","modified":1650704600325},{"_id":"public/js/viewer/pic-viewer.js","hash":"9bf7c37cce781628346803ed7ce8f02623c2d013","modified":1650704600325},{"_id":"public/js/viewer/viewer.min.js","hash":"ae5380974b6fb8b0e15356c8418186c6c0821222","modified":1650704600325},{"_id":"public/js/echarts/china.js","hash":"0aaf91ed666621d0aa269d4ee5e1c0a9dc06235e","modified":1650704600325},{"_id":"public/js/echarts/province/aomen.js","hash":"8558d9a5bf394a03d93ea85159c828d23b9b56d6","modified":1650704600325},{"_id":"public/js/echarts/province/beijing.js","hash":"1f33aeb4ff666ceefa75c304f3f853f5dd3591a1","modified":1650704600325},{"_id":"public/js/echarts/province/anhui.js","hash":"a17708654277222014c1ba7005dd58bc7b6d54ce","modified":1650704600325},{"_id":"public/js/echarts/province/hainan.js","hash":"10b313c1fdfe1a966163c92c333a766e10e96d27","modified":1650704600325},{"_id":"public/js/echarts/province/fujian.js","hash":"9c125baa9912134be8b28336ef70cdec842f195a","modified":1650704600325},{"_id":"public/js/echarts/province/guizhou.js","hash":"9eac20cb6f36e717d364ca2c4860292b8fe1128e","modified":1650704600325},{"_id":"public/js/echarts/province/jiangsu.js","hash":"15a2820d2b1829614befd24fde73b69568ff7d4f","modified":1650704600325},{"_id":"public/js/echarts/province/hebei.js","hash":"d76f7ffba58d553d50acba3114c9cc776d0d59e4","modified":1650704600325},{"_id":"public/js/echarts/province/henan.js","hash":"a7c25e0f04470c5da5f36d70738156c35228ef7e","modified":1650704600325},{"_id":"public/js/echarts/province/hubei.js","hash":"4797d4615ee167b8711091ab4eea1e97a4c545bd","modified":1650704600325},{"_id":"public/js/echarts/province/ningxia.js","hash":"c25daa696558129fe018ff7c5de6126eabfda663","modified":1650704600325},{"_id":"public/js/echarts/province/jilin.js","hash":"737c4416708b1ef3b49be328ed7a9896439df1d3","modified":1650704600325},{"_id":"public/js/echarts/province/liaoning.js","hash":"250fbaa3cb8297139e348249243eab6b277d24b6","modified":1650704600325},{"_id":"public/js/echarts/province/shanghai.js","hash":"456974123ab5ed51993e6e7fba8f200f556c0751","modified":1650704600325},{"_id":"public/js/echarts/province/jiangxi.js","hash":"dc078183c43df9e91cfb46b02e9e7fdcb7a96ca3","modified":1650704600325},{"_id":"public/js/echarts/province/qinghai.js","hash":"25dd767a0d1ddbea6db57f0ab86ab315215dec1d","modified":1650704600325},{"_id":"public/js/echarts/province/shanxi.js","hash":"da043410b84996e2fc7c27b8010497ad45a9e464","modified":1650704600325},{"_id":"public/js/echarts/province/shanxi1.js","hash":"d16d41750d066776846329dd44691d39cc9a133e","modified":1650704600325},{"_id":"public/js/echarts/province/taiwan.js","hash":"1a18b39463a2a15dfb96d1823f84bd91b0099a04","modified":1650704600325},{"_id":"public/js/echarts/province/xianggang.js","hash":"c34ca0c6974964b776ab64aff135a6630dac86ed","modified":1650704600325},{"_id":"public/js/echarts/province/xizang.js","hash":"9e51acbff27c6b4664dbaf37adcfb851e8acd025","modified":1650704600325},{"_id":"public/js/echarts/province/tianjin.js","hash":"c0f4bb6ae03bd3175203fd9cd70983059a3a636f","modified":1650704600325},{"_id":"public/js/echarts/province/chongqing.js","hash":"55661b00c1bfc3d505466c6b3c9a06df826ffa45","modified":1650704600325},{"_id":"public/js/echarts/province/gansu.js","hash":"e030cf4fbe48b2467176771dbee9adc4111f47de","modified":1650704600325},{"_id":"public/js/echarts/province/shandong.js","hash":"2f8035028a27dc47fe85bb8c8f3700c08c546a55","modified":1650704600325},{"_id":"public/js/echarts/province/guangxi.js","hash":"31ed274566e6369e568be67588033f43c2e902be","modified":1650704600325},{"_id":"public/js/echarts/province/hunan.js","hash":"b49abde15a3e60ae3898c0f2f5989c7a759c20c2","modified":1650704600325},{"_id":"public/js/echarts/province/heilongjiang.js","hash":"bd0453fc68288a5f1886ce233a54823377e73132","modified":1650704600325},{"_id":"public/js/echarts/province/neimenggu.js","hash":"f26fcccdce99132d24c54f99d52179a11b30269a","modified":1650704600325},{"_id":"public/js/jquery.js","hash":"1852661bd11a09ca9b9cb63d1aa6ff390fffaf4e","modified":1650704600325},{"_id":"public/js/echarts/province/sichuan.js","hash":"917d59cccf0a4eb98ae71f3e4ef5b5e508415352","modified":1650704600325},{"_id":"public/js/echarts/province/xinjiang.js","hash":"f432c61109275274fac2c20e69103f6c96f287c9","modified":1650704600325},{"_id":"public/js/echarts/province/yunnan.js","hash":"183aeee5c67ea236a51bf31ad1e89aeb2feacd4b","modified":1650704600325},{"_id":"public/js/echarts/province/zhejiang.js","hash":"4768c4a4aee38ff6f2568fe8c7b33a3555145220","modified":1650704600325},{"_id":"public/js/echarts/province/guangdong.js","hash":"e199d2277a076aafea04e8531ed621b792ae63cd","modified":1650704600325},{"_id":"public/js/echarts/world.js","hash":"7c57299eabf0e80868d447830ddfef1290695193","modified":1650704600325},{"_id":"public/baidu_verify_code-jayy2pLM52.html","hash":"58fc353e353e2dedb8bcd7f9ffe62ec1b2ba81d7","modified":1650704600325},{"_id":"public/baidu_verify_code-rpJMBPgyFA.html","hash":"7ee3e15a6b854a6f1131bf731fff4c9d61b8f431","modified":1650704600325},{"_id":"public/google0915f5e354aeae89.html","hash":"dacc570438035c30f92d0c9d97eacc9b0f09cc46","modified":1650704600325},{"_id":"public/img/header_img/ebooks-bg.jpg","hash":"84b61541d90457dbc74fd3a6aa91029e61524a2a","modified":1650704600325},{"_id":"public/img/header_img/post-bg-swift.jpg","hash":"12552e545ca35a93f0050a5417de5d302f1a4f5e","modified":1650704600325},{"_id":"public/img/scenery/treat_me_to_coffee.jpg","hash":"e307178429b98962ff3918e12427b3e7db6d10df","modified":1650704600325},{"_id":"public/img/header_img/dawn.jpg","hash":"2e9291c0a9d255c203fb11fd4f471b28459287b0","modified":1650704600325},{"_id":"public/js/comment/gitalk.js","hash":"560f027317869f39da9d13b0393e3bf98d081b12","modified":1650704600325},{"_id":"public/js/echarts/echarts.min.js","hash":"eec6c0cc35c819602747de4574b4d77a773ae6bc","modified":1650704600325},{"_id":"public/img/header_img/404_bg.jpg","hash":"e51ce60c4e13cfd57c825d241dae23ac988cd796","modified":1650704600325},{"_id":"public/img/header_img/tag_bg.jpg","hash":"35131c8b7ab3943c9fe4577329cd1c412d1c4fac","modified":1650704600325},{"_id":"public/img/scenery/about_bg2.jpg","hash":"bdffbe6a94f9c5be1b9353fc2b4f28a74677939f","modified":1650704600325},{"_id":"public/img/avatar/roguerabbit.jpg","hash":"3c71801016fc2b587c128d42f45438f523bb1a1a","modified":1650704600325},{"_id":"public/img/header_img/squirrel.jpg","hash":"6d9fe36a3a2d362fa2308e894088a11b39426c96","modified":1650704600325}],"Category":[{"name":"work","_id":"cl2bmwee80003kh6z960h3me2"},{"name":"life","_id":"cl2bmweeo000ukh6z0l8s55j0"}],"Data":[],"Page":[{"layout":"404","description":"I'm sorry there is nothing that you want , but you can enjoy the scenery here ...","header-img":"img/header_img/404_bg.jpg","_content":"","source":"404.md","raw":"---\nlayout: 404\ndescription: \"I'm sorry there is nothing that you want , but you can enjoy the scenery here ...\"\nheader-img: \"img/header_img/404_bg.jpg\"\n---\n","date":"2021-11-10T13:43:16.135Z","updated":"2021-11-10T13:43:16.135Z","path":"404.html","title":"","comments":1,"_id":"cl2bmwed70000kh6zh20p9eow","content":"","site":{"data":{}},"excerpt":"","more":""},{"title":"EBooks","description":"Good Reads.","header-img":"img/header_img/ebooks-bg.jpg","abbrlink":"4635","_content":"\n### [](https://icyfenix.cn/) - \n\n**------ by **\n\n------\n\n### [labuladong ](https://labuladong.gitee.io/algo/)\n\n\n\n\n\n\n","source":"ebooks/index.md","raw":"---\ntitle: EBooks\ndescription: Good Reads.\nheader-img: img/header_img/ebooks-bg.jpg\nabbrlink: '4635'\n---\n\n### [](https://icyfenix.cn/) - \n\n**------ by **\n\n------\n\n### [labuladong ](https://labuladong.gitee.io/algo/)\n\n\n\n\n\n\n","date":"2021-12-08T14:15:33.827Z","updated":"2021-12-08T14:15:33.827Z","path":"ebooks/index.html","comments":1,"layout":"page","_id":"cl2bmwefi002ikh6zbs392c2a","content":"<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a><a href=\"https://icyfenix.cn/\" target=\"_blank\" rel=\"noopener\"></a> - </h3><p><strong> by </strong></p>\n<hr>\n<h3 id=\"labuladong-\"><a href=\"#labuladong-\" class=\"headerlink\" title=\"labuladong \"></a><a href=\"https://labuladong.gitee.io/algo/\" target=\"_blank\" rel=\"noopener\">labuladong </a></h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\" - \"></a><a href=\"https://icyfenix.cn/\" target=\"_blank\" rel=\"noopener\"></a> - </h3><p><strong> by </strong></p>\n<hr>\n<h3 id=\"labuladong-\"><a href=\"#labuladong-\" class=\"headerlink\" title=\"labuladong \"></a><a href=\"https://labuladong.gitee.io/algo/\" target=\"_blank\" rel=\"noopener\">labuladong </a></h3>"},{"layout":"about","title":"About","date":"2016-04-20T20:48:33.000Z","description":"Sleep early. Please.","header-img":"img/header_img/post-bg-swift.jpg","_content":"\n## Follow With Interest Blogs\n\n> Sage Rennhttps://sagerenn.github.io/\n\n\n## Contact me\n\n> Emailvicky123.luo@outlook.com\n\n## Treat me to coffee\n>  If you feel that what I have written is of some value to you, I am glad that you are willing to invite me to drink coffee...\n\n<img src=\"../img/scenery/treat_me_to_coffee.jpg\" width=\"350\" alt=\"treat_me_to_coffee.jpg\"></img>\n","source":"about/index.md","raw":"---\nlayout: \"about\"\ntitle: \"About\"\ndate: 2016-04-21 04:48:33\ndescription: \"Sleep early. Please.\"\nheader-img: \"img/header_img/post-bg-swift.jpg\"\n---\n\n## Follow With Interest Blogs\n\n> Sage Rennhttps://sagerenn.github.io/\n\n\n## Contact me\n\n> Emailvicky123.luo@outlook.com\n\n## Treat me to coffee\n>  If you feel that what I have written is of some value to you, I am glad that you are willing to invite me to drink coffee...\n\n<img src=\"../img/scenery/treat_me_to_coffee.jpg\" width=\"350\" alt=\"treat_me_to_coffee.jpg\"></img>\n","updated":"2021-11-10T13:43:16.138Z","path":"about/index.html","comments":1,"_id":"cl2bmwefk002jkh6zhols5hws","content":"<h2 id=\"Follow-With-Interest-Blogs\"><a href=\"#Follow-With-Interest-Blogs\" class=\"headerlink\" title=\"Follow With Interest Blogs\"></a>Follow With Interest Blogs</h2><blockquote>\n<p>Sage Renn<a href=\"https://sagerenn.github.io/\" target=\"_blank\" rel=\"noopener\">https://sagerenn.github.io/</a></p>\n</blockquote>\n<h2 id=\"Contact-me\"><a href=\"#Contact-me\" class=\"headerlink\" title=\"Contact me\"></a>Contact me</h2><blockquote>\n<p>Email<a href=\"mailto:vicky123.luo@outlook.com\">vicky123.luo@outlook.com</a></p>\n</blockquote>\n<h2 id=\"Treat-me-to-coffee\"><a href=\"#Treat-me-to-coffee\" class=\"headerlink\" title=\"Treat me to coffee\"></a>Treat me to coffee</h2><blockquote>\n<p> If you feel that what I have written is of some value to you, I am glad that you are willing to invite me to drink coffee</p>\n</blockquote>\n<p><img src=\"../img/scenery/treat_me_to_coffee.jpg\" width=\"350\" alt=\"treat_me_to_coffee.jpg\"></img></p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Follow-With-Interest-Blogs\"><a href=\"#Follow-With-Interest-Blogs\" class=\"headerlink\" title=\"Follow With Interest Blogs\"></a>Follow With Interest Blogs</h2><blockquote>\n<p>Sage Renn<a href=\"https://sagerenn.github.io/\" target=\"_blank\" rel=\"noopener\">https://sagerenn.github.io/</a></p>\n</blockquote>\n<h2 id=\"Contact-me\"><a href=\"#Contact-me\" class=\"headerlink\" title=\"Contact me\"></a>Contact me</h2><blockquote>\n<p>Email<a href=\"mailto:vicky123.luo@outlook.com\">vicky123.luo@outlook.com</a></p>\n</blockquote>\n<h2 id=\"Treat-me-to-coffee\"><a href=\"#Treat-me-to-coffee\" class=\"headerlink\" title=\"Treat me to coffee\"></a>Treat me to coffee</h2><blockquote>\n<p> If you feel that what I have written is of some value to you, I am glad that you are willing to invite me to drink coffee</p>\n</blockquote>\n<p><img src=\"../img/scenery/treat_me_to_coffee.jpg\" width=\"350\" alt=\"treat_me_to_coffee.jpg\"></img></p>\n"},{"layout":"categories","title":"Categories","description":"Life should be easy.","header-img":"img/header_img/categories_bg.jpg","_content":"","source":"categories/index.md","raw":"---\nlayout: \"categories\"\ntitle: \"Categories\"\ndescription: \"Life should be easy.\"\nheader-img: \"img/header_img/categories_bg.jpg\"\n---\n","date":"2021-11-10T13:43:16.139Z","updated":"2021-11-10T13:43:16.139Z","path":"categories/index.html","comments":1,"_id":"cl2bmwefl002lkh6z643vf05v","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"archive","title":"Archives","header-img":"img/header_img/archive_bg.jpg","date":"2020-12-23T04:49:56.000Z","description":"Stay hungry, stay foolish.","_content":"","source":"archive/index.md","raw":"---\nlayout: \"archive\"\ntitle: \"Archives\"\nheader-img: \"img/header_img/archive_bg.jpg\"\ndate: 2020-12-23 12:49:56\ndescription: \"Stay hungry, stay foolish.\"\n---\n","updated":"2021-11-10T13:43:16.139Z","path":"archive/index.html","comments":1,"_id":"cl2bmwefl002nkh6z2ljs42n0","content":"","site":{"data":{}},"excerpt":"","more":""},{"layout":"tags","title":"Tags","description":"Make life better.","header-img":"img/header_img/tag_bg.jpg","_content":"","source":"tags/index.md","raw":"---\nlayout: \"tags\"\ntitle: \"Tags\"\ndescription: \"Make life better.\"\nheader-img: \"img/header_img/tag_bg.jpg\"\n---\n","date":"2021-11-10T13:43:16.424Z","updated":"2021-11-10T13:43:16.424Z","path":"tags/index.html","comments":1,"_id":"cl2bmwefm002okh6z5atlb4tx","content":"","site":{"data":{}},"excerpt":"","more":""}],"Post":[{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"2312","date":"2020-11-26T09:33:24.000Z","subtitle":null,"_content":"\n# \n\n## \n\n### 1. \n\n-  \n\n### 2. \n\n-  \n-  \n-  \n-  \n-  \n\n### 3. \n\n-  \n-  \n\n### 4. \n\n-  \n-  \n-  \n-  \n-  \n\n## \n\n### 1. \n\n### 2. \n\n-  \n-  \n-  \n\n### 3. \n\n### 4. \n\n## \n\n### 1. \n\n-  \n-  \n-  \n\n    - AVL\n    - \n\n-  \n-  \n\n### 2. \n\n-  B\n-  B+\n-  2-3\n-  2-3-4\n\n### 3. \n\n-  \n-  \n-  \n\n    - \n    - \n    - binary heap. \n    - \n\n        - 1.\n        - 2.iarr[i]\n\n            -  1i - 1/ 2\n            -  22*i + 1\n            -  32*i + 2\n\n        - 3.\n\n    - \n\n        - 1.shift up / bubble up\n        - 2. shift down / bubble down\n\n    - \n        nkOlogn\n        O(k)\n    - Leetcode\n\n        - [347.  K -](https://leetcode-cn.com/problems/top-k-frequent-elements/)\n\n-  \n-  \n\n-  \n\n    -  Binary Indexed Tree\n\n        - K\n        - LeetCode\n\n    - Segment Tree\n\n        - \n        - Leetcode \n\n            - [315. -](https://leetcode-cn.com/problems/count-of-smaller-numbers-after-self/)\n\n## \n\n### 1. \n\n-  \n-  \n\n### 2. \n\n### 3. \n\n### 4. \n\n### 5. \n\n### 6. \n\n### 7. \n\n# \n\n## \n\n### 1. \n\n- \n\n    - 1. \n    - 2. \n    - 3. \n\n- \n\n    ![image-20210917165515820](https://tva2.sinaimg.cn/large/006YzKDNly1gujq7ui7kaj60vq0fwadg02.jpg)\n\n    - 1. O(1)\n\n        - (1)\n\n    - 2. O(logn)O(nlogn)\n\n        - i=1; while (i <= n) { i = i * 2; }\n             O(logn)\n        -  O(logn) n  O(nlogn)  O(nlogn)\n\n    - 3. O(m+n)O(m*n)\n\n        -  m  n \n\n### 2. \n\n- asymptotic space complexity\n-  O(1)O(n)O(n2 ) O(logn)O(nlogn) \n\n### 3. Tips\n\n- O(1)O(logn)O(n)O(nlogn)O(n^2 )\n\n    ![image-20210917165700182](https://tvax2.sinaimg.cn/large/006YzKDNly1gujq9nxktgj60vq0hsgno02.jpg)\n\n## \n\n### 1. \n\n### 2. \n\n- \n- O(n)K\n\n### 3. \n\n### 4. \n\n### 5. \n\n## \n\n![image-20210917165757241](https://tva3.sinaimg.cn/large/006YzKDNly1gujqana3gej60vq0je42y02.jpg)\n\n### 1. O(n^2) \n\n![image-20210917165853155](https://tvax2.sinaimg.cn/large/006YzKDNly1gujqbw4ot7j60vq0g8dk802.jpg)\n\n- \n\n    - \n\n- \n\n    - \n    - leetcode:\n\n    [147. -](https://leetcode-cn.com/problems/insertion-sort-list/)\n\n- \n\n    - \n\n- \n\n### 2. O(nlogn)\n\n![image-20210917165958632](https://tvax3.sinaimg.cn/large/006YzKDNly1gujqcqpdquj60vq0l1wl602.jpg)\n\n-  \n\n    - \n    - O(n)\n    - \n    - merge_sort(pr) = merge(merge_sort(pq), merge_sort(q+1r))\n        p >= r \n    - \n\n-  \n\n    - \n    - O(1)\n    -  p  r  pivot p  r  pivot  pivot  pivot  p  q-1  q+1  r  1\n    - quick_sort(pr) = quick_sort(pq-1) + quick_sort(q+1 r)\n        p >= r\n    - \n\n-  \n\n### 3. O(n)\n\n- \n    - 1.\n        1\n        2nkk\n        3\n    - 2.\n        1kn\n        2\n        310\n    - 2. \n            80-5A[8] = [25302303]\n            6C[6]012345\n            C[6]C[6] = [202301]\n            C[6]C[6]=[224778]c[k]k\n\n- \n\n    - 1.10\n        1abab\n        2\n        311\n        4\n    - 2.\n        1\n        2ab\n        3O(n)\n\n- \n\n    - 1.\n        1\n        2\n    - 2.\n        1m\n        2\n    - 3.\n        1\n        2\n    - 4.\n        1\n        10GB\n        MB\n        2\n        1-10100\n        1-10001001-2000\n        00010299\n        100\n        \n        3\n\n## \n\n### 1. \n\n### 2. \n\n### 3. A*\n\n## \n\n### 1. \n\n### 2. \n\n### 3. \n\n## \n\n### 1. \n\n### 2. KMP\n\n### 3. Robin-karp\n\n### 4. Boyer-Moore\n\n### 5. AC\n\n### 6. Trie\n\n- NABCM\n\n    - O(M*N)\n    - O(M)\n\n- IP  ()\n\n- \n\n    - 1.\n\n        - 1children\n        - 2isEnd\n\n    - 2.\n    - 3.\n\n- \n\n    - 1. Trie \n\n        ![image-20210917170051035](https://tvax3.sinaimg.cn/large/006YzKDNly1gujqdl7gvfj60xc0go42z02.jpg)\n\n        - \n\n            - \n\n                - 1.\n                - 2.\n                    \n\n        - \n\n            - O(m) m m\n            - O(m) Trie  m  O(m) \n\n    - 2. Trie \n\n        ![image-20210917170128796](https://tva4.sinaimg.cn/large/006YzKDNly1gujqe8598lj60lu0gon0902.jpg)\n\n        - \n\n            -  trie \n\n            - 1. \n\n                - 2.  isEnd true false :\n\n                - 1 Trie \n                    - 2 isEndTrie\n\n        - \n\n            -  : O(m) m \n            -  : O(1)\n\n- Leetcode \n\n    - [208.  Trie () -](https://leetcode-cn.com/problems/implement-trie-prefix-tree/)\n    - [211.  - -](https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/)\n    - [212.  II-](https://leetcode-cn.com/problems/word-search-ii/)\n\n### 7. \n\n## \n\n### 1. \n\n### 2. \n\n### 3. \n\n### 4. \n\n### 5. \n\n### 6. \n\n### 7. \n\n","source":"_posts/algorithm-datastructure-outline.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: \ntags:\n  - algorithm\n  - data structure\ncategories:\n  - work\nabbrlink: '2312'\ndate: 2020-11-26 17:33:24\nsubtitle:\n---\n\n# \n\n## \n\n### 1. \n\n-  \n\n### 2. \n\n-  \n-  \n-  \n-  \n-  \n\n### 3. \n\n-  \n-  \n\n### 4. \n\n-  \n-  \n-  \n-  \n-  \n\n## \n\n### 1. \n\n### 2. \n\n-  \n-  \n-  \n\n### 3. \n\n### 4. \n\n## \n\n### 1. \n\n-  \n-  \n-  \n\n    - AVL\n    - \n\n-  \n-  \n\n### 2. \n\n-  B\n-  B+\n-  2-3\n-  2-3-4\n\n### 3. \n\n-  \n-  \n-  \n\n    - \n    - \n    - binary heap. \n    - \n\n        - 1.\n        - 2.iarr[i]\n\n            -  1i - 1/ 2\n            -  22*i + 1\n            -  32*i + 2\n\n        - 3.\n\n    - \n\n        - 1.shift up / bubble up\n        - 2. shift down / bubble down\n\n    - \n        nkOlogn\n        O(k)\n    - Leetcode\n\n        - [347.  K -](https://leetcode-cn.com/problems/top-k-frequent-elements/)\n\n-  \n-  \n\n-  \n\n    -  Binary Indexed Tree\n\n        - K\n        - LeetCode\n\n    - Segment Tree\n\n        - \n        - Leetcode \n\n            - [315. -](https://leetcode-cn.com/problems/count-of-smaller-numbers-after-self/)\n\n## \n\n### 1. \n\n-  \n-  \n\n### 2. \n\n### 3. \n\n### 4. \n\n### 5. \n\n### 6. \n\n### 7. \n\n# \n\n## \n\n### 1. \n\n- \n\n    - 1. \n    - 2. \n    - 3. \n\n- \n\n    ![image-20210917165515820](https://tva2.sinaimg.cn/large/006YzKDNly1gujq7ui7kaj60vq0fwadg02.jpg)\n\n    - 1. O(1)\n\n        - (1)\n\n    - 2. O(logn)O(nlogn)\n\n        - i=1; while (i <= n) { i = i * 2; }\n             O(logn)\n        -  O(logn) n  O(nlogn)  O(nlogn)\n\n    - 3. O(m+n)O(m*n)\n\n        -  m  n \n\n### 2. \n\n- asymptotic space complexity\n-  O(1)O(n)O(n2 ) O(logn)O(nlogn) \n\n### 3. Tips\n\n- O(1)O(logn)O(n)O(nlogn)O(n^2 )\n\n    ![image-20210917165700182](https://tvax2.sinaimg.cn/large/006YzKDNly1gujq9nxktgj60vq0hsgno02.jpg)\n\n## \n\n### 1. \n\n### 2. \n\n- \n- O(n)K\n\n### 3. \n\n### 4. \n\n### 5. \n\n## \n\n![image-20210917165757241](https://tva3.sinaimg.cn/large/006YzKDNly1gujqana3gej60vq0je42y02.jpg)\n\n### 1. O(n^2) \n\n![image-20210917165853155](https://tvax2.sinaimg.cn/large/006YzKDNly1gujqbw4ot7j60vq0g8dk802.jpg)\n\n- \n\n    - \n\n- \n\n    - \n    - leetcode:\n\n    [147. -](https://leetcode-cn.com/problems/insertion-sort-list/)\n\n- \n\n    - \n\n- \n\n### 2. O(nlogn)\n\n![image-20210917165958632](https://tvax3.sinaimg.cn/large/006YzKDNly1gujqcqpdquj60vq0l1wl602.jpg)\n\n-  \n\n    - \n    - O(n)\n    - \n    - merge_sort(pr) = merge(merge_sort(pq), merge_sort(q+1r))\n        p >= r \n    - \n\n-  \n\n    - \n    - O(1)\n    -  p  r  pivot p  r  pivot  pivot  pivot  p  q-1  q+1  r  1\n    - quick_sort(pr) = quick_sort(pq-1) + quick_sort(q+1 r)\n        p >= r\n    - \n\n-  \n\n### 3. O(n)\n\n- \n    - 1.\n        1\n        2nkk\n        3\n    - 2.\n        1kn\n        2\n        310\n    - 2. \n            80-5A[8] = [25302303]\n            6C[6]012345\n            C[6]C[6] = [202301]\n            C[6]C[6]=[224778]c[k]k\n\n- \n\n    - 1.10\n        1abab\n        2\n        311\n        4\n    - 2.\n        1\n        2ab\n        3O(n)\n\n- \n\n    - 1.\n        1\n        2\n    - 2.\n        1m\n        2\n    - 3.\n        1\n        2\n    - 4.\n        1\n        10GB\n        MB\n        2\n        1-10100\n        1-10001001-2000\n        00010299\n        100\n        \n        3\n\n## \n\n### 1. \n\n### 2. \n\n### 3. A*\n\n## \n\n### 1. \n\n### 2. \n\n### 3. \n\n## \n\n### 1. \n\n### 2. KMP\n\n### 3. Robin-karp\n\n### 4. Boyer-Moore\n\n### 5. AC\n\n### 6. Trie\n\n- NABCM\n\n    - O(M*N)\n    - O(M)\n\n- IP  ()\n\n- \n\n    - 1.\n\n        - 1children\n        - 2isEnd\n\n    - 2.\n    - 3.\n\n- \n\n    - 1. Trie \n\n        ![image-20210917170051035](https://tvax3.sinaimg.cn/large/006YzKDNly1gujqdl7gvfj60xc0go42z02.jpg)\n\n        - \n\n            - \n\n                - 1.\n                - 2.\n                    \n\n        - \n\n            - O(m) m m\n            - O(m) Trie  m  O(m) \n\n    - 2. Trie \n\n        ![image-20210917170128796](https://tva4.sinaimg.cn/large/006YzKDNly1gujqe8598lj60lu0gon0902.jpg)\n\n        - \n\n            -  trie \n\n            - 1. \n\n                - 2.  isEnd true false :\n\n                - 1 Trie \n                    - 2 isEndTrie\n\n        - \n\n            -  : O(m) m \n            -  : O(1)\n\n- Leetcode \n\n    - [208.  Trie () -](https://leetcode-cn.com/problems/implement-trie-prefix-tree/)\n    - [211.  - -](https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/)\n    - [212.  II-](https://leetcode-cn.com/problems/word-search-ii/)\n\n### 7. \n\n## \n\n### 1. \n\n### 2. \n\n### 3. \n\n### 4. \n\n### 5. \n\n### 6. \n\n### 7. \n\n","slug":"algorithm-datastructure-outline","published":1,"updated":"2022-04-10T07:04:32.800Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmwee40001kh6z293w8s5a","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li></li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li>AVL</li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li>B</li>\n<li>B+</li>\n<li>2-3</li>\n<li>2-3-4</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>binary heap. </p>\n</li>\n<li><p></p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.iarr[i]</p>\n<ul>\n<li>1i - 1/ 2</li>\n<li>22*i + 1</li>\n<li>32*i + 2</li>\n</ul>\n</li>\n<li><p>3.</p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.shift up / bubble up</li>\n<li>2. shift down / bubble down</li>\n</ul>\n</li>\n<li><p><br>  nkOlogn<br>  O(k)</p>\n</li>\n<li><p>Leetcode</p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/top-k-frequent-elements/\" target=\"_blank\" rel=\"noopener\">347.  K -</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p> Binary Indexed Tree</p>\n<ul>\n<li>K</li>\n<li>LeetCode</li>\n</ul>\n</li>\n<li><p>Segment Tree</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Leetcode </p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/count-of-smaller-numbers-after-self/\" target=\"_blank\" rel=\"noopener\">315. -</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li><p></p>\n<ul>\n<li><ol>\n<li></li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li></li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<p>  <img src=\"https://tva2.sinaimg.cn/large/006YzKDNly1gujq7ui7kaj60vq0fwadg02.jpg\" alt=\"image-20210917165515820\"></p>\n<ul>\n<li><ol>\n<li><p>O(1)</p>\n<ul>\n<li>(1)</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li><p>O(logn)O(nlogn)</p>\n<ul>\n<li>i=1; while (i &lt;= n) { i = i * 2; }<br>  O(logn)</li>\n<li> O(logn) n  O(nlogn)  O(nlogn)</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li><p>O(m+n)O(m*n)</p>\n<ul>\n<li> m  n </li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li>asymptotic space complexity</li>\n<li> O(1)O(n)O(n2 ) O(logn)O(nlogn) </li>\n</ul>\n<h3 id=\"3-Tips\"><a href=\"#3-Tips\" class=\"headerlink\" title=\"3. Tips\"></a>3. Tips</h3><ul>\n<li><p>O(1)O(logn)O(n)O(nlogn)O(n^2 )</p>\n<p>  <img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gujq9nxktgj60vq0hsgno02.jpg\" alt=\"image-20210917165700182\"></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li>O(n)K</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://tva3.sinaimg.cn/large/006YzKDNly1gujqana3gej60vq0je42y02.jpg\" alt=\"image-20210917165757241\"></p>\n<h3 id=\"1-O-n-2\"><a href=\"#1-O-n-2\" class=\"headerlink\" title=\"1. O(n^2)\"></a>1. O(n^2)</h3><p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gujqbw4ot7j60vq0g8dk802.jpg\" alt=\"image-20210917165853155\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>leetcode:</p>\n<p><a href=\"https://leetcode-cn.com/problems/insertion-sort-list/\" target=\"_blank\" rel=\"noopener\">147. -</a></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"2-O-nlogn\"><a href=\"#2-O-nlogn\" class=\"headerlink\" title=\"2. O(nlogn)\"></a>2. O(nlogn)</h3><p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gujqcqpdquj60vq0l1wl602.jpg\" alt=\"image-20210917165958632\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li></li>\n<li>O(n)</li>\n<li></li>\n<li>merge_sort(pr) = merge(merge_sort(pq), merge_sort(q+1r))<br>  p &gt;= r </li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li>O(1)</li>\n<li> p  r  pivot p  r  pivot  pivot  pivot  p  q-1  q+1  r  1</li>\n<li>quick_sort(pr) = quick_sort(pq-1) + quick_sort(q+1 r)<br>  p &gt;= r</li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"3-O-n\"><a href=\"#3-O-n\" class=\"headerlink\" title=\"3. O(n)\"></a>3. O(n)</h3><ul>\n<li><p></p>\n<ul>\n<li>1.<br>  1<br>  2nkk<br>  3</li>\n<li>2.<br>  1kn<br>  2<br>  310</li>\n<li><ol start=\"2\">\n<li><br>   80-5A[8] = [25302303]<br>   6C[6]012345<br>   C[6]C[6] = [202301]<br>   C[6]C[6]=[224778]c[k]k</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.10<br>  1abab<br>  2<br>  311<br>  4</li>\n<li>2.<br>  1<br>  2ab<br>  3O(n)</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.<br>  1<br>  2</li>\n<li>2.<br>  1m<br>  2</li>\n<li>3.<br>  1<br>  2</li>\n<li>4.<br>  1<br>  10GB<br>  MB<br>  2<br>  1-10100<br>  1-10001001-2000<br>  00010299<br>  100<br>  <br>  3</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-A-\"><a href=\"#3-A-\" class=\"headerlink\" title=\"3. A*\"></a>3. A*</h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-KMP\"><a href=\"#2-KMP\" class=\"headerlink\" title=\"2. KMP\"></a>2. KMP</h3><h3 id=\"3-Robin-karp\"><a href=\"#3-Robin-karp\" class=\"headerlink\" title=\"3. Robin-karp\"></a>3. Robin-karp</h3><h3 id=\"4-Boyer-Moore\"><a href=\"#4-Boyer-Moore\" class=\"headerlink\" title=\"4. Boyer-Moore\"></a>4. Boyer-Moore</h3><h3 id=\"5-AC\"><a href=\"#5-AC\" class=\"headerlink\" title=\"5. AC\"></a>5. AC</h3><h3 id=\"6-Trie\"><a href=\"#6-Trie\" class=\"headerlink\" title=\"6. Trie\"></a>6. Trie</h3><ul>\n<li><p>NABCM</p>\n<ul>\n<li>O(M*N)</li>\n<li>O(M)</li>\n</ul>\n</li>\n<li><p>IP  ()</p>\n</li>\n<li><p></p>\n<ul>\n<li><p>1.</p>\n<ul>\n<li>1children</li>\n<li>2isEnd</li>\n</ul>\n</li>\n<li><p>2.</p>\n</li>\n<li><p>3.</p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p>1. Trie </p>\n<p>  <img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gujqdl7gvfj60xc0go42z02.jpg\" alt=\"image-20210917170051035\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li><p></p>\n<ul>\n<li>1.</li>\n<li>2.<br>  </li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>O(m) m m</li>\n<li>O(m) Trie  m  O(m) </li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>2. Trie </p>\n<p>  <img src=\"https://tva4.sinaimg.cn/large/006YzKDNly1gujqe8598lj60lu0gon0902.jpg\" alt=\"image-20210917170128796\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li><p> trie </p>\n</li>\n<li><ol>\n<li><p></p>\n<ul>\n<li><ol start=\"2\">\n<li> isEnd true false :</li>\n</ol>\n</li>\n<li><p>1 Trie </p>\n<ul>\n<li>2 isEndTrie</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> : O(m) m </li>\n<li> : O(1)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>Leetcode </p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/implement-trie-prefix-tree/\" target=\"_blank\" rel=\"noopener\">208.  Trie () -</a></li>\n<li><a href=\"https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/\" target=\"_blank\" rel=\"noopener\">211.  - -</a></li>\n<li><a href=\"https://leetcode-cn.com/problems/word-search-ii/\" target=\"_blank\" rel=\"noopener\">212.  II-</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3>","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li></li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li>AVL</li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li>B</li>\n<li>B+</li>\n<li>2-3</li>\n<li>2-3-4</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p>binary heap. </p>\n</li>\n<li><p></p>\n<ul>\n<li><p>1.</p>\n</li>\n<li><p>2.iarr[i]</p>\n<ul>\n<li>1i - 1/ 2</li>\n<li>22*i + 1</li>\n<li>32*i + 2</li>\n</ul>\n</li>\n<li><p>3.</p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.shift up / bubble up</li>\n<li>2. shift down / bubble down</li>\n</ul>\n</li>\n<li><p><br>  nkOlogn<br>  O(k)</p>\n</li>\n<li><p>Leetcode</p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/top-k-frequent-elements/\" target=\"_blank\" rel=\"noopener\">347.  K -</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<ul>\n<li><p> Binary Indexed Tree</p>\n<ul>\n<li>K</li>\n<li>LeetCode</li>\n</ul>\n</li>\n<li><p>Segment Tree</p>\n<ul>\n<li><p></p>\n</li>\n<li><p>Leetcode </p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/count-of-smaller-numbers-after-self/\" target=\"_blank\" rel=\"noopener\">315. -</a></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3><h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><ul>\n<li><p></p>\n<ul>\n<li><ol>\n<li></li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li></li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<p>  <img src=\"https://tva2.sinaimg.cn/large/006YzKDNly1gujq7ui7kaj60vq0fwadg02.jpg\" alt=\"image-20210917165515820\"></p>\n<ul>\n<li><ol>\n<li><p>O(1)</p>\n<ul>\n<li>(1)</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><ol start=\"2\">\n<li><p>O(logn)O(nlogn)</p>\n<ul>\n<li>i=1; while (i &lt;= n) { i = i * 2; }<br>  O(logn)</li>\n<li> O(logn) n  O(nlogn)  O(nlogn)</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><ol start=\"3\">\n<li><p>O(m+n)O(m*n)</p>\n<ul>\n<li> m  n </li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li>asymptotic space complexity</li>\n<li> O(1)O(n)O(n2 ) O(logn)O(nlogn) </li>\n</ul>\n<h3 id=\"3-Tips\"><a href=\"#3-Tips\" class=\"headerlink\" title=\"3. Tips\"></a>3. Tips</h3><ul>\n<li><p>O(1)O(logn)O(n)O(nlogn)O(n^2 )</p>\n<p>  <img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gujq9nxktgj60vq0hsgno02.jpg\" alt=\"image-20210917165700182\"></p>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><ul>\n<li></li>\n<li>O(n)K</li>\n</ul>\n<h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p><img src=\"https://tva3.sinaimg.cn/large/006YzKDNly1gujqana3gej60vq0je42y02.jpg\" alt=\"image-20210917165757241\"></p>\n<h3 id=\"1-O-n-2\"><a href=\"#1-O-n-2\" class=\"headerlink\" title=\"1. O(n^2)\"></a>1. O(n^2)</h3><p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gujqbw4ot7j60vq0g8dk802.jpg\" alt=\"image-20210917165853155\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p></p>\n</li>\n<li><p>leetcode:</p>\n<p><a href=\"https://leetcode-cn.com/problems/insertion-sort-list/\" target=\"_blank\" rel=\"noopener\">147. -</a></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"2-O-nlogn\"><a href=\"#2-O-nlogn\" class=\"headerlink\" title=\"2. O(nlogn)\"></a>2. O(nlogn)</h3><p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gujqcqpdquj60vq0l1wl602.jpg\" alt=\"image-20210917165958632\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li></li>\n<li>O(n)</li>\n<li></li>\n<li>merge_sort(pr) = merge(merge_sort(pq), merge_sort(q+1r))<br>  p &gt;= r </li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li>O(1)</li>\n<li> p  r  pivot p  r  pivot  pivot  pivot  p  q-1  q+1  r  1</li>\n<li>quick_sort(pr) = quick_sort(pq-1) + quick_sort(q+1 r)<br>  p &gt;= r</li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n</ul>\n<h3 id=\"3-O-n\"><a href=\"#3-O-n\" class=\"headerlink\" title=\"3. O(n)\"></a>3. O(n)</h3><ul>\n<li><p></p>\n<ul>\n<li>1.<br>  1<br>  2nkk<br>  3</li>\n<li>2.<br>  1kn<br>  2<br>  310</li>\n<li><ol start=\"2\">\n<li><br>   80-5A[8] = [25302303]<br>   6C[6]012345<br>   C[6]C[6] = [202301]<br>   C[6]C[6]=[224778]c[k]k</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.10<br>  1abab<br>  2<br>  311<br>  4</li>\n<li>2.<br>  1<br>  2ab<br>  3O(n)</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>1.<br>  1<br>  2</li>\n<li>2.<br>  1m<br>  2</li>\n<li>3.<br>  1<br>  2</li>\n<li>4.<br>  1<br>  10GB<br>  MB<br>  2<br>  1-10100<br>  1-10001001-2000<br>  00010299<br>  100<br>  <br>  3</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-A-\"><a href=\"#3-A-\" class=\"headerlink\" title=\"3. A*\"></a>3. A*</h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-KMP\"><a href=\"#2-KMP\" class=\"headerlink\" title=\"2. KMP\"></a>2. KMP</h3><h3 id=\"3-Robin-karp\"><a href=\"#3-Robin-karp\" class=\"headerlink\" title=\"3. Robin-karp\"></a>3. Robin-karp</h3><h3 id=\"4-Boyer-Moore\"><a href=\"#4-Boyer-Moore\" class=\"headerlink\" title=\"4. Boyer-Moore\"></a>4. Boyer-Moore</h3><h3 id=\"5-AC\"><a href=\"#5-AC\" class=\"headerlink\" title=\"5. AC\"></a>5. AC</h3><h3 id=\"6-Trie\"><a href=\"#6-Trie\" class=\"headerlink\" title=\"6. Trie\"></a>6. Trie</h3><ul>\n<li><p>NABCM</p>\n<ul>\n<li>O(M*N)</li>\n<li>O(M)</li>\n</ul>\n</li>\n<li><p>IP  ()</p>\n</li>\n<li><p></p>\n<ul>\n<li><p>1.</p>\n<ul>\n<li>1children</li>\n<li>2isEnd</li>\n</ul>\n</li>\n<li><p>2.</p>\n</li>\n<li><p>3.</p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p>1. Trie </p>\n<p>  <img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gujqdl7gvfj60xc0go42z02.jpg\" alt=\"image-20210917170051035\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li><p></p>\n<ul>\n<li>1.</li>\n<li>2.<br>  </li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>O(m) m m</li>\n<li>O(m) Trie  m  O(m) </li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>2. Trie </p>\n<p>  <img src=\"https://tva4.sinaimg.cn/large/006YzKDNly1gujqe8598lj60lu0gon0902.jpg\" alt=\"image-20210917170128796\"></p>\n<ul>\n<li><p></p>\n<ul>\n<li><p> trie </p>\n</li>\n<li><ol>\n<li><p></p>\n<ul>\n<li><ol start=\"2\">\n<li> isEnd true false :</li>\n</ol>\n</li>\n<li><p>1 Trie </p>\n<ul>\n<li>2 isEndTrie</li>\n</ul>\n</li>\n</ul>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> : O(m) m </li>\n<li> : O(1)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>Leetcode </p>\n<ul>\n<li><a href=\"https://leetcode-cn.com/problems/implement-trie-prefix-tree/\" target=\"_blank\" rel=\"noopener\">208.  Trie () -</a></li>\n<li><a href=\"https://leetcode-cn.com/problems/design-add-and-search-words-data-structure/\" target=\"_blank\" rel=\"noopener\">211.  - -</a></li>\n<li><a href=\"https://leetcode-cn.com/problems/word-search-ii/\" target=\"_blank\" rel=\"noopener\">212.  II-</a></li>\n</ul>\n</li>\n</ul>\n<h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h3><h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><h3 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h3><h3 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h3><h3 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h3><h3 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h3><h3 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7. \"></a>7. </h3>"},{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"f6ae","date":"2021-07-14T16:00:00.000Z","subtitle":null,"_content":"\n### \n\n`````DP table`````\n\n\n\n#### \n\n** base case -> ->  ->  dp /**\n\n```java\n#  base case\ndp[0][0][...] = base\n# \nfor 1 in 1\n    for 2 in 2\n        for ...\n            dp[1][2][...] = (12...)\n```\n\n","source":"_posts/algorithm-dp-thinking.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - algorithm\ncategories:\n  - work\nabbrlink: f6ae\ndate: 2021-07-15 00:00:00\nsubtitle:\n---\n\n### \n\n`````DP table`````\n\n\n\n#### \n\n** base case -> ->  ->  dp /**\n\n```java\n#  base case\ndp[0][0][...] = base\n# \nfor 1 in 1\n    for 2 in 2\n        for ...\n            dp[1][2][...] = (12...)\n```\n\n","slug":"algorithm-dp-thinking","published":1,"updated":"2022-04-23T08:53:29.786Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmwee60002kh6z9x8b4zc0","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code></code><code></code><code>DP table</code><code></code><code></code></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong> base case -&gt; -&gt;  -&gt;  dp /</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#  base case</span><br><span class=\"line\">dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>][...] = base</span><br><span class=\"line\"># </span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"number\">1</span> in <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"number\">2</span> in <span class=\"number\">2</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> ...</span><br><span class=\"line\">            dp[<span class=\"number\">1</span>][<span class=\"number\">2</span>][...] = (<span class=\"number\">1</span><span class=\"number\">2</span>...)</span><br></pre></td></tr></table></figure>\n\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p><code></code><code></code><code>DP table</code><code></code><code></code></p>\n<p></p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p><strong> base case -&gt; -&gt;  -&gt;  dp /</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">#  base case</span><br><span class=\"line\">dp[<span class=\"number\">0</span>][<span class=\"number\">0</span>][...] = base</span><br><span class=\"line\"># </span><br><span class=\"line\"><span class=\"keyword\">for</span> <span class=\"number\">1</span> in <span class=\"number\">1</span></span><br><span class=\"line\">    <span class=\"keyword\">for</span> <span class=\"number\">2</span> in <span class=\"number\">2</span></span><br><span class=\"line\">        <span class=\"keyword\">for</span> ...</span><br><span class=\"line\">            dp[<span class=\"number\">1</span>][<span class=\"number\">2</span>][...] = (<span class=\"number\">1</span><span class=\"number\">2</span>...)</span><br></pre></td></tr></table></figure>\n\n"},{"abbrlink":"8c68","title":"HTTP","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"date":"2020-12-08T16:00:00.000Z","_content":"HTTP\n\n![image-20211209172958837.png](https://s2.loli.net/2021/12/10/EdMxp3t2HmGsweT.png)\n\n1xx\n1xx \n2xx\n2xx \n200 OK HEAD \n body \n204 No Content 200 OK  body \n206 Partial Content HTTP  body \n\n3xx\n3xx  URL \n\n301 Moved Permanently URL \n\n302 Found URL \n301  302  Location  URL\nURL\n304 Not Modified\n\n4xx\n4xx \n400 Bad Request\n403 Forbidden\n404 Not Found\n5xx\n5xx \n\n500 Internal Server Error 400 \n\n501 Not Implemented\n502 Bad Gateway\n\n503 Service Unavailable\n\n\n```\n\n\n```","source":"_posts/HTTP.md","raw":"---\nabbrlink: 8c68\ntitle: HTTP\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - http\ncategories:\n  - work\ndate: 2020-12-09 00:00:00\n---\nHTTP\n\n![image-20211209172958837.png](https://s2.loli.net/2021/12/10/EdMxp3t2HmGsweT.png)\n\n1xx\n1xx \n2xx\n2xx \n200 OK HEAD \n body \n204 No Content 200 OK  body \n206 Partial Content HTTP  body \n\n3xx\n3xx  URL \n\n301 Moved Permanently URL \n\n302 Found URL \n301  302  Location  URL\nURL\n304 Not Modified\n\n4xx\n4xx \n400 Bad Request\n403 Forbidden\n404 Not Found\n5xx\n5xx \n\n500 Internal Server Error 400 \n\n501 Not Implemented\n502 Bad Gateway\n\n503 Service Unavailable\n\n\n```\n\n\n```","slug":"HTTP","published":1,"updated":"2022-04-23T08:59:01.133Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweea0005kh6zaxdvhck0","content":"<p>HTTP</p>\n<p><img src=\"https://s2.loli.net/2021/12/10/EdMxp3t2HmGsweT.png\" alt=\"image-20211209172958837.png\"></p>\n<p>1xx<br>1xx <br>2xx<br>2xx <br>200 OK HEAD <br> body <br>204 No Content 200 OK  body <br>206 Partial Content HTTP  body <br><br>3xx<br>3xx  URL <br><br>301 Moved Permanently URL <br><br>302 Found URL <br>301  302  Location  URL<br>URL<br>304 Not Modified<br><br>4xx<br>4xx <br>400 Bad Request<br>403 Forbidden<br>404 Not Found<br>5xx<br>5xx <br><br>500 Internal Server Error 400 <br><br>501 Not Implemented<br>502 Bad Gateway<br><br>503 Service Unavailable<br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>","site":{"data":{}},"excerpt":"","more":"<p>HTTP</p>\n<p><img src=\"https://s2.loli.net/2021/12/10/EdMxp3t2HmGsweT.png\" alt=\"image-20211209172958837.png\"></p>\n<p>1xx<br>1xx <br>2xx<br>2xx <br>200 OK HEAD <br> body <br>204 No Content 200 OK  body <br>206 Partial Content HTTP  body <br><br>3xx<br>3xx  URL <br><br>301 Moved Permanently URL <br><br>302 Found URL <br>301  302  Location  URL<br>URL<br>304 Not Modified<br><br>4xx<br>4xx <br>400 Bad Request<br>403 Forbidden<br>404 Not Found<br>5xx<br>5xx <br><br>500 Internal Server Error 400 <br><br>501 Not Implemented<br>502 Bad Gateway<br><br>503 Service Unavailable<br></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br><span class=\"line\"></span><br></pre></td></tr></table></figure>"},{"title":"---","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":0,"abbrlink":"73b3","date":"2020-12-21T16:00:00.000Z","subtitle":null,"_content":"### ---\n### ---\n### ---\n### ---\n### ---\n","source":"_posts/algorithm-heap.md","raw":"---\ntitle: ---\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: 0\ntags:\n  - algorithm\ncategories:\n  - work\nabbrlink: 73b3\ndate: 2020-12-22 00:00:00\nsubtitle:\n---\n### ---\n### ---\n### ---\n### ---\n### ---\n","slug":"algorithm-heap","published":1,"updated":"2021-11-10T13:43:16.135Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweeb0006kh6zd7702xgt","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>"},{"title":"BIO NIONetty","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"5dae","date":"2021-08-24T16:00:00.000Z","subtitle":null,"_content":"# BIONIONetty\n\n\n\n> ### \n>\n> \t\tClient/ServerIPSocket\n>\n> ### BIO:\n>\n> \t\t1.4Java IOIOBlocking IOBIO\n>\n> ### NIO:\n>\n> \t\tIOJavaIOJAVA NIONon-Blocking IOJava NIO IO\n>\n> ### Netty:\n>\n> \t\tNetty[](https://baike.baidu.com/item//9597519)NIONetty [](https://baike.baidu.com/item//6492316)\n\n\n\n## 1. Java BIO\n\n### 1.1 Java BIO\n\n- IO\n\n    ![bio-model](https://i.loli.net/2021/10/18/6jJxcVENwszR8Wd.png)\n\n### 1.2 Java BIO \n\n1.  `ServerSocket`\n2.  `Socket` \n3. \n\n### 1.3 Java BIO([github](https://github.com/VickyLuoLuo/netty.git))\n\n- BIO\n\n```java\nimport java.io.IOException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\n\npublic class BioServer {\n\n    public static void main(String[] args) throws IOException {\n        // ServerSocket\n        ServerSocket serverSocket = new ServerSocket(9090);\n        System.out.println(\"\");\n        while (true) {\n            //\n            System.out.println(\"....\");\n            final Socket socket = serverSocket.accept(); // \n            System.out.println(\"\");\n            byte[] bytes = new byte[1024];\n            socket.getInputStream().read(bytes); // \n            System.out.println(\"\" + new String(bytes));\n        }\n    }\n}\n```\n\n- `socket.getInputStream().read(bytes)`\n\n```java\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class BioServer {\n\n    public static void main(String[] args) throws IOException {\n        // ServerSocket\n        ServerSocket serverSocket = new ServerSocket(9090);\n        System.out.println(\"\");\n        // ,: 1.  2. ()\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        while (true) {\n            //\n            System.out.println(\"....\");\n            final Socket socket = serverSocket.accept(); // \n            System.out.println(\"\");\n            newCachedThreadPool.execute(() -> {\n                // \n                handler(socket);\n            });\n        }\n    }\n\n    public static void handler(Socket socket) {\n        try {\n            byte[] bytes = new byte[1024];\n            //socket\n            InputStream inputStream = socket.getInputStream();\n            //\n            while (true) {\n                System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\");\n                int read = inputStream.read(bytes); // \n                if (read != -1) {\n                    System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\" + new String(bytes, 0, read));\n                } else {\n                    break;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\"); \n            try {\n                socket.close();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n```\n\n\t\t`inputStream.read(bytes)`\n\n## 2. Java NIO\n\n### 2.1 Java NIO\n\n- IO `I/O` \n\n    ![nio-model](https://i.loli.net/2021/10/18/ABy7qJoGhwaSzip.png)\n\n### 2.2 Java NIO\n\n1. ####  Channel\n\n    BIOInput StreamOutput StreamNIONIOIOBIO\n\n2. ####  Selector\n\n    > IO//\n\n    IOselectIO/\n\n3. #### Buffer\n\n    Channelreadwrite\n\n### 2.3 SelectorChannel  Buffer \n\n1.  `Channel`  `Buffer`\n2. `Selector`  `Channel`\n3. `Selector` \n4. `Buffer` \n5.  `Buffer``BIO`  `NIO`  `Buffer`  `flip`  `Channel`  `Linux`\n\n![nio-element](https://i.loli.net/2021/10/18/4F5pSqTYbayDgsJ.png)\n\n### 2.4 Java NIO \n\n1.  `ServerSocketChannel`---BIOServerSocket\n\n2.  `SocketChannel`---BIOSocket\n\n3. `Selector``ServerSocketChannel``Selector` `SelectionKey` `Selector`  `Selector`  `SocketChannel`\n\n4.  `ServerSocketChannel` `SocketChannel`\n\n5. `Selector`  `select` \n\n6.  `socketChannel`  `Selector`  `SelectionKey`\n\n7.  `SelectionKey`  `SocketChannel`\n\n8.  `channel`\n\n    ![nio-workflow](https://i.loli.net/2021/10/18/ybcGt7zRT459L8Z.png)\n\n### 2.4 Java NIO ([github](https://github.com/VickyLuoLuo/netty.git))\n\n- NIO`List<SocketChannel>``SocketChannel`IO\n\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.ServerSocketChannel;\nimport java.nio.channels.SocketChannel;\nimport java.util.ArrayList;\nimport java.util.Iterator;\nimport java.util.List;\n\npublic class NioServer {\n\n    static List<SocketChannel> channelList = new ArrayList<>();\n\n    public static void startServer() throws IOException {\n\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5252));\n        System.out.println(\"\");\n\n        // IO\n        while (true) {\n\n            // \n            SocketChannel socketChannel = serverSocketChannel.accept(); // \n            if (null != socketChannel) {\n                System.out.println(\"\");\n                // SocketChannelNIOaccept\n                socketChannel.configureBlocking(false);\n\n                channelList.add(socketChannel);\n            }\n            // \n            Iterator<SocketChannel> channels = channelList.iterator();\n            while (channels.hasNext()) {\n                // \n                SocketChannel channel = channels.next();\n                ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                // read\n                int length = channel.read(byteBuffer); // \n                if (length > 0) {\n                    System.out.println(\"\" + new String(byteBuffer.array(), 0, length));\n                } else if (length == -1) {\n                    channels.remove();\n                    System.out.println(\"\");\n                }\n\n            }\n        }\n    }\n\n    public static void main(String[] args) throws IOException {\n        startServer();\n    }\n}\n```\n\n- `serverSocketChannel.accept()``channel.read(byteBuffer)``while(true)``Selector``selector.select()`\n\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.SelectionKey;\nimport java.nio.channels.Selector;\nimport java.nio.channels.ServerSocketChannel;\nimport java.nio.channels.SocketChannel;\nimport java.util.Iterator;\n\npublic class NioSelectorServer {\n    public static void startServer() throws IOException {\n\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5656));\n        System.out.println(\"\");\n\n        // \n        Selector selector = Selector.open(); // epoll\n        // IO\n        SelectionKey selectionKey = serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        // IO\n        while (selector.select() > 0) { //  epoll-wait\n            // \n            Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n            while (selectedKeys.hasNext()) {\n                // \n                SelectionKey selectedKey = selectedKeys.next();\n                if (selectedKey.isAcceptable()) {\n                    // IO\n                    SocketChannel socketChannel = serverSocketChannel.accept();\n                    // \n                    socketChannel.configureBlocking(false);\n                    // \n                    socketChannel.register(selector, SelectionKey.OP_READ);\n                    System.out.println(\"\");\n                } else if (selectedKey.isReadable()) {\n                    // IO\n                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();\n                    // \n                    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                    // read\n                    int length = socketChannel.read(byteBuffer);\n                    if (length > 0) {\n                        System.out.println(\"\" + new String(byteBuffer.array(), 0, length));\n                    } else if (length == -1) {\n                        System.out.println(\"\");\n                        socketChannel.close();\n                    }\n                }\n                // \n                selectedKeys.remove();\n            }\n        }\n        // \n        serverSocketChannel.close();\n    }\n\n    public static void main(String[] args) throws IOException {\n        startServer();\n    }\n}\n```\n\n### 2.5 `Selector`\n\n\t`Selector`IO`epoll`(Linux)`epoll`\n\n1. epoll_create\n\n    epollchannel \n\n2. epoll_ctl\n\n    //channel\n\n3. epoll_wait\n\n    IO channel\n\n### 2.6 Java NIO \n\n\t\t[Java NIO](https://vickyluoluo.github.io/2021/03/31/57bd.html)\n\n## 3. Netty\n\n### 3.1 NIO\n\n1. `NIO`  `API`  `Selector``ServerSocketChannel``SocketChannel``ByteBuffer`\n2.  `Java`  `NIO`  `Reactor`  `NIO` \n3. \n4.  `JDK NIO`  `Bug` `Epoll Bug` `Selector`  `CPU100%` `JDK1.7` \n\n### 3.2 Netty \n\n`Netty`  `JDK`  `NIO`  `API` \n\n1.  `API`  `Socket`-\n2.  `Javadoc``JDK5Netty3.x` `6Netty4.x`\n3. \n4.  `SSL/TLS`  `StartTLS` \n5.  `Bug` \n\n### 3.3 Netty\n\n![](https://i.loli.net/2021/10/18/3cnCUJG4yerixqK.png)\n\n`Netty`  `Reactors` `BossGroup`  `Selector` `Accecpt`  `Accept`  `SocketChannel` `NIOScoketChannel`  `Worker`  `Worker`  `Selector`  `handler`\n\n![](https://i.loli.net/2021/10/18/chLyW8ko5aRuPqN.png)\n\n\n\n1. `Netty`  `BossGroup` `WorkerGroup` \n2. `BossGroup`  `WorkerGroup`  `NioEventLoopGroup` \n3. `NioEventLoopGroup`  `NioEventLoop` \n4. `NioEventLoop`  `NioEventLoop`  `Selector` `socket` \n5. `NioEventLoopGroup`  `NioEventLoop` \n6.  `BossNioEventLoop`  `3` \n    -  `accept` \n    -  `accept`  `client`  `NioScocketChannel` `worker` `NIOEventLoop`  `Selector`\n    -  `runAllTasks`\n7.  `Worker` `NIOEventLoop` \n    -  `read``write` \n    -  `I/O`  `read``write`  `NioScocketChannel` \n    -  `runAllTasks`\n8.  `Worker` `NIOEventLoop`  `pipeline``pipeline`  `channel` `pipeline` \n\n### 3.4 Netty ([github](https://github.com/VickyLuoLuo/netty.git))\n\n- Netty\n    1. `NettyServer.java` \n\n```java\nimport io.netty.bootstrap.ServerBootstrap;\nimport io.netty.channel.*;\nimport io.netty.channel.nio.NioEventLoopGroup;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.channel.socket.nio.NioServerSocketChannel;\n\npublic class NettyServer {\n\n    public static void main(String[] args) throws Exception {\n\n        //bossGroupworkerGroupcpu * 2bossGroup,workerGroup\n        EventLoopGroup bossGroup = new NioEventLoopGroup(1);\n        EventLoopGroup workerGroup = new NioEventLoopGroup(8);\n\n        try {\n            //\n            ServerBootstrap bootstrap = new ServerBootstrap();\n            //\n            bootstrap.group(bossGroup, workerGroup) //\n                    .channel(NioServerSocketChannel.class) //NioSocketChannel \n                    .option(ChannelOption.SO_BACKLOG, 128) // \n                    .childHandler(new ChannelInitializer<SocketChannel>() {//()\n                        //workGroupSocketChannel\n                        @Override\n                        protected void initChannel(SocketChannel ch) {\n                            System.out.println(\"socketchannel hashcode=\" + ch.hashCode()); // SocketChannel channel  NIOEventLoop  taskQueue  scheduleTaskQueue\n                            ch.pipeline().addLast(new NettyServerHandler()); // \n                        }\n                    });\n\n            System.out.println(\"..... is ready...\");\n\n            //bindisDone()\n            ChannelFuture cf = bootstrap.bind(6668).sync();\n\n            //cf \n            cf.addListener((ChannelFutureListener) future -> {\n                if (cf.isSuccess()) {\n                    System.out.println(\"\");\n                } else {\n                    System.out.println(\"\");\n                }\n            });\n\n            //\n            cf.channel().closeFuture().sync();\n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n}\n```\n\n\t\t\t2. `NettyServerHandler.java ``ChannelHandler`\n\n```java\nimport io.netty.buffer.ByteBuf;\nimport io.netty.buffer.Unpooled;\nimport io.netty.channel.*;\nimport io.netty.util.CharsetUtil;\n\npublic class NettyServerHandler extends ChannelInboundHandlerAdapter {\n\n    /**\n     * \n     * @param ctx: ,  pipeline , channel, \n     */\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        System.out.println(\"\");\n    }\n\n    /**\n     * ()\n     * @param ctx:,  pipeline , channel, \n     * @param msg:  Object\n     */\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n\n        Channel channel = ctx.channel();\n        // msg  ByteBuf,ByteBuf  Netty  NIO  ByteBuffer.\n        ByteBuf buf = (ByteBuf) msg;\n        System.out.println(\":\" + buf.toString(CharsetUtil.UTF_8));\n        System.out.println(\":\" + channel.remoteAddress());\n    }\n\n    /**\n     *  \n     */\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) {\n        //\n        ctx.writeAndFlush(Unpooled.copiedBuffer(\"hello, \", CharsetUtil.UTF_8));\n    }\n\n    /**\n     * , \n     * @param ctx\n     * @param cause\n     */\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n        ctx.close();\n    }\n}\n\n```\n\n- `SpringBoot` + `Netty`([github](https://github.com/VickyLuoLuo/netty.git))\n\n```java\nimport io.netty.channel.ChannelInitializer;\nimport io.netty.channel.ChannelPipeline;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.handler.codec.http.HttpObjectAggregator;\nimport io.netty.handler.codec.http.HttpServerCodec;\nimport io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler;\nimport io.netty.handler.stream.ChunkedWriteHandler;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Qualifier(\"somethingChannelInitializer\")\npublic class NettyWebSocketChannelInitializer extends ChannelInitializer<SocketChannel> {\n\n    @Autowired\n    private TextWebSocketFrameHandler textWebSocketFrameHandler;\n\n    @Override\n    public void initChannel(SocketChannel ch) throws Exception {//2\n        ChannelPipeline pipeline = ch.pipeline();\n\n        pipeline.addLast(new HttpServerCodec()); // http\n        pipeline.addLast(new HttpObjectAggregator(64*1024)); // http\n        pipeline.addLast(new ChunkedWriteHandler()); // \n        pipeline.addLast(new WebSocketServerProtocolHandler(\"/ws\")); //\n        pipeline.addLast(textWebSocketFrameHandler); // ChannelHandler\n\n    }\n}\n```\n\n```java\nimport com.lhl.netty.chat.util.RandomName;\nimport com.lhl.netty.chat.util.RedisDao;\nimport io.netty.channel.Channel;\nimport io.netty.channel.ChannelHandler;\nimport io.netty.channel.ChannelHandlerContext;\nimport io.netty.channel.SimpleChannelInboundHandler;\nimport io.netty.channel.group.ChannelGroup;\nimport io.netty.channel.group.DefaultChannelGroup;\nimport io.netty.handler.codec.http.websocketx.TextWebSocketFrame;\nimport io.netty.util.concurrent.GlobalEventExecutor;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Qualifier(\"textWebSocketFrameHandler\")\n@ChannelHandler.Sharable\npublic class TextWebSocketFrameHandler extends SimpleChannelInboundHandler<TextWebSocketFrame> {\n\n    public static ChannelGroup channels = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);\n\n    @Autowired\n    private RedisDao redisDao;\n\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx,\n                                TextWebSocketFrame msg) throws Exception {\n        Channel incoming = ctx.channel();\n        String uName = redisDao.getString(incoming.id()+\"\");\n        for (Channel channel : channels) {\n            if (channel != incoming){\n                channel.writeAndFlush(new TextWebSocketFrame(\"[\" + uName + \"]\" + msg.text()));\n            } else {\n                channel.writeAndFlush(new TextWebSocketFrame(\"[]\" + msg.text() ));\n            }\n        }\n    }\n\n    @Override\n    public void handlerAdded(ChannelHandlerContext ctx) throws Exception {\n        System.out.println(ctx.channel().remoteAddress());\n        String uName = new RandomName().getRandomName();\n\n        Channel incoming = ctx.channel();\n        for (Channel channel : channels) {\n            channel.writeAndFlush(new TextWebSocketFrame(\"[] - \" + uName + \" \"));\n        }\n        redisDao.saveString(incoming.id()+\"\",uName);\n        channels.add(ctx.channel());\n    }\n\n    @Override\n    public void handlerRemoved(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        String uName = redisDao.getString(String.valueOf(incoming.id()));\n        for (Channel channel : channels) {\n            channel.writeAndFlush(new TextWebSocketFrame(\"[] - \" + uName + \" \"));\n        }\n        redisDao.deleteString(String.valueOf(incoming.id()));\n\n        channels.remove(ctx.channel());\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n    }\n\n\n    @Override\n    public void channelInactive(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause)\n            throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n        cause.printStackTrace();\n        ctx.close();\n    }\n\n}\n```\n\n### 3.5 Netty\n\n#### BootstrapServerBootstrap\n\n1. `Bootstrap`  `Netty`  `Bootstrap`  `Netty` `Netty`  `Bootstrap` `ServerBootstrap` \n2. \n    - `public ServerBootstrap group(EventLoopGroup parentGroup, EventLoopGroup childGroup)` `EventLoop`\n    - `public B group(EventLoopGroup group)` `EventLoop`\n    - `public B channel(Class<? extends C> channelClass)`\n    - `public <T> B option(ChannelOption<T> option, T value)` `ServerChannel` \n    - `public <T> ServerBootstrap childOption(ChannelOption<T> childOption, T value)`\n    - `public ServerBootstrap childHandler(ChannelHandler childHandler)``handler`\n    - `public ChannelFuture bind(int inetPort)`\n    - `public ChannelFuture connect(String inetHost, int inetPort)`\n\n####  FutureChannelFuture\n\n`Netty`  `IO`  `Future`  `ChannelFutures`\n\n\n\n- `Channel channel()` `IO` \n- `ChannelFuture sync()`\n\n#### Channel\n\n1. `Netty`  `I/O` \n2.  `Channel` \n3.  `Channel` \n4. `Channel`  `I/O` () `I/O`  `I/O` \n5.  `ChannelFuture`  `ChannelFuture`  `I/O` \n6.  `I/O` \n7.  `Channel`  `Channel` \n    - `NioSocketChannel` `TCP` `Socket` \n    - `NioServerSocketChannel` `TCP` `Socket` \n    - `NioDatagramChannel` `UDP` \n    - `NioSctpChannel` `Sctp` \n    - `NioSctpServerChannel` `Sctp`  `UDP`  `TCP`  `IO`  `IO`\n\n#### Selector\n\n1. `Netty`  `Selector`  `I/O`  `Selector`  `Channel` \n2.  `Selector`  `Channel` `Selector` `Select` `Channel`  `I/O`  `Channel`\n\n#### ChannelHandler \n\n1. `ChannelHandler`  `I/O`  `I/O`  `ChannelPipeline`\n2. `ChannelHandler` \n\n#### Pipeline  ChannelPipeline\n\n1. `ChannelPipeline`  `Handler`  `inbound`  `outbound`  `Netty` `ChannelPipeline`  `ChannelHandler`  `List` `Channel` \n2. `ChannelPipeline`  `Channel`  `ChannelHandler` \n3.  `Netty`  `Channel`  `ChannelPipeline` \n\n![](https://i.loli.net/2021/10/18/oZARqLONHzbaGiP.png)\n\n\t![](https://i.loli.net/2021/10/18/KeR8OM6uTVqhjFZ.png)\n\n4. \n    `ChannelPipeline addFirst(ChannelHandler... handlers)``handler``ChannelPipeline addLast(ChannelHandler... handlers)``handler`\n\n#### ChannelHandlerContext\n\n1.  `Channel`  `ChannelHandler` \n2.  `ChannelHandlerContext`  `ChannelHandler` `ChannelHandlerContext`  `pipeline`  `Channel`  `ChannelHandler` \n3. \n    - `ChannelFuture close()`\n    - `ChannelOutboundInvoker flush()`\n    - `ChannelFuture writeAndFlush(Object msg)` \n    - `ChannelPipeline`  `ChannelHandler`  `ChannelHandler` \n\n![](https://i.loli.net/2021/10/18/qRSk7ezATLQtKV5.png)\n\n#### ChannelOption\n\n1. `Netty`  `Channel`  `ChannelOption` \n2. `ChannelOption` \n\n![](https://i.loli.net/2021/10/18/Z6pAFyCjhOU5dvg.png)\n\n#### EventLoopGroup\n\n1. `EventLoopGroup`  `EventLoop` `Netty`  `CPU`  `EventLoop`  `EventLoop`  `Selector` \n2. `EventLoopGroup`  `next`  `EventLoop`  `Netty`  `EventLoopGroup``BossEventLoopGroup`  `WorkerEventLoopGroup`\n3.  `ServerSocketChannel`  `Selector`  `EventLoop` `BossEventLoop`  `SocketChannel`  `WorkerEventLoopGroup`  `IO` \n\n![](https://i.loli.net/2021/10/18/zoQgpkliDMshRN1.png)\n\n4. \n    `public NioEventLoopGroup()`\n    `public Future<?> shutdownGracefully()`\n\n#### Unpooled \n\n1. `Netty`  `Netty` \n2. \n\n![](https://i.loli.net/2021/10/18/yQbHkAGRs7fqYX2.png)\n\n3.  `Unpooled`  `Netty`  `ByteBuf` \n\n![](https://i.loli.net/2021/10/18/CpM4xhrFYE1IdVB.png)","source":"_posts/bio-nio-netty.md","raw":"---\ntitle: BIO NIONetty\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - IO\n  - netty\ncategories:\n  - work\nabbrlink: 5dae\ndate: 2021-8-25 00:00:00\nsubtitle:\n---\n# BIONIONetty\n\n\n\n> ### \n>\n> \t\tClient/ServerIPSocket\n>\n> ### BIO:\n>\n> \t\t1.4Java IOIOBlocking IOBIO\n>\n> ### NIO:\n>\n> \t\tIOJavaIOJAVA NIONon-Blocking IOJava NIO IO\n>\n> ### Netty:\n>\n> \t\tNetty[](https://baike.baidu.com/item//9597519)NIONetty [](https://baike.baidu.com/item//6492316)\n\n\n\n## 1. Java BIO\n\n### 1.1 Java BIO\n\n- IO\n\n    ![bio-model](https://i.loli.net/2021/10/18/6jJxcVENwszR8Wd.png)\n\n### 1.2 Java BIO \n\n1.  `ServerSocket`\n2.  `Socket` \n3. \n\n### 1.3 Java BIO([github](https://github.com/VickyLuoLuo/netty.git))\n\n- BIO\n\n```java\nimport java.io.IOException;\nimport java.net.ServerSocket;\nimport java.net.Socket;\n\npublic class BioServer {\n\n    public static void main(String[] args) throws IOException {\n        // ServerSocket\n        ServerSocket serverSocket = new ServerSocket(9090);\n        System.out.println(\"\");\n        while (true) {\n            //\n            System.out.println(\"....\");\n            final Socket socket = serverSocket.accept(); // \n            System.out.println(\"\");\n            byte[] bytes = new byte[1024];\n            socket.getInputStream().read(bytes); // \n            System.out.println(\"\" + new String(bytes));\n        }\n    }\n}\n```\n\n- `socket.getInputStream().read(bytes)`\n\n```java\nimport java.io.IOException;\nimport java.io.InputStream;\nimport java.net.ServerSocket;\nimport java.net.Socket;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\n\npublic class BioServer {\n\n    public static void main(String[] args) throws IOException {\n        // ServerSocket\n        ServerSocket serverSocket = new ServerSocket(9090);\n        System.out.println(\"\");\n        // ,: 1.  2. ()\n        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();\n        while (true) {\n            //\n            System.out.println(\"....\");\n            final Socket socket = serverSocket.accept(); // \n            System.out.println(\"\");\n            newCachedThreadPool.execute(() -> {\n                // \n                handler(socket);\n            });\n        }\n    }\n\n    public static void handler(Socket socket) {\n        try {\n            byte[] bytes = new byte[1024];\n            //socket\n            InputStream inputStream = socket.getInputStream();\n            //\n            while (true) {\n                System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\");\n                int read = inputStream.read(bytes); // \n                if (read != -1) {\n                    System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\" + new String(bytes, 0, read));\n                } else {\n                    break;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        } finally {\n            System.out.println(\"handlerid = \" + Thread.currentThread().getId() + \"\"); \n            try {\n                socket.close();\n            } catch (Exception e) {\n                e.printStackTrace();\n            }\n        }\n    }\n}\n```\n\n\t\t`inputStream.read(bytes)`\n\n## 2. Java NIO\n\n### 2.1 Java NIO\n\n- IO `I/O` \n\n    ![nio-model](https://i.loli.net/2021/10/18/ABy7qJoGhwaSzip.png)\n\n### 2.2 Java NIO\n\n1. ####  Channel\n\n    BIOInput StreamOutput StreamNIONIOIOBIO\n\n2. ####  Selector\n\n    > IO//\n\n    IOselectIO/\n\n3. #### Buffer\n\n    Channelreadwrite\n\n### 2.3 SelectorChannel  Buffer \n\n1.  `Channel`  `Buffer`\n2. `Selector`  `Channel`\n3. `Selector` \n4. `Buffer` \n5.  `Buffer``BIO`  `NIO`  `Buffer`  `flip`  `Channel`  `Linux`\n\n![nio-element](https://i.loli.net/2021/10/18/4F5pSqTYbayDgsJ.png)\n\n### 2.4 Java NIO \n\n1.  `ServerSocketChannel`---BIOServerSocket\n\n2.  `SocketChannel`---BIOSocket\n\n3. `Selector``ServerSocketChannel``Selector` `SelectionKey` `Selector`  `Selector`  `SocketChannel`\n\n4.  `ServerSocketChannel` `SocketChannel`\n\n5. `Selector`  `select` \n\n6.  `socketChannel`  `Selector`  `SelectionKey`\n\n7.  `SelectionKey`  `SocketChannel`\n\n8.  `channel`\n\n    ![nio-workflow](https://i.loli.net/2021/10/18/ybcGt7zRT459L8Z.png)\n\n### 2.4 Java NIO ([github](https://github.com/VickyLuoLuo/netty.git))\n\n- NIO`List<SocketChannel>``SocketChannel`IO\n\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.ServerSocketChannel;\nimport java.nio.channels.SocketChannel;\nimport java.util.ArrayList;\nimport java.util.Iterator;\nimport java.util.List;\n\npublic class NioServer {\n\n    static List<SocketChannel> channelList = new ArrayList<>();\n\n    public static void startServer() throws IOException {\n\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5252));\n        System.out.println(\"\");\n\n        // IO\n        while (true) {\n\n            // \n            SocketChannel socketChannel = serverSocketChannel.accept(); // \n            if (null != socketChannel) {\n                System.out.println(\"\");\n                // SocketChannelNIOaccept\n                socketChannel.configureBlocking(false);\n\n                channelList.add(socketChannel);\n            }\n            // \n            Iterator<SocketChannel> channels = channelList.iterator();\n            while (channels.hasNext()) {\n                // \n                SocketChannel channel = channels.next();\n                ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                // read\n                int length = channel.read(byteBuffer); // \n                if (length > 0) {\n                    System.out.println(\"\" + new String(byteBuffer.array(), 0, length));\n                } else if (length == -1) {\n                    channels.remove();\n                    System.out.println(\"\");\n                }\n\n            }\n        }\n    }\n\n    public static void main(String[] args) throws IOException {\n        startServer();\n    }\n}\n```\n\n- `serverSocketChannel.accept()``channel.read(byteBuffer)``while(true)``Selector``selector.select()`\n\n```java\nimport java.io.IOException;\nimport java.net.InetSocketAddress;\nimport java.nio.ByteBuffer;\nimport java.nio.channels.SelectionKey;\nimport java.nio.channels.Selector;\nimport java.nio.channels.ServerSocketChannel;\nimport java.nio.channels.SocketChannel;\nimport java.util.Iterator;\n\npublic class NioSelectorServer {\n    public static void startServer() throws IOException {\n\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5656));\n        System.out.println(\"\");\n\n        // \n        Selector selector = Selector.open(); // epoll\n        // IO\n        SelectionKey selectionKey = serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        // IO\n        while (selector.select() > 0) { //  epoll-wait\n            // \n            Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n            while (selectedKeys.hasNext()) {\n                // \n                SelectionKey selectedKey = selectedKeys.next();\n                if (selectedKey.isAcceptable()) {\n                    // IO\n                    SocketChannel socketChannel = serverSocketChannel.accept();\n                    // \n                    socketChannel.configureBlocking(false);\n                    // \n                    socketChannel.register(selector, SelectionKey.OP_READ);\n                    System.out.println(\"\");\n                } else if (selectedKey.isReadable()) {\n                    // IO\n                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();\n                    // \n                    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                    // read\n                    int length = socketChannel.read(byteBuffer);\n                    if (length > 0) {\n                        System.out.println(\"\" + new String(byteBuffer.array(), 0, length));\n                    } else if (length == -1) {\n                        System.out.println(\"\");\n                        socketChannel.close();\n                    }\n                }\n                // \n                selectedKeys.remove();\n            }\n        }\n        // \n        serverSocketChannel.close();\n    }\n\n    public static void main(String[] args) throws IOException {\n        startServer();\n    }\n}\n```\n\n### 2.5 `Selector`\n\n\t`Selector`IO`epoll`(Linux)`epoll`\n\n1. epoll_create\n\n    epollchannel \n\n2. epoll_ctl\n\n    //channel\n\n3. epoll_wait\n\n    IO channel\n\n### 2.6 Java NIO \n\n\t\t[Java NIO](https://vickyluoluo.github.io/2021/03/31/57bd.html)\n\n## 3. Netty\n\n### 3.1 NIO\n\n1. `NIO`  `API`  `Selector``ServerSocketChannel``SocketChannel``ByteBuffer`\n2.  `Java`  `NIO`  `Reactor`  `NIO` \n3. \n4.  `JDK NIO`  `Bug` `Epoll Bug` `Selector`  `CPU100%` `JDK1.7` \n\n### 3.2 Netty \n\n`Netty`  `JDK`  `NIO`  `API` \n\n1.  `API`  `Socket`-\n2.  `Javadoc``JDK5Netty3.x` `6Netty4.x`\n3. \n4.  `SSL/TLS`  `StartTLS` \n5.  `Bug` \n\n### 3.3 Netty\n\n![](https://i.loli.net/2021/10/18/3cnCUJG4yerixqK.png)\n\n`Netty`  `Reactors` `BossGroup`  `Selector` `Accecpt`  `Accept`  `SocketChannel` `NIOScoketChannel`  `Worker`  `Worker`  `Selector`  `handler`\n\n![](https://i.loli.net/2021/10/18/chLyW8ko5aRuPqN.png)\n\n\n\n1. `Netty`  `BossGroup` `WorkerGroup` \n2. `BossGroup`  `WorkerGroup`  `NioEventLoopGroup` \n3. `NioEventLoopGroup`  `NioEventLoop` \n4. `NioEventLoop`  `NioEventLoop`  `Selector` `socket` \n5. `NioEventLoopGroup`  `NioEventLoop` \n6.  `BossNioEventLoop`  `3` \n    -  `accept` \n    -  `accept`  `client`  `NioScocketChannel` `worker` `NIOEventLoop`  `Selector`\n    -  `runAllTasks`\n7.  `Worker` `NIOEventLoop` \n    -  `read``write` \n    -  `I/O`  `read``write`  `NioScocketChannel` \n    -  `runAllTasks`\n8.  `Worker` `NIOEventLoop`  `pipeline``pipeline`  `channel` `pipeline` \n\n### 3.4 Netty ([github](https://github.com/VickyLuoLuo/netty.git))\n\n- Netty\n    1. `NettyServer.java` \n\n```java\nimport io.netty.bootstrap.ServerBootstrap;\nimport io.netty.channel.*;\nimport io.netty.channel.nio.NioEventLoopGroup;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.channel.socket.nio.NioServerSocketChannel;\n\npublic class NettyServer {\n\n    public static void main(String[] args) throws Exception {\n\n        //bossGroupworkerGroupcpu * 2bossGroup,workerGroup\n        EventLoopGroup bossGroup = new NioEventLoopGroup(1);\n        EventLoopGroup workerGroup = new NioEventLoopGroup(8);\n\n        try {\n            //\n            ServerBootstrap bootstrap = new ServerBootstrap();\n            //\n            bootstrap.group(bossGroup, workerGroup) //\n                    .channel(NioServerSocketChannel.class) //NioSocketChannel \n                    .option(ChannelOption.SO_BACKLOG, 128) // \n                    .childHandler(new ChannelInitializer<SocketChannel>() {//()\n                        //workGroupSocketChannel\n                        @Override\n                        protected void initChannel(SocketChannel ch) {\n                            System.out.println(\"socketchannel hashcode=\" + ch.hashCode()); // SocketChannel channel  NIOEventLoop  taskQueue  scheduleTaskQueue\n                            ch.pipeline().addLast(new NettyServerHandler()); // \n                        }\n                    });\n\n            System.out.println(\"..... is ready...\");\n\n            //bindisDone()\n            ChannelFuture cf = bootstrap.bind(6668).sync();\n\n            //cf \n            cf.addListener((ChannelFutureListener) future -> {\n                if (cf.isSuccess()) {\n                    System.out.println(\"\");\n                } else {\n                    System.out.println(\"\");\n                }\n            });\n\n            //\n            cf.channel().closeFuture().sync();\n        } finally {\n            bossGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n}\n```\n\n\t\t\t2. `NettyServerHandler.java ``ChannelHandler`\n\n```java\nimport io.netty.buffer.ByteBuf;\nimport io.netty.buffer.Unpooled;\nimport io.netty.channel.*;\nimport io.netty.util.CharsetUtil;\n\npublic class NettyServerHandler extends ChannelInboundHandlerAdapter {\n\n    /**\n     * \n     * @param ctx: ,  pipeline , channel, \n     */\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) {\n        System.out.println(\"\");\n    }\n\n    /**\n     * ()\n     * @param ctx:,  pipeline , channel, \n     * @param msg:  Object\n     */\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n\n        Channel channel = ctx.channel();\n        // msg  ByteBuf,ByteBuf  Netty  NIO  ByteBuffer.\n        ByteBuf buf = (ByteBuf) msg;\n        System.out.println(\":\" + buf.toString(CharsetUtil.UTF_8));\n        System.out.println(\":\" + channel.remoteAddress());\n    }\n\n    /**\n     *  \n     */\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) {\n        //\n        ctx.writeAndFlush(Unpooled.copiedBuffer(\"hello, \", CharsetUtil.UTF_8));\n    }\n\n    /**\n     * , \n     * @param ctx\n     * @param cause\n     */\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) {\n        ctx.close();\n    }\n}\n\n```\n\n- `SpringBoot` + `Netty`([github](https://github.com/VickyLuoLuo/netty.git))\n\n```java\nimport io.netty.channel.ChannelInitializer;\nimport io.netty.channel.ChannelPipeline;\nimport io.netty.channel.socket.SocketChannel;\nimport io.netty.handler.codec.http.HttpObjectAggregator;\nimport io.netty.handler.codec.http.HttpServerCodec;\nimport io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler;\nimport io.netty.handler.stream.ChunkedWriteHandler;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Qualifier(\"somethingChannelInitializer\")\npublic class NettyWebSocketChannelInitializer extends ChannelInitializer<SocketChannel> {\n\n    @Autowired\n    private TextWebSocketFrameHandler textWebSocketFrameHandler;\n\n    @Override\n    public void initChannel(SocketChannel ch) throws Exception {//2\n        ChannelPipeline pipeline = ch.pipeline();\n\n        pipeline.addLast(new HttpServerCodec()); // http\n        pipeline.addLast(new HttpObjectAggregator(64*1024)); // http\n        pipeline.addLast(new ChunkedWriteHandler()); // \n        pipeline.addLast(new WebSocketServerProtocolHandler(\"/ws\")); //\n        pipeline.addLast(textWebSocketFrameHandler); // ChannelHandler\n\n    }\n}\n```\n\n```java\nimport com.lhl.netty.chat.util.RandomName;\nimport com.lhl.netty.chat.util.RedisDao;\nimport io.netty.channel.Channel;\nimport io.netty.channel.ChannelHandler;\nimport io.netty.channel.ChannelHandlerContext;\nimport io.netty.channel.SimpleChannelInboundHandler;\nimport io.netty.channel.group.ChannelGroup;\nimport io.netty.channel.group.DefaultChannelGroup;\nimport io.netty.handler.codec.http.websocketx.TextWebSocketFrame;\nimport io.netty.util.concurrent.GlobalEventExecutor;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Qualifier;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Qualifier(\"textWebSocketFrameHandler\")\n@ChannelHandler.Sharable\npublic class TextWebSocketFrameHandler extends SimpleChannelInboundHandler<TextWebSocketFrame> {\n\n    public static ChannelGroup channels = new DefaultChannelGroup(GlobalEventExecutor.INSTANCE);\n\n    @Autowired\n    private RedisDao redisDao;\n\n    @Override\n    protected void channelRead0(ChannelHandlerContext ctx,\n                                TextWebSocketFrame msg) throws Exception {\n        Channel incoming = ctx.channel();\n        String uName = redisDao.getString(incoming.id()+\"\");\n        for (Channel channel : channels) {\n            if (channel != incoming){\n                channel.writeAndFlush(new TextWebSocketFrame(\"[\" + uName + \"]\" + msg.text()));\n            } else {\n                channel.writeAndFlush(new TextWebSocketFrame(\"[]\" + msg.text() ));\n            }\n        }\n    }\n\n    @Override\n    public void handlerAdded(ChannelHandlerContext ctx) throws Exception {\n        System.out.println(ctx.channel().remoteAddress());\n        String uName = new RandomName().getRandomName();\n\n        Channel incoming = ctx.channel();\n        for (Channel channel : channels) {\n            channel.writeAndFlush(new TextWebSocketFrame(\"[] - \" + uName + \" \"));\n        }\n        redisDao.saveString(incoming.id()+\"\",uName);\n        channels.add(ctx.channel());\n    }\n\n    @Override\n    public void handlerRemoved(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        String uName = redisDao.getString(String.valueOf(incoming.id()));\n        for (Channel channel : channels) {\n            channel.writeAndFlush(new TextWebSocketFrame(\"[] - \" + uName + \" \"));\n        }\n        redisDao.deleteString(String.valueOf(incoming.id()));\n\n        channels.remove(ctx.channel());\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n    }\n\n\n    @Override\n    public void channelInactive(ChannelHandlerContext ctx) throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause)\n            throws Exception {\n        Channel incoming = ctx.channel();\n        System.out.println(\":\"+redisDao.getString(incoming.id()+\"\")+\"\");\n        cause.printStackTrace();\n        ctx.close();\n    }\n\n}\n```\n\n### 3.5 Netty\n\n#### BootstrapServerBootstrap\n\n1. `Bootstrap`  `Netty`  `Bootstrap`  `Netty` `Netty`  `Bootstrap` `ServerBootstrap` \n2. \n    - `public ServerBootstrap group(EventLoopGroup parentGroup, EventLoopGroup childGroup)` `EventLoop`\n    - `public B group(EventLoopGroup group)` `EventLoop`\n    - `public B channel(Class<? extends C> channelClass)`\n    - `public <T> B option(ChannelOption<T> option, T value)` `ServerChannel` \n    - `public <T> ServerBootstrap childOption(ChannelOption<T> childOption, T value)`\n    - `public ServerBootstrap childHandler(ChannelHandler childHandler)``handler`\n    - `public ChannelFuture bind(int inetPort)`\n    - `public ChannelFuture connect(String inetHost, int inetPort)`\n\n####  FutureChannelFuture\n\n`Netty`  `IO`  `Future`  `ChannelFutures`\n\n\n\n- `Channel channel()` `IO` \n- `ChannelFuture sync()`\n\n#### Channel\n\n1. `Netty`  `I/O` \n2.  `Channel` \n3.  `Channel` \n4. `Channel`  `I/O` () `I/O`  `I/O` \n5.  `ChannelFuture`  `ChannelFuture`  `I/O` \n6.  `I/O` \n7.  `Channel`  `Channel` \n    - `NioSocketChannel` `TCP` `Socket` \n    - `NioServerSocketChannel` `TCP` `Socket` \n    - `NioDatagramChannel` `UDP` \n    - `NioSctpChannel` `Sctp` \n    - `NioSctpServerChannel` `Sctp`  `UDP`  `TCP`  `IO`  `IO`\n\n#### Selector\n\n1. `Netty`  `Selector`  `I/O`  `Selector`  `Channel` \n2.  `Selector`  `Channel` `Selector` `Select` `Channel`  `I/O`  `Channel`\n\n#### ChannelHandler \n\n1. `ChannelHandler`  `I/O`  `I/O`  `ChannelPipeline`\n2. `ChannelHandler` \n\n#### Pipeline  ChannelPipeline\n\n1. `ChannelPipeline`  `Handler`  `inbound`  `outbound`  `Netty` `ChannelPipeline`  `ChannelHandler`  `List` `Channel` \n2. `ChannelPipeline`  `Channel`  `ChannelHandler` \n3.  `Netty`  `Channel`  `ChannelPipeline` \n\n![](https://i.loli.net/2021/10/18/oZARqLONHzbaGiP.png)\n\n\t![](https://i.loli.net/2021/10/18/KeR8OM6uTVqhjFZ.png)\n\n4. \n    `ChannelPipeline addFirst(ChannelHandler... handlers)``handler``ChannelPipeline addLast(ChannelHandler... handlers)``handler`\n\n#### ChannelHandlerContext\n\n1.  `Channel`  `ChannelHandler` \n2.  `ChannelHandlerContext`  `ChannelHandler` `ChannelHandlerContext`  `pipeline`  `Channel`  `ChannelHandler` \n3. \n    - `ChannelFuture close()`\n    - `ChannelOutboundInvoker flush()`\n    - `ChannelFuture writeAndFlush(Object msg)` \n    - `ChannelPipeline`  `ChannelHandler`  `ChannelHandler` \n\n![](https://i.loli.net/2021/10/18/qRSk7ezATLQtKV5.png)\n\n#### ChannelOption\n\n1. `Netty`  `Channel`  `ChannelOption` \n2. `ChannelOption` \n\n![](https://i.loli.net/2021/10/18/Z6pAFyCjhOU5dvg.png)\n\n#### EventLoopGroup\n\n1. `EventLoopGroup`  `EventLoop` `Netty`  `CPU`  `EventLoop`  `EventLoop`  `Selector` \n2. `EventLoopGroup`  `next`  `EventLoop`  `Netty`  `EventLoopGroup``BossEventLoopGroup`  `WorkerEventLoopGroup`\n3.  `ServerSocketChannel`  `Selector`  `EventLoop` `BossEventLoop`  `SocketChannel`  `WorkerEventLoopGroup`  `IO` \n\n![](https://i.loli.net/2021/10/18/zoQgpkliDMshRN1.png)\n\n4. \n    `public NioEventLoopGroup()`\n    `public Future<?> shutdownGracefully()`\n\n#### Unpooled \n\n1. `Netty`  `Netty` \n2. \n\n![](https://i.loli.net/2021/10/18/yQbHkAGRs7fqYX2.png)\n\n3.  `Unpooled`  `Netty`  `ByteBuf` \n\n![](https://i.loli.net/2021/10/18/CpM4xhrFYE1IdVB.png)","slug":"bio-nio-netty","published":1,"updated":"2022-04-23T08:56:59.737Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweec0007kh6z17ig31vz","content":"<h1 id=\"BIONIONetty\"><a href=\"#BIONIONetty\" class=\"headerlink\" title=\"BIONIONetty\"></a>BIONIONetty</h1><blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>        Client/ServerIPSocket</p>\n<h3 id=\"BIO\"><a href=\"#BIO\" class=\"headerlink\" title=\"BIO:\"></a>BIO:</h3><p>        1.4Java IOIOBlocking IOBIO</p>\n<h3 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO:\"></a>NIO:</h3><p>        IOJavaIOJAVA NIONon-Blocking IOJava NIO IO</p>\n<h3 id=\"Netty\"><a href=\"#Netty\" class=\"headerlink\" title=\"Netty:\"></a>Netty:</h3><p>        Netty<a href=\"https://baike.baidu.com/item//9597519\" target=\"_blank\" rel=\"noopener\"></a>NIONetty <a href=\"https://baike.baidu.com/item//6492316\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<h2 id=\"1-Java-BIO\"><a href=\"#1-Java-BIO\" class=\"headerlink\" title=\"1. Java BIO\"></a>1. Java BIO</h2><h3 id=\"1-1-Java-BIO\"><a href=\"#1-1-Java-BIO\" class=\"headerlink\" title=\"1.1 Java BIO\"></a>1.1 Java BIO</h3><ul>\n<li><p>IO</p>\n<p>  <img src=\"https://i.loli.net/2021/10/18/6jJxcVENwszR8Wd.png\" alt=\"bio-model\"></p>\n</li>\n</ul>\n<h3 id=\"1-2-Java-BIO-\"><a href=\"#1-2-Java-BIO-\" class=\"headerlink\" title=\"1.2 Java BIO \"></a>1.2 Java BIO </h3><ol>\n<li> <code>ServerSocket</code></li>\n<li> <code>Socket</code> </li>\n<li></li>\n</ol>\n<h3 id=\"1-3-Java-BIO-github\"><a href=\"#1-3-Java-BIO-github\" class=\"headerlink\" title=\"1.3 Java BIO(github)\"></a>1.3 Java BIO(<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>BIO</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ServerSocket</span></span><br><span class=\"line\">        ServerSocket serverSocket = <span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9090</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"....\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Socket socket = serverSocket.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            socket.getInputStream().read(bytes); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(bytes));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>socket.getInputStream().read(bytes)</code></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ServerSocket</span></span><br><span class=\"line\">        ServerSocket serverSocket = <span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9090</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// ,: 1.  2. ()</span></span><br><span class=\"line\">        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"....\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Socket socket = serverSocket.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            newCachedThreadPool.execute(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                handler(socket);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">handler</span><span class=\"params\">(Socket socket)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            <span class=\"comment\">//socket</span></span><br><span class=\"line\">            InputStream inputStream = socket.getInputStream();</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">int</span> read = inputStream.read(bytes); <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (read != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(bytes, <span class=\"number\">0</span>, read));</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span>); </span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                socket.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>        <code>inputStream.read(bytes)</code></p>\n<h2 id=\"2-Java-NIO\"><a href=\"#2-Java-NIO\" class=\"headerlink\" title=\"2. Java NIO\"></a>2. Java NIO</h2><h3 id=\"2-1-Java-NIO\"><a href=\"#2-1-Java-NIO\" class=\"headerlink\" title=\"2.1 Java NIO\"></a>2.1 Java NIO</h3><ul>\n<li><p>IO <code>I/O</code> </p>\n<p>  <img src=\"https://i.loli.net/2021/10/18/ABy7qJoGhwaSzip.png\" alt=\"nio-model\"></p>\n</li>\n</ul>\n<h3 id=\"2-2-Java-NIO\"><a href=\"#2-2-Java-NIO\" class=\"headerlink\" title=\"2.2 Java NIO\"></a>2.2 Java NIO</h3><ol>\n<li><h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><p> BIOInput StreamOutput StreamNIONIOIOBIO</p>\n</li>\n<li><h4 id=\"Selector\"><a href=\"#Selector\" class=\"headerlink\" title=\"Selector\"></a>Selector</h4><blockquote>\n<p>IO//</p>\n</blockquote>\n<p> IOselectIO/</p>\n</li>\n<li><h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p> Channelreadwrite</p>\n</li>\n</ol>\n<h3 id=\"2-3-SelectorChannel--Buffer-\"><a href=\"#2-3-SelectorChannel--Buffer-\" class=\"headerlink\" title=\"2.3 SelectorChannel  Buffer \"></a>2.3 SelectorChannel  Buffer </h3><ol>\n<li> <code>Channel</code>  <code>Buffer</code></li>\n<li><code>Selector</code>  <code>Channel</code></li>\n<li><code>Selector</code> </li>\n<li><code>Buffer</code> </li>\n<li> <code>Buffer</code><code>BIO</code>  <code>NIO</code>  <code>Buffer</code>  <code>flip</code>  <code>Channel</code>  <code>Linux</code></li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/4F5pSqTYbayDgsJ.png\" alt=\"nio-element\"></p>\n<h3 id=\"2-4-Java-NIO-\"><a href=\"#2-4-Java-NIO-\" class=\"headerlink\" title=\"2.4 Java NIO \"></a>2.4 Java NIO </h3><ol>\n<li><p> <code>ServerSocketChannel</code>BIOServerSocket</p>\n</li>\n<li><p> <code>SocketChannel</code>BIOSocket</p>\n</li>\n<li><p><code>Selector</code><code>ServerSocketChannel</code><code>Selector</code> <code>SelectionKey</code> <code>Selector</code>  <code>Selector</code>  <code>SocketChannel</code></p>\n</li>\n<li><p> <code>ServerSocketChannel</code> <code>SocketChannel</code></p>\n</li>\n<li><p><code>Selector</code>  <code>select</code> </p>\n</li>\n<li><p> <code>socketChannel</code>  <code>Selector</code>  <code>SelectionKey</code></p>\n</li>\n<li><p> <code>SelectionKey</code>  <code>SocketChannel</code></p>\n</li>\n<li><p> <code>channel</code></p>\n<p> <img src=\"https://i.loli.net/2021/10/18/ybcGt7zRT459L8Z.png\" alt=\"nio-workflow\"></p>\n</li>\n</ol>\n<h3 id=\"2-4-Java-NIO--github\"><a href=\"#2-4-Java-NIO--github\" class=\"headerlink\" title=\"2.4 Java NIO (github)\"></a>2.4 Java NIO (<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>NIO<code>List&lt;SocketChannel&gt;</code><code>SocketChannel</code>IO</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.ByteBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.ServerSocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> List&lt;SocketChannel&gt; channelList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            SocketChannel socketChannel = serverSocketChannel.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != socketChannel) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                <span class=\"comment\">// SocketChannelNIOaccept</span></span><br><span class=\"line\">                socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                channelList.add(socketChannel);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SocketChannel&gt; channels = channelList.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (channels.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SocketChannel channel = channels.next();</span><br><span class=\"line\">                ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                <span class=\"comment\">// read</span></span><br><span class=\"line\">                <span class=\"keyword\">int</span> length = channel.read(byteBuffer); <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (length &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (length == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    channels.remove();</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        startServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>serverSocketChannel.accept()</code><code>channel.read(byteBuffer)</code><code>while(true)</code><code>Selector</code><code>selector.select()</code></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.ByteBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SelectionKey;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.Selector;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.ServerSocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioSelectorServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5656</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Selector selector = Selector.open(); <span class=\"comment\">// epoll</span></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        SelectionKey selectionKey = serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">//  epoll-wait</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.register(selector, SelectionKey.OP_READ);</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// read</span></span><br><span class=\"line\">                    <span class=\"keyword\">int</span> length = socketChannel.read(byteBuffer);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (length &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (length == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                        socketChannel.close();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                selectedKeys.remove();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        startServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-5-Selector\"><a href=\"#2-5-Selector\" class=\"headerlink\" title=\"2.5 Selector\"></a>2.5 <code>Selector</code></h3><p>    <code>Selector</code>IO<code>epoll</code>(Linux)<code>epoll</code></p>\n<ol>\n<li><p>epoll_create</p>\n<p> epollchannel </p>\n</li>\n<li><p>epoll_ctl</p>\n<p> //channel</p>\n</li>\n<li><p>epoll_wait</p>\n<p> IO channel</p>\n</li>\n</ol>\n<h3 id=\"2-6-Java-NIO-\"><a href=\"#2-6-Java-NIO-\" class=\"headerlink\" title=\"2.6 Java NIO \"></a>2.6 Java NIO </h3><p>        <a href=\"https://vickyluoluo.github.io/2021/03/31/57bd.html\">Java NIO</a></p>\n<h2 id=\"3-Netty\"><a href=\"#3-Netty\" class=\"headerlink\" title=\"3. Netty\"></a>3. Netty</h2><h3 id=\"3-1-NIO\"><a href=\"#3-1-NIO\" class=\"headerlink\" title=\"3.1 NIO\"></a>3.1 NIO</h3><ol>\n<li><code>NIO</code>  <code>API</code>  <code>Selector</code><code>ServerSocketChannel</code><code>SocketChannel</code><code>ByteBuffer</code></li>\n<li> <code>Java</code>  <code>NIO</code>  <code>Reactor</code>  <code>NIO</code> </li>\n<li></li>\n<li><code>JDK NIO</code>  <code>Bug</code> <code>Epoll Bug</code> <code>Selector</code>  <code>CPU100%</code> <code>JDK1.7</code> </li>\n</ol>\n<h3 id=\"3-2-Netty-\"><a href=\"#3-2-Netty-\" class=\"headerlink\" title=\"3.2 Netty \"></a>3.2 Netty </h3><p><code>Netty</code>  <code>JDK</code>  <code>NIO</code>  <code>API</code> </p>\n<ol>\n<li> <code>API</code>  <code>Socket</code>-</li>\n<li> <code>Javadoc</code><code>JDK5Netty3.x</code> <code>6Netty4.x</code></li>\n<li></li>\n<li> <code>SSL/TLS</code>  <code>StartTLS</code> </li>\n<li> <code>Bug</code> </li>\n</ol>\n<h3 id=\"3-3-Netty\"><a href=\"#3-3-Netty\" class=\"headerlink\" title=\"3.3 Netty\"></a>3.3 Netty</h3><p><img src=\"https://i.loli.net/2021/10/18/3cnCUJG4yerixqK.png\" alt=\"\"></p>\n<p><code>Netty</code>  <code>Reactors</code> <code>BossGroup</code>  <code>Selector</code> <code>Accecpt</code>  <code>Accept</code>  <code>SocketChannel</code> <code>NIOScoketChannel</code>  <code>Worker</code>  <code>Worker</code>  <code>Selector</code>  <code>handler</code></p>\n<p><img src=\"https://i.loli.net/2021/10/18/chLyW8ko5aRuPqN.png\" alt=\"\"></p>\n<p></p>\n<ol>\n<li><code>Netty</code>  <code>BossGroup</code> <code>WorkerGroup</code> </li>\n<li><code>BossGroup</code>  <code>WorkerGroup</code>  <code>NioEventLoopGroup</code> </li>\n<li><code>NioEventLoopGroup</code>  <code>NioEventLoop</code> </li>\n<li><code>NioEventLoop</code>  <code>NioEventLoop</code>  <code>Selector</code> <code>socket</code> </li>\n<li><code>NioEventLoopGroup</code>  <code>NioEventLoop</code> </li>\n<li> <code>BossNioEventLoop</code>  <code>3</code> <ul>\n<li> <code>accept</code> </li>\n<li> <code>accept</code>  <code>client</code>  <code>NioScocketChannel</code> <code>worker</code> <code>NIOEventLoop</code>  <code>Selector</code></li>\n<li> <code>runAllTasks</code></li>\n</ul>\n</li>\n<li> <code>Worker</code> <code>NIOEventLoop</code> <ul>\n<li> <code>read</code><code>write</code> </li>\n<li> <code>I/O</code>  <code>read</code><code>write</code>  <code>NioScocketChannel</code> </li>\n<li> <code>runAllTasks</code></li>\n</ul>\n</li>\n<li> <code>Worker</code> <code>NIOEventLoop</code>  <code>pipeline</code><code>pipeline</code>  <code>channel</code> <code>pipeline</code> </li>\n</ol>\n<h3 id=\"3-4-Netty--github\"><a href=\"#3-4-Netty--github\" class=\"headerlink\" title=\"3.4 Netty (github)\"></a>3.4 Netty (<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>Netty<ol>\n<li><code>NettyServer.java</code> </li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.bootstrap.ServerBootstrap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//bossGroupworkerGroupcpu * 2bossGroup,workerGroup</span></span><br><span class=\"line\">        EventLoopGroup bossGroup = <span class=\"keyword\">new</span> NioEventLoopGroup(<span class=\"number\">1</span>);</span><br><span class=\"line\">        EventLoopGroup workerGroup = <span class=\"keyword\">new</span> NioEventLoopGroup(<span class=\"number\">8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            ServerBootstrap bootstrap = <span class=\"keyword\">new</span> ServerBootstrap();</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            bootstrap.group(bossGroup, workerGroup) <span class=\"comment\">//</span></span><br><span class=\"line\">                    .channel(NioServerSocketChannel<span class=\"class\">.<span class=\"keyword\">class</span>) //<span class=\"title\">NioSocketChannel</span> </span></span><br><span class=\"line\"><span class=\"class\">                    .<span class=\"title\">option</span>(<span class=\"title\">ChannelOption</span>.<span class=\"title\">SO_BACKLOG</span>, 128) // </span></span><br><span class=\"line\"><span class=\"class\">                    .<span class=\"title\">childHandler</span>(<span class=\"title\">new</span> <span class=\"title\">ChannelInitializer</span>&lt;<span class=\"title\">SocketChannel</span>&gt;() </span>&#123;<span class=\"comment\">//()</span></span><br><span class=\"line\">                        <span class=\"comment\">//workGroupSocketChannel</span></span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initChannel</span><span class=\"params\">(SocketChannel ch)</span> </span>&#123;</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">\"socketchannel hashcode=\"</span> + ch.hashCode()); <span class=\"comment\">// SocketChannel channel  NIOEventLoop  taskQueue  scheduleTaskQueue</span></span><br><span class=\"line\">                            ch.pipeline().addLast(<span class=\"keyword\">new</span> NettyServerHandler()); <span class=\"comment\">// </span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"..... is ready...\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//bindisDone()</span></span><br><span class=\"line\">            ChannelFuture cf = bootstrap.bind(<span class=\"number\">6668</span>).sync();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//cf </span></span><br><span class=\"line\">            cf.addListener((ChannelFutureListener) future -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (cf.isSuccess()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            cf.channel().closeFuture().sync();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            bossGroup.shutdownGracefully();</span><br><span class=\"line\">            workerGroup.shutdownGracefully();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>            2. <code>NettyServerHandler.java</code><code>ChannelHandler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.buffer.ByteBuf;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.buffer.Unpooled;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.util.CharsetUtil;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyServerHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">ChannelInboundHandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx: ,  pipeline , channel, </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelActive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ()</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx:,  pipeline , channel, </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> msg:  Object</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelRead</span><span class=\"params\">(ChannelHandlerContext ctx, Object msg)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        Channel channel = ctx.channel();</span><br><span class=\"line\">        <span class=\"comment\">// msg  ByteBuf,ByteBuf  Netty  NIO  ByteBuffer.</span></span><br><span class=\"line\">        ByteBuf buf = (ByteBuf) msg;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span> + buf.toString(CharsetUtil.UTF_8));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span> + channel.remoteAddress());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *  </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelReadComplete</span><span class=\"params\">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        ctx.writeAndFlush(Unpooled.copiedBuffer(<span class=\"string\">\"hello, \"</span>, CharsetUtil.UTF_8));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * , </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> cause</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">exceptionCaught</span><span class=\"params\">(ChannelHandlerContext ctx, Throwable cause)</span> </span>&#123;</span><br><span class=\"line\">        ctx.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>SpringBoot</code> + <code>Netty</code>(<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelInitializer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelPipeline;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.HttpObjectAggregator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.HttpServerCodec;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.stream.ChunkedWriteHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Qualifier</span>(<span class=\"string\">\"somethingChannelInitializer\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyWebSocketChannelInitializer</span> <span class=\"keyword\">extends</span> <span class=\"title\">ChannelInitializer</span>&lt;<span class=\"title\">SocketChannel</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TextWebSocketFrameHandler textWebSocketFrameHandler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">initChannel</span><span class=\"params\">(SocketChannel ch)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;<span class=\"comment\">//2</span></span><br><span class=\"line\">        ChannelPipeline pipeline = ch.pipeline();</span><br><span class=\"line\"></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> HttpServerCodec()); <span class=\"comment\">// http</span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> HttpObjectAggregator(<span class=\"number\">64</span>*<span class=\"number\">1024</span>)); <span class=\"comment\">// http</span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> ChunkedWriteHandler()); <span class=\"comment\">// </span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> WebSocketServerProtocolHandler(<span class=\"string\">\"/ws\"</span>)); <span class=\"comment\">//</span></span><br><span class=\"line\">        pipeline.addLast(textWebSocketFrameHandler); <span class=\"comment\">// ChannelHandler</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lhl.netty.chat.util.RandomName;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lhl.netty.chat.util.RedisDao;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.Channel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.SimpleChannelInboundHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.group.ChannelGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.group.DefaultChannelGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.websocketx.TextWebSocketFrame;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.util.concurrent.GlobalEventExecutor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Qualifier</span>(<span class=\"string\">\"textWebSocketFrameHandler\"</span>)</span><br><span class=\"line\"><span class=\"meta\">@ChannelHandler</span>.Sharable</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TextWebSocketFrameHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">SimpleChannelInboundHandler</span>&lt;<span class=\"title\">TextWebSocketFrame</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ChannelGroup channels = <span class=\"keyword\">new</span> DefaultChannelGroup(GlobalEventExecutor.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisDao redisDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">channelRead0</span><span class=\"params\">(ChannelHandlerContext ctx,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                TextWebSocketFrame msg)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        String uName = redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (channel != incoming)&#123;</span><br><span class=\"line\">                channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[\"</span> + uName + <span class=\"string\">\"]\"</span> + msg.text()));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[]\"</span> + msg.text() ));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handlerAdded</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        System.out.println(ctx.channel().remoteAddress());</span><br><span class=\"line\">        String uName = <span class=\"keyword\">new</span> RandomName().getRandomName();</span><br><span class=\"line\"></span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[] - \"</span> + uName + <span class=\"string\">\" \"</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        redisDao.saveString(incoming.id()+<span class=\"string\">\"\"</span>,uName);</span><br><span class=\"line\">        channels.add(ctx.channel());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handlerRemoved</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        String uName = redisDao.getString(String.valueOf(incoming.id()));</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[] - \"</span> + uName + <span class=\"string\">\" \"</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        redisDao.deleteString(String.valueOf(incoming.id()));</span><br><span class=\"line\"></span><br><span class=\"line\">        channels.remove(ctx.channel());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelActive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelInactive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">exceptionCaught</span><span class=\"params\">(ChannelHandlerContext ctx, Throwable cause)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        cause.printStackTrace();</span><br><span class=\"line\">        ctx.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-5-Netty\"><a href=\"#3-5-Netty\" class=\"headerlink\" title=\"3.5 Netty\"></a>3.5 Netty</h3><h4 id=\"BootstrapServerBootstrap\"><a href=\"#BootstrapServerBootstrap\" class=\"headerlink\" title=\"BootstrapServerBootstrap\"></a>BootstrapServerBootstrap</h4><ol>\n<li><code>Bootstrap</code>  <code>Netty</code>  <code>Bootstrap</code>  <code>Netty</code> <code>Netty</code>  <code>Bootstrap</code> <code>ServerBootstrap</code> </li>\n<li><ul>\n<li><code>public ServerBootstrap group(EventLoopGroup parentGroup, EventLoopGroup childGroup)</code> <code>EventLoop</code></li>\n<li><code>public B group(EventLoopGroup group)</code> <code>EventLoop</code></li>\n<li><code>public B channel(Class&lt;? extends C&gt; channelClass)</code></li>\n<li><code>public &lt;T&gt; B option(ChannelOption&lt;T&gt; option, T value)</code> <code>ServerChannel</code> </li>\n<li><code>public &lt;T&gt; ServerBootstrap childOption(ChannelOption&lt;T&gt; childOption, T value)</code></li>\n<li><code>public ServerBootstrap childHandler(ChannelHandler childHandler)</code><code>handler</code></li>\n<li><code>public ChannelFuture bind(int inetPort)</code></li>\n<li><code>public ChannelFuture connect(String inetHost, int inetPort)</code></li>\n</ul>\n</li>\n</ol>\n<h4 id=\"FutureChannelFuture\"><a href=\"#FutureChannelFuture\" class=\"headerlink\" title=\"FutureChannelFuture\"></a>FutureChannelFuture</h4><p><code>Netty</code>  <code>IO</code>  <code>Future</code>  <code>ChannelFutures</code></p>\n<p></p>\n<ul>\n<li><code>Channel channel()</code> <code>IO</code> </li>\n<li><code>ChannelFuture sync()</code></li>\n</ul>\n<h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><ol>\n<li><code>Netty</code>  <code>I/O</code> </li>\n<li> <code>Channel</code> </li>\n<li> <code>Channel</code> </li>\n<li><code>Channel</code>  <code>I/O</code> () <code>I/O</code>  <code>I/O</code> </li>\n<li> <code>ChannelFuture</code>  <code>ChannelFuture</code>  <code>I/O</code> </li>\n<li> <code>I/O</code> </li>\n<li> <code>Channel</code>  <code>Channel</code> <ul>\n<li><code>NioSocketChannel</code> <code>TCP</code> <code>Socket</code> </li>\n<li><code>NioServerSocketChannel</code> <code>TCP</code> <code>Socket</code> </li>\n<li><code>NioDatagramChannel</code> <code>UDP</code> </li>\n<li><code>NioSctpChannel</code> <code>Sctp</code> </li>\n<li><code>NioSctpServerChannel</code> <code>Sctp</code>  <code>UDP</code>  <code>TCP</code>  <code>IO</code>  <code>IO</code></li>\n</ul>\n</li>\n</ol>\n<h4 id=\"Selector\"><a href=\"#Selector\" class=\"headerlink\" title=\"Selector\"></a>Selector</h4><ol>\n<li><code>Netty</code>  <code>Selector</code>  <code>I/O</code>  <code>Selector</code>  <code>Channel</code> </li>\n<li> <code>Selector</code>  <code>Channel</code> <code>Selector</code> <code>Select</code> <code>Channel</code>  <code>I/O</code>  <code>Channel</code></li>\n</ol>\n<h4 id=\"ChannelHandler\"><a href=\"#ChannelHandler\" class=\"headerlink\" title=\"ChannelHandler\"></a>ChannelHandler</h4><ol>\n<li><code>ChannelHandler</code>  <code>I/O</code>  <code>I/O</code>  <code>ChannelPipeline</code></li>\n<li><code>ChannelHandler</code> </li>\n</ol>\n<h4 id=\"Pipeline--ChannelPipeline\"><a href=\"#Pipeline--ChannelPipeline\" class=\"headerlink\" title=\"Pipeline  ChannelPipeline\"></a>Pipeline  ChannelPipeline</h4><ol>\n<li><code>ChannelPipeline</code>  <code>Handler</code>  <code>inbound</code>  <code>outbound</code>  <code>Netty</code> <code>ChannelPipeline</code>  <code>ChannelHandler</code>  <code>List</code> <code>Channel</code> </li>\n<li><code>ChannelPipeline</code>  <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li> <code>Netty</code>  <code>Channel</code>  <code>ChannelPipeline</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/oZARqLONHzbaGiP.png\" alt=\"\"></p>\n<p>    <img src=\"https://i.loli.net/2021/10/18/KeR8OM6uTVqhjFZ.png\" alt=\"\"></p>\n<ol start=\"4\">\n<li><br> <code>ChannelPipeline addFirst(ChannelHandler... handlers)</code><code>handler</code><code>ChannelPipeline addLast(ChannelHandler... handlers)</code><code>handler</code></li>\n</ol>\n<h4 id=\"ChannelHandlerContext\"><a href=\"#ChannelHandlerContext\" class=\"headerlink\" title=\"ChannelHandlerContext\"></a>ChannelHandlerContext</h4><ol>\n<li> <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li> <code>ChannelHandlerContext</code>  <code>ChannelHandler</code> <code>ChannelHandlerContext</code>  <code>pipeline</code>  <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li><ul>\n<li><code>ChannelFuture close()</code></li>\n<li><code>ChannelOutboundInvoker flush()</code></li>\n<li><code>ChannelFuture writeAndFlush(Object msg)</code> </li>\n<li><code>ChannelPipeline</code>  <code>ChannelHandler</code>  <code>ChannelHandler</code> </li>\n</ul>\n</li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/qRSk7ezATLQtKV5.png\" alt=\"\"></p>\n<h4 id=\"ChannelOption\"><a href=\"#ChannelOption\" class=\"headerlink\" title=\"ChannelOption\"></a>ChannelOption</h4><ol>\n<li><code>Netty</code>  <code>Channel</code>  <code>ChannelOption</code> </li>\n<li><code>ChannelOption</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/Z6pAFyCjhOU5dvg.png\" alt=\"\"></p>\n<h4 id=\"EventLoopGroup\"><a href=\"#EventLoopGroup\" class=\"headerlink\" title=\"EventLoopGroup\"></a>EventLoopGroup</h4><ol>\n<li><code>EventLoopGroup</code>  <code>EventLoop</code> <code>Netty</code>  <code>CPU</code>  <code>EventLoop</code>  <code>EventLoop</code>  <code>Selector</code> </li>\n<li><code>EventLoopGroup</code>  <code>next</code>  <code>EventLoop</code>  <code>Netty</code>  <code>EventLoopGroup</code><code>BossEventLoopGroup</code>  <code>WorkerEventLoopGroup</code></li>\n<li> <code>ServerSocketChannel</code>  <code>Selector</code>  <code>EventLoop</code> <code>BossEventLoop</code>  <code>SocketChannel</code>  <code>WorkerEventLoopGroup</code>  <code>IO</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/zoQgpkliDMshRN1.png\" alt=\"\"></p>\n<ol start=\"4\">\n<li><br> <code>public NioEventLoopGroup()</code><br> <code>public Future&lt;?&gt; shutdownGracefully()</code></li>\n</ol>\n<h4 id=\"Unpooled\"><a href=\"#Unpooled\" class=\"headerlink\" title=\"Unpooled\"></a>Unpooled</h4><ol>\n<li><code>Netty</code>  <code>Netty</code> </li>\n<li></li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/yQbHkAGRs7fqYX2.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li><code>Unpooled</code>  <code>Netty</code>  <code>ByteBuf</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/CpM4xhrFYE1IdVB.png\" alt=\"\"></p>\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"BIONIONetty\"><a href=\"#BIONIONetty\" class=\"headerlink\" title=\"BIONIONetty\"></a>BIONIONetty</h1><blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>        Client/ServerIPSocket</p>\n<h3 id=\"BIO\"><a href=\"#BIO\" class=\"headerlink\" title=\"BIO:\"></a>BIO:</h3><p>        1.4Java IOIOBlocking IOBIO</p>\n<h3 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO:\"></a>NIO:</h3><p>        IOJavaIOJAVA NIONon-Blocking IOJava NIO IO</p>\n<h3 id=\"Netty\"><a href=\"#Netty\" class=\"headerlink\" title=\"Netty:\"></a>Netty:</h3><p>        Netty<a href=\"https://baike.baidu.com/item//9597519\" target=\"_blank\" rel=\"noopener\"></a>NIONetty <a href=\"https://baike.baidu.com/item//6492316\" target=\"_blank\" rel=\"noopener\"></a></p>\n</blockquote>\n<h2 id=\"1-Java-BIO\"><a href=\"#1-Java-BIO\" class=\"headerlink\" title=\"1. Java BIO\"></a>1. Java BIO</h2><h3 id=\"1-1-Java-BIO\"><a href=\"#1-1-Java-BIO\" class=\"headerlink\" title=\"1.1 Java BIO\"></a>1.1 Java BIO</h3><ul>\n<li><p>IO</p>\n<p>  <img src=\"https://i.loli.net/2021/10/18/6jJxcVENwszR8Wd.png\" alt=\"bio-model\"></p>\n</li>\n</ul>\n<h3 id=\"1-2-Java-BIO-\"><a href=\"#1-2-Java-BIO-\" class=\"headerlink\" title=\"1.2 Java BIO \"></a>1.2 Java BIO </h3><ol>\n<li> <code>ServerSocket</code></li>\n<li> <code>Socket</code> </li>\n<li></li>\n</ol>\n<h3 id=\"1-3-Java-BIO-github\"><a href=\"#1-3-Java-BIO-github\" class=\"headerlink\" title=\"1.3 Java BIO(github)\"></a>1.3 Java BIO(<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>BIO</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ServerSocket</span></span><br><span class=\"line\">        ServerSocket serverSocket = <span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9090</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"....\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Socket socket = serverSocket.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            socket.getInputStream().read(bytes); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(bytes));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>socket.getInputStream().read(bytes)</code></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.io.InputStream;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.ServerSocket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.Socket;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.ExecutorService;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.concurrent.Executors;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">BioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">// ServerSocket</span></span><br><span class=\"line\">        ServerSocket serverSocket = <span class=\"keyword\">new</span> ServerSocket(<span class=\"number\">9090</span>);</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// ,: 1.  2. ()</span></span><br><span class=\"line\">        ExecutorService newCachedThreadPool = Executors.newCachedThreadPool();</span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"....\"</span>);</span><br><span class=\"line\">            <span class=\"keyword\">final</span> Socket socket = serverSocket.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">            newCachedThreadPool.execute(() -&gt; &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                handler(socket);</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">handler</span><span class=\"params\">(Socket socket)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">byte</span>[] bytes = <span class=\"keyword\">new</span> <span class=\"keyword\">byte</span>[<span class=\"number\">1024</span>];</span><br><span class=\"line\">            <span class=\"comment\">//socket</span></span><br><span class=\"line\">            InputStream inputStream = socket.getInputStream();</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                <span class=\"keyword\">int</span> read = inputStream.read(bytes); <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (read != -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(bytes, <span class=\"number\">0</span>, read));</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    <span class=\"keyword\">break</span>;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">            e.printStackTrace();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"handlerid = \"</span> + Thread.currentThread().getId() + <span class=\"string\">\"\"</span>); </span><br><span class=\"line\">            <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                socket.close();</span><br><span class=\"line\">            &#125; <span class=\"keyword\">catch</span> (Exception e) &#123;</span><br><span class=\"line\">                e.printStackTrace();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>        <code>inputStream.read(bytes)</code></p>\n<h2 id=\"2-Java-NIO\"><a href=\"#2-Java-NIO\" class=\"headerlink\" title=\"2. Java NIO\"></a>2. Java NIO</h2><h3 id=\"2-1-Java-NIO\"><a href=\"#2-1-Java-NIO\" class=\"headerlink\" title=\"2.1 Java NIO\"></a>2.1 Java NIO</h3><ul>\n<li><p>IO <code>I/O</code> </p>\n<p>  <img src=\"https://i.loli.net/2021/10/18/ABy7qJoGhwaSzip.png\" alt=\"nio-model\"></p>\n</li>\n</ul>\n<h3 id=\"2-2-Java-NIO\"><a href=\"#2-2-Java-NIO\" class=\"headerlink\" title=\"2.2 Java NIO\"></a>2.2 Java NIO</h3><ol>\n<li><h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><p> BIOInput StreamOutput StreamNIONIOIOBIO</p>\n</li>\n<li><h4 id=\"Selector\"><a href=\"#Selector\" class=\"headerlink\" title=\"Selector\"></a>Selector</h4><blockquote>\n<p>IO//</p>\n</blockquote>\n<p> IOselectIO/</p>\n</li>\n<li><h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p> Channelreadwrite</p>\n</li>\n</ol>\n<h3 id=\"2-3-SelectorChannel--Buffer-\"><a href=\"#2-3-SelectorChannel--Buffer-\" class=\"headerlink\" title=\"2.3 SelectorChannel  Buffer \"></a>2.3 SelectorChannel  Buffer </h3><ol>\n<li> <code>Channel</code>  <code>Buffer</code></li>\n<li><code>Selector</code>  <code>Channel</code></li>\n<li><code>Selector</code> </li>\n<li><code>Buffer</code> </li>\n<li> <code>Buffer</code><code>BIO</code>  <code>NIO</code>  <code>Buffer</code>  <code>flip</code>  <code>Channel</code>  <code>Linux</code></li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/4F5pSqTYbayDgsJ.png\" alt=\"nio-element\"></p>\n<h3 id=\"2-4-Java-NIO-\"><a href=\"#2-4-Java-NIO-\" class=\"headerlink\" title=\"2.4 Java NIO \"></a>2.4 Java NIO </h3><ol>\n<li><p> <code>ServerSocketChannel</code>BIOServerSocket</p>\n</li>\n<li><p> <code>SocketChannel</code>BIOSocket</p>\n</li>\n<li><p><code>Selector</code><code>ServerSocketChannel</code><code>Selector</code> <code>SelectionKey</code> <code>Selector</code>  <code>Selector</code>  <code>SocketChannel</code></p>\n</li>\n<li><p> <code>ServerSocketChannel</code> <code>SocketChannel</code></p>\n</li>\n<li><p><code>Selector</code>  <code>select</code> </p>\n</li>\n<li><p> <code>socketChannel</code>  <code>Selector</code>  <code>SelectionKey</code></p>\n</li>\n<li><p> <code>SelectionKey</code>  <code>SocketChannel</code></p>\n</li>\n<li><p> <code>channel</code></p>\n<p> <img src=\"https://i.loli.net/2021/10/18/ybcGt7zRT459L8Z.png\" alt=\"nio-workflow\"></p>\n</li>\n</ol>\n<h3 id=\"2-4-Java-NIO--github\"><a href=\"#2-4-Java-NIO--github\" class=\"headerlink\" title=\"2.4 Java NIO (github)\"></a>2.4 Java NIO (<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>NIO<code>List&lt;SocketChannel&gt;</code><code>SocketChannel</code>IO</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.ByteBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.ServerSocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">static</span> List&lt;SocketChannel&gt; channelList = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (<span class=\"keyword\">true</span>) &#123;</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            SocketChannel socketChannel = serverSocketChannel.accept(); <span class=\"comment\">// </span></span><br><span class=\"line\">            <span class=\"keyword\">if</span> (<span class=\"keyword\">null</span> != socketChannel) &#123;</span><br><span class=\"line\">                System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                <span class=\"comment\">// SocketChannelNIOaccept</span></span><br><span class=\"line\">                socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">                channelList.add(socketChannel);</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SocketChannel&gt; channels = channelList.iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (channels.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SocketChannel channel = channels.next();</span><br><span class=\"line\">                ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                <span class=\"comment\">// read</span></span><br><span class=\"line\">                <span class=\"keyword\">int</span> length = channel.read(byteBuffer); <span class=\"comment\">// </span></span><br><span class=\"line\">                <span class=\"keyword\">if</span> (length &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (length == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                    channels.remove();</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        startServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>serverSocketChannel.accept()</code><code>channel.read(byteBuffer)</code><code>while(true)</code><code>Selector</code><code>selector.select()</code></li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.io.IOException;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.net.InetSocketAddress;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.ByteBuffer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SelectionKey;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.Selector;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.ServerSocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.nio.channels.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.Iterator;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioSelectorServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5656</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Selector selector = Selector.open(); <span class=\"comment\">// epoll</span></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        SelectionKey selectionKey = serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123; <span class=\"comment\">//  epoll-wait</span></span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.register(selector, SelectionKey.OP_READ);</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// read</span></span><br><span class=\"line\">                    <span class=\"keyword\">int</span> length = socketChannel.read(byteBuffer);</span><br><span class=\"line\">                    <span class=\"keyword\">if</span> (length &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        System.out.println(<span class=\"string\">\"\"</span> + <span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                    &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (length == -<span class=\"number\">1</span>) &#123;</span><br><span class=\"line\">                        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                        socketChannel.close();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                selectedKeys.remove();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        startServer();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-5-Selector\"><a href=\"#2-5-Selector\" class=\"headerlink\" title=\"2.5 Selector\"></a>2.5 <code>Selector</code></h3><p>    <code>Selector</code>IO<code>epoll</code>(Linux)<code>epoll</code></p>\n<ol>\n<li><p>epoll_create</p>\n<p> epollchannel </p>\n</li>\n<li><p>epoll_ctl</p>\n<p> //channel</p>\n</li>\n<li><p>epoll_wait</p>\n<p> IO channel</p>\n</li>\n</ol>\n<h3 id=\"2-6-Java-NIO-\"><a href=\"#2-6-Java-NIO-\" class=\"headerlink\" title=\"2.6 Java NIO \"></a>2.6 Java NIO </h3><p>        <a href=\"https://vickyluoluo.github.io/2021/03/31/57bd.html\">Java NIO</a></p>\n<h2 id=\"3-Netty\"><a href=\"#3-Netty\" class=\"headerlink\" title=\"3. Netty\"></a>3. Netty</h2><h3 id=\"3-1-NIO\"><a href=\"#3-1-NIO\" class=\"headerlink\" title=\"3.1 NIO\"></a>3.1 NIO</h3><ol>\n<li><code>NIO</code>  <code>API</code>  <code>Selector</code><code>ServerSocketChannel</code><code>SocketChannel</code><code>ByteBuffer</code></li>\n<li> <code>Java</code>  <code>NIO</code>  <code>Reactor</code>  <code>NIO</code> </li>\n<li></li>\n<li><code>JDK NIO</code>  <code>Bug</code> <code>Epoll Bug</code> <code>Selector</code>  <code>CPU100%</code> <code>JDK1.7</code> </li>\n</ol>\n<h3 id=\"3-2-Netty-\"><a href=\"#3-2-Netty-\" class=\"headerlink\" title=\"3.2 Netty \"></a>3.2 Netty </h3><p><code>Netty</code>  <code>JDK</code>  <code>NIO</code>  <code>API</code> </p>\n<ol>\n<li> <code>API</code>  <code>Socket</code>-</li>\n<li> <code>Javadoc</code><code>JDK5Netty3.x</code> <code>6Netty4.x</code></li>\n<li></li>\n<li> <code>SSL/TLS</code>  <code>StartTLS</code> </li>\n<li> <code>Bug</code> </li>\n</ol>\n<h3 id=\"3-3-Netty\"><a href=\"#3-3-Netty\" class=\"headerlink\" title=\"3.3 Netty\"></a>3.3 Netty</h3><p><img src=\"https://i.loli.net/2021/10/18/3cnCUJG4yerixqK.png\" alt=\"\"></p>\n<p><code>Netty</code>  <code>Reactors</code> <code>BossGroup</code>  <code>Selector</code> <code>Accecpt</code>  <code>Accept</code>  <code>SocketChannel</code> <code>NIOScoketChannel</code>  <code>Worker</code>  <code>Worker</code>  <code>Selector</code>  <code>handler</code></p>\n<p><img src=\"https://i.loli.net/2021/10/18/chLyW8ko5aRuPqN.png\" alt=\"\"></p>\n<p></p>\n<ol>\n<li><code>Netty</code>  <code>BossGroup</code> <code>WorkerGroup</code> </li>\n<li><code>BossGroup</code>  <code>WorkerGroup</code>  <code>NioEventLoopGroup</code> </li>\n<li><code>NioEventLoopGroup</code>  <code>NioEventLoop</code> </li>\n<li><code>NioEventLoop</code>  <code>NioEventLoop</code>  <code>Selector</code> <code>socket</code> </li>\n<li><code>NioEventLoopGroup</code>  <code>NioEventLoop</code> </li>\n<li> <code>BossNioEventLoop</code>  <code>3</code> <ul>\n<li> <code>accept</code> </li>\n<li> <code>accept</code>  <code>client</code>  <code>NioScocketChannel</code> <code>worker</code> <code>NIOEventLoop</code>  <code>Selector</code></li>\n<li> <code>runAllTasks</code></li>\n</ul>\n</li>\n<li> <code>Worker</code> <code>NIOEventLoop</code> <ul>\n<li> <code>read</code><code>write</code> </li>\n<li> <code>I/O</code>  <code>read</code><code>write</code>  <code>NioScocketChannel</code> </li>\n<li> <code>runAllTasks</code></li>\n</ul>\n</li>\n<li> <code>Worker</code> <code>NIOEventLoop</code>  <code>pipeline</code><code>pipeline</code>  <code>channel</code> <code>pipeline</code> </li>\n</ol>\n<h3 id=\"3-4-Netty--github\"><a href=\"#3-4-Netty--github\" class=\"headerlink\" title=\"3.4 Netty (github)\"></a>3.4 Netty (<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</h3><ul>\n<li>Netty<ol>\n<li><code>NettyServer.java</code> </li>\n</ol>\n</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.bootstrap.ServerBootstrap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.nio.NioEventLoopGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.nio.NioServerSocketChannel;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyServer</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">//bossGroupworkerGroupcpu * 2bossGroup,workerGroup</span></span><br><span class=\"line\">        EventLoopGroup bossGroup = <span class=\"keyword\">new</span> NioEventLoopGroup(<span class=\"number\">1</span>);</span><br><span class=\"line\">        EventLoopGroup workerGroup = <span class=\"keyword\">new</span> NioEventLoopGroup(<span class=\"number\">8</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            ServerBootstrap bootstrap = <span class=\"keyword\">new</span> ServerBootstrap();</span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            bootstrap.group(bossGroup, workerGroup) <span class=\"comment\">//</span></span><br><span class=\"line\">                    .channel(NioServerSocketChannel<span class=\"class\">.<span class=\"keyword\">class</span>) //<span class=\"title\">NioSocketChannel</span> </span></span><br><span class=\"line\"><span class=\"class\">                    .<span class=\"title\">option</span>(<span class=\"title\">ChannelOption</span>.<span class=\"title\">SO_BACKLOG</span>, 128) // </span></span><br><span class=\"line\"><span class=\"class\">                    .<span class=\"title\">childHandler</span>(<span class=\"title\">new</span> <span class=\"title\">ChannelInitializer</span>&lt;<span class=\"title\">SocketChannel</span>&gt;() </span>&#123;<span class=\"comment\">//()</span></span><br><span class=\"line\">                        <span class=\"comment\">//workGroupSocketChannel</span></span><br><span class=\"line\">                        <span class=\"meta\">@Override</span></span><br><span class=\"line\">                        <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">initChannel</span><span class=\"params\">(SocketChannel ch)</span> </span>&#123;</span><br><span class=\"line\">                            System.out.println(<span class=\"string\">\"socketchannel hashcode=\"</span> + ch.hashCode()); <span class=\"comment\">// SocketChannel channel  NIOEventLoop  taskQueue  scheduleTaskQueue</span></span><br><span class=\"line\">                            ch.pipeline().addLast(<span class=\"keyword\">new</span> NettyServerHandler()); <span class=\"comment\">// </span></span><br><span class=\"line\">                        &#125;</span><br><span class=\"line\">                    &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            System.out.println(<span class=\"string\">\"..... is ready...\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//bindisDone()</span></span><br><span class=\"line\">            ChannelFuture cf = bootstrap.bind(<span class=\"number\">6668</span>).sync();</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//cf </span></span><br><span class=\"line\">            cf.addListener((ChannelFutureListener) future -&gt; &#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (cf.isSuccess()) &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                    System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;);</span><br><span class=\"line\"></span><br><span class=\"line\">            <span class=\"comment\">//</span></span><br><span class=\"line\">            cf.channel().closeFuture().sync();</span><br><span class=\"line\">        &#125; <span class=\"keyword\">finally</span> &#123;</span><br><span class=\"line\">            bossGroup.shutdownGracefully();</span><br><span class=\"line\">            workerGroup.shutdownGracefully();</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>            2. <code>NettyServerHandler.java</code><code>ChannelHandler</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.buffer.ByteBuf;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.buffer.Unpooled;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.*;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.util.CharsetUtil;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyServerHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">ChannelInboundHandlerAdapter</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx: ,  pipeline , channel, </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelActive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * ()</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx:,  pipeline , channel, </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> msg:  Object</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelRead</span><span class=\"params\">(ChannelHandlerContext ctx, Object msg)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        Channel channel = ctx.channel();</span><br><span class=\"line\">        <span class=\"comment\">// msg  ByteBuf,ByteBuf  Netty  NIO  ByteBuffer.</span></span><br><span class=\"line\">        ByteBuf buf = (ByteBuf) msg;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span> + buf.toString(CharsetUtil.UTF_8));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span> + channel.remoteAddress());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     *  </span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelReadComplete</span><span class=\"params\">(ChannelHandlerContext ctx)</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"comment\">//</span></span><br><span class=\"line\">        ctx.writeAndFlush(Unpooled.copiedBuffer(<span class=\"string\">\"hello, \"</span>, CharsetUtil.UTF_8));</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">     * , </span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> ctx</span></span><br><span class=\"line\"><span class=\"comment\">     * <span class=\"doctag\">@param</span> cause</span></span><br><span class=\"line\"><span class=\"comment\">     */</span></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">exceptionCaught</span><span class=\"params\">(ChannelHandlerContext ctx, Throwable cause)</span> </span>&#123;</span><br><span class=\"line\">        ctx.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><code>SpringBoot</code> + <code>Netty</code>(<a href=\"https://github.com/VickyLuoLuo/netty.git\" target=\"_blank\" rel=\"noopener\">github</a>)</li>\n</ul>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelInitializer;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelPipeline;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.socket.SocketChannel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.HttpObjectAggregator;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.HttpServerCodec;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.websocketx.WebSocketServerProtocolHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.stream.ChunkedWriteHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Qualifier</span>(<span class=\"string\">\"somethingChannelInitializer\"</span>)</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NettyWebSocketChannelInitializer</span> <span class=\"keyword\">extends</span> <span class=\"title\">ChannelInitializer</span>&lt;<span class=\"title\">SocketChannel</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> TextWebSocketFrameHandler textWebSocketFrameHandler;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">initChannel</span><span class=\"params\">(SocketChannel ch)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;<span class=\"comment\">//2</span></span><br><span class=\"line\">        ChannelPipeline pipeline = ch.pipeline();</span><br><span class=\"line\"></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> HttpServerCodec()); <span class=\"comment\">// http</span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> HttpObjectAggregator(<span class=\"number\">64</span>*<span class=\"number\">1024</span>)); <span class=\"comment\">// http</span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> ChunkedWriteHandler()); <span class=\"comment\">// </span></span><br><span class=\"line\">        pipeline.addLast(<span class=\"keyword\">new</span> WebSocketServerProtocolHandler(<span class=\"string\">\"/ws\"</span>)); <span class=\"comment\">//</span></span><br><span class=\"line\">        pipeline.addLast(textWebSocketFrameHandler); <span class=\"comment\">// ChannelHandler</span></span><br><span class=\"line\"></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> com.lhl.netty.chat.util.RandomName;</span><br><span class=\"line\"><span class=\"keyword\">import</span> com.lhl.netty.chat.util.RedisDao;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.Channel;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.ChannelHandlerContext;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.SimpleChannelInboundHandler;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.group.ChannelGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.channel.group.DefaultChannelGroup;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.handler.codec.http.websocketx.TextWebSocketFrame;</span><br><span class=\"line\"><span class=\"keyword\">import</span> io.netty.util.concurrent.GlobalEventExecutor;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Autowired;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.beans.factory.annotation.Qualifier;</span><br><span class=\"line\"><span class=\"keyword\">import</span> org.springframework.stereotype.Component;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"meta\">@Component</span></span><br><span class=\"line\"><span class=\"meta\">@Qualifier</span>(<span class=\"string\">\"textWebSocketFrameHandler\"</span>)</span><br><span class=\"line\"><span class=\"meta\">@ChannelHandler</span>.Sharable</span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">TextWebSocketFrameHandler</span> <span class=\"keyword\">extends</span> <span class=\"title\">SimpleChannelInboundHandler</span>&lt;<span class=\"title\">TextWebSocketFrame</span>&gt; </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">public</span> <span class=\"keyword\">static</span> ChannelGroup channels = <span class=\"keyword\">new</span> DefaultChannelGroup(GlobalEventExecutor.INSTANCE);</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Autowired</span></span><br><span class=\"line\">    <span class=\"keyword\">private</span> RedisDao redisDao;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">protected</span> <span class=\"keyword\">void</span> <span class=\"title\">channelRead0</span><span class=\"params\">(ChannelHandlerContext ctx,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">                                TextWebSocketFrame msg)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        String uName = redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">if</span> (channel != incoming)&#123;</span><br><span class=\"line\">                channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[\"</span> + uName + <span class=\"string\">\"]\"</span> + msg.text()));</span><br><span class=\"line\">            &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">                channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[]\"</span> + msg.text() ));</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handlerAdded</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        System.out.println(ctx.channel().remoteAddress());</span><br><span class=\"line\">        String uName = <span class=\"keyword\">new</span> RandomName().getRandomName();</span><br><span class=\"line\"></span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[] - \"</span> + uName + <span class=\"string\">\" \"</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        redisDao.saveString(incoming.id()+<span class=\"string\">\"\"</span>,uName);</span><br><span class=\"line\">        channels.add(ctx.channel());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">handlerRemoved</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        String uName = redisDao.getString(String.valueOf(incoming.id()));</span><br><span class=\"line\">        <span class=\"keyword\">for</span> (Channel channel : channels) &#123;</span><br><span class=\"line\">            channel.writeAndFlush(<span class=\"keyword\">new</span> TextWebSocketFrame(<span class=\"string\">\"[] - \"</span> + uName + <span class=\"string\">\" \"</span>));</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        redisDao.deleteString(String.valueOf(incoming.id()));</span><br><span class=\"line\"></span><br><span class=\"line\">        channels.remove(ctx.channel());</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelActive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">channelInactive</span><span class=\"params\">(ChannelHandlerContext ctx)</span> <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"meta\">@Override</span></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">exceptionCaught</span><span class=\"params\">(ChannelHandlerContext ctx, Throwable cause)</span></span></span><br><span class=\"line\"><span class=\"function\">            <span class=\"keyword\">throws</span> Exception </span>&#123;</span><br><span class=\"line\">        Channel incoming = ctx.channel();</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\":\"</span>+redisDao.getString(incoming.id()+<span class=\"string\">\"\"</span>)+<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        cause.printStackTrace();</span><br><span class=\"line\">        ctx.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-5-Netty\"><a href=\"#3-5-Netty\" class=\"headerlink\" title=\"3.5 Netty\"></a>3.5 Netty</h3><h4 id=\"BootstrapServerBootstrap\"><a href=\"#BootstrapServerBootstrap\" class=\"headerlink\" title=\"BootstrapServerBootstrap\"></a>BootstrapServerBootstrap</h4><ol>\n<li><code>Bootstrap</code>  <code>Netty</code>  <code>Bootstrap</code>  <code>Netty</code> <code>Netty</code>  <code>Bootstrap</code> <code>ServerBootstrap</code> </li>\n<li><ul>\n<li><code>public ServerBootstrap group(EventLoopGroup parentGroup, EventLoopGroup childGroup)</code> <code>EventLoop</code></li>\n<li><code>public B group(EventLoopGroup group)</code> <code>EventLoop</code></li>\n<li><code>public B channel(Class&lt;? extends C&gt; channelClass)</code></li>\n<li><code>public &lt;T&gt; B option(ChannelOption&lt;T&gt; option, T value)</code> <code>ServerChannel</code> </li>\n<li><code>public &lt;T&gt; ServerBootstrap childOption(ChannelOption&lt;T&gt; childOption, T value)</code></li>\n<li><code>public ServerBootstrap childHandler(ChannelHandler childHandler)</code><code>handler</code></li>\n<li><code>public ChannelFuture bind(int inetPort)</code></li>\n<li><code>public ChannelFuture connect(String inetHost, int inetPort)</code></li>\n</ul>\n</li>\n</ol>\n<h4 id=\"FutureChannelFuture\"><a href=\"#FutureChannelFuture\" class=\"headerlink\" title=\"FutureChannelFuture\"></a>FutureChannelFuture</h4><p><code>Netty</code>  <code>IO</code>  <code>Future</code>  <code>ChannelFutures</code></p>\n<p></p>\n<ul>\n<li><code>Channel channel()</code> <code>IO</code> </li>\n<li><code>ChannelFuture sync()</code></li>\n</ul>\n<h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><ol>\n<li><code>Netty</code>  <code>I/O</code> </li>\n<li> <code>Channel</code> </li>\n<li> <code>Channel</code> </li>\n<li><code>Channel</code>  <code>I/O</code> () <code>I/O</code>  <code>I/O</code> </li>\n<li> <code>ChannelFuture</code>  <code>ChannelFuture</code>  <code>I/O</code> </li>\n<li> <code>I/O</code> </li>\n<li> <code>Channel</code>  <code>Channel</code> <ul>\n<li><code>NioSocketChannel</code> <code>TCP</code> <code>Socket</code> </li>\n<li><code>NioServerSocketChannel</code> <code>TCP</code> <code>Socket</code> </li>\n<li><code>NioDatagramChannel</code> <code>UDP</code> </li>\n<li><code>NioSctpChannel</code> <code>Sctp</code> </li>\n<li><code>NioSctpServerChannel</code> <code>Sctp</code>  <code>UDP</code>  <code>TCP</code>  <code>IO</code>  <code>IO</code></li>\n</ul>\n</li>\n</ol>\n<h4 id=\"Selector\"><a href=\"#Selector\" class=\"headerlink\" title=\"Selector\"></a>Selector</h4><ol>\n<li><code>Netty</code>  <code>Selector</code>  <code>I/O</code>  <code>Selector</code>  <code>Channel</code> </li>\n<li> <code>Selector</code>  <code>Channel</code> <code>Selector</code> <code>Select</code> <code>Channel</code>  <code>I/O</code>  <code>Channel</code></li>\n</ol>\n<h4 id=\"ChannelHandler\"><a href=\"#ChannelHandler\" class=\"headerlink\" title=\"ChannelHandler\"></a>ChannelHandler</h4><ol>\n<li><code>ChannelHandler</code>  <code>I/O</code>  <code>I/O</code>  <code>ChannelPipeline</code></li>\n<li><code>ChannelHandler</code> </li>\n</ol>\n<h4 id=\"Pipeline--ChannelPipeline\"><a href=\"#Pipeline--ChannelPipeline\" class=\"headerlink\" title=\"Pipeline  ChannelPipeline\"></a>Pipeline  ChannelPipeline</h4><ol>\n<li><code>ChannelPipeline</code>  <code>Handler</code>  <code>inbound</code>  <code>outbound</code>  <code>Netty</code> <code>ChannelPipeline</code>  <code>ChannelHandler</code>  <code>List</code> <code>Channel</code> </li>\n<li><code>ChannelPipeline</code>  <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li> <code>Netty</code>  <code>Channel</code>  <code>ChannelPipeline</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/oZARqLONHzbaGiP.png\" alt=\"\"></p>\n<p>    <img src=\"https://i.loli.net/2021/10/18/KeR8OM6uTVqhjFZ.png\" alt=\"\"></p>\n<ol start=\"4\">\n<li><br> <code>ChannelPipeline addFirst(ChannelHandler... handlers)</code><code>handler</code><code>ChannelPipeline addLast(ChannelHandler... handlers)</code><code>handler</code></li>\n</ol>\n<h4 id=\"ChannelHandlerContext\"><a href=\"#ChannelHandlerContext\" class=\"headerlink\" title=\"ChannelHandlerContext\"></a>ChannelHandlerContext</h4><ol>\n<li> <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li> <code>ChannelHandlerContext</code>  <code>ChannelHandler</code> <code>ChannelHandlerContext</code>  <code>pipeline</code>  <code>Channel</code>  <code>ChannelHandler</code> </li>\n<li><ul>\n<li><code>ChannelFuture close()</code></li>\n<li><code>ChannelOutboundInvoker flush()</code></li>\n<li><code>ChannelFuture writeAndFlush(Object msg)</code> </li>\n<li><code>ChannelPipeline</code>  <code>ChannelHandler</code>  <code>ChannelHandler</code> </li>\n</ul>\n</li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/qRSk7ezATLQtKV5.png\" alt=\"\"></p>\n<h4 id=\"ChannelOption\"><a href=\"#ChannelOption\" class=\"headerlink\" title=\"ChannelOption\"></a>ChannelOption</h4><ol>\n<li><code>Netty</code>  <code>Channel</code>  <code>ChannelOption</code> </li>\n<li><code>ChannelOption</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/Z6pAFyCjhOU5dvg.png\" alt=\"\"></p>\n<h4 id=\"EventLoopGroup\"><a href=\"#EventLoopGroup\" class=\"headerlink\" title=\"EventLoopGroup\"></a>EventLoopGroup</h4><ol>\n<li><code>EventLoopGroup</code>  <code>EventLoop</code> <code>Netty</code>  <code>CPU</code>  <code>EventLoop</code>  <code>EventLoop</code>  <code>Selector</code> </li>\n<li><code>EventLoopGroup</code>  <code>next</code>  <code>EventLoop</code>  <code>Netty</code>  <code>EventLoopGroup</code><code>BossEventLoopGroup</code>  <code>WorkerEventLoopGroup</code></li>\n<li> <code>ServerSocketChannel</code>  <code>Selector</code>  <code>EventLoop</code> <code>BossEventLoop</code>  <code>SocketChannel</code>  <code>WorkerEventLoopGroup</code>  <code>IO</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/zoQgpkliDMshRN1.png\" alt=\"\"></p>\n<ol start=\"4\">\n<li><br> <code>public NioEventLoopGroup()</code><br> <code>public Future&lt;?&gt; shutdownGracefully()</code></li>\n</ol>\n<h4 id=\"Unpooled\"><a href=\"#Unpooled\" class=\"headerlink\" title=\"Unpooled\"></a>Unpooled</h4><ol>\n<li><code>Netty</code>  <code>Netty</code> </li>\n<li></li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/yQbHkAGRs7fqYX2.png\" alt=\"\"></p>\n<ol start=\"3\">\n<li><code>Unpooled</code>  <code>Netty</code>  <code>ByteBuf</code> </li>\n</ol>\n<p><img src=\"https://i.loli.net/2021/10/18/CpM4xhrFYE1IdVB.png\" alt=\"\"></p>\n"},{"title":"---","catalog":true,"abbrlink":"f82e","date":"2022-04-10T07:35:07.000Z","subtitle":null,"header-img":"/img/header_img/post-bg-desk.jpg","top":2,"_content":"\n# ---\n\n## \n\n\n\n## \n\n\n\n## \n\n### SegmentTree\n\n#### :\n\n\tarr\n\t1void add(int L, int R, int V) :  arr[LR]V\n\t2void update(int L, int R, int V) :  arr[LR]V\n\t3int sum(int L, int R) :arr[LR]\n\tO(logN)\n\n#### \n\n1. `origin``0``1``arr`\n\n   ```java\n   int MAXN = origin.length + 1;\n   arr = new int[MAXN]; // arr[0]   1\n   for (int i = 1; i < MAXN; i++) {\n   \tarr[i] = origin[i - 1];\n   }\n   ```\n\n2. `arr``sum``sum``4*MAXN``arr``2^n``2*MAXN`\n\n   `arr[x, 3, 2, 5, 7]sum[x, 17, 5, 12, 3, 2, 5, 7]` \n\n   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`arr(1-4)``sum[1],` \n\n   \t\t\t\t\t\t\t\t\t\t`arr(1-2)``sum[2]``arr(3-4)``sum[3]`\n\n   `arr(1-1)``sum[4]``arr(2-2)``sum[5]``arr(3-3)``sum[6]``arr(4-4)``sum[7]`\n\n   ```java\n   int[] sum = new int[MAXN << 2];\n   \n   // \n   // arr[l~r]build1~N(l: 1, r: origin.length)\n   // rt :  sumroot\n   public void build(int l, int r, int rt) {\n     if (l == r) {\n       sum[rt] = arr[l];\n       return;\n     }\n     int mid = (l + r) >> 1;\n     build(l, mid, rt << 1); //  2*rt\n     build(mid + 1, r, rt << 1 | 1); //  2*rt + 1\n     pushUp(rt);\n   }\n   \n   /**\n    * =+\n    * @param rt\n    */\n   private void pushUp(int rt) {\n     sum[rt] = sum[rt << 1] + sum[rt << 1 | 1];\n   }\n   ```\n\n3. `lr``C``int[] lazy` `l~r`lazy add`sum``lazy`(`lazy[rt << 1] += lazy[rt];``sum`*lazy(`sum[rt << 1] += lazy[rt] * ln;`)`lazy``0`\n\n   ```java\n   // L..R ->  ,C\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public void add(int L, int R, int C,\n   \tint l, int r, \n   \tint rt) {\n     // \n     if (L <= l && r <= R) {\n       sum[rt] += C * (r - l + 1);\n       lazy[rt] += C;\n       return;\n     }\n     // \n     //   L, R   l,r \n     int mid = (l + r) >> 1;\n     // \n     pushDown(rt, mid - l + 1, r - mid);\n     // \n     if (L <= mid) {\n     \tadd(L, R, C, l, mid, rt << 1); // \n     }\n     // \n     if (R > mid) {\n     \tadd(L, R, C, mid + 1, r, rt << 1 | 1); // \n     }\n     // sum\n     pushUp(rt); // 2.\n   }\n   \n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (lazy[rt] != 0) {\n       lazy[rt << 1] += lazy[rt];\n       sum[rt << 1] += lazy[rt] * ln;\n       lazy[rt << 1 | 1] += lazy[rt];\n       sum[rt << 1 | 1] += lazy[rt] * rn;\n       lazy[rt] = 0;\n     }\n   }\n   ```\n\n4. `lr``C``int[] change``boolean[] update``l~r`lazy update`sum`update(`update[rt << 1] = true;change[rt << 1] = change[rt];``sum`*`update`(`sum[rt << 1] = change[rt] * ln;`)`lazy`0`update``false`\n\n   ```java\n   // L..R ->  ,C\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public void update(int L, int R, int C, int l, int r, int rt) {\n     if (L <= l && r <= R) {\n       update[rt] = true;\n       change[rt] = C;\n       sum[rt] = C * (r - l + 1);\n       lazy[rt] = 0;\n       return;\n     }\n     // \n     int mid = (l + r) >> 1;\n     pushDown(rt, mid - l + 1, r - mid);\n     if (L <= mid) {\n     \tupdate(L, R, C, l, mid, rt << 1);\n     }\n     if (R > mid) {\n     \tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n     }\n     pushUp(rt);\n   }\n   \n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (update[rt]) {\n       update[rt << 1] = true;\n       update[rt << 1 | 1] = true;\n       change[rt << 1] = change[rt];\n       change[rt << 1 | 1] = change[rt];\n       lazy[rt << 1] = 0;\n       lazy[rt << 1 | 1] = 0;\n       sum[rt << 1] = change[rt] * ln;\n       sum[rt << 1 | 1] = change[rt] * rn;\n       update[rt] = false;\n     }\n   }\n   ```\n\n5. \n\n   ```java\n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (update[rt]) {\n       update[rt << 1] = true;\n       update[rt << 1 | 1] = true;\n       change[rt << 1] = change[rt];\n       change[rt << 1 | 1] = change[rt];\n       lazy[rt << 1] = 0;\n       lazy[rt << 1 | 1] = 0;\n       sum[rt << 1] = change[rt] * ln;\n       sum[rt << 1 | 1] = change[rt] * rn;\n       update[rt] = false;\n     }\n     if (lazy[rt] != 0) {\n       lazy[rt << 1] += lazy[rt];\n       sum[rt << 1] += lazy[rt] * ln;\n       lazy[rt << 1 | 1] += lazy[rt];\n       sum[rt << 1 | 1] += lazy[rt] * rn;\n       lazy[rt] = 0;\n     }\n   }\n   ```\n\n6. `lr``l~r``sum`lazy addlazy update`sum`\n\n   ```java\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public long query(int L, int R, int l, int r, int rt) {\n     if (L <= l && r <= R) {\n       return sum[rt]; // sum\n     }\n     int mid = (l + r) >> 1;\n     pushDown(rt, mid - l + 1, r - mid); // \n     long ans = 0;\n     if (L <= mid) {\n       ans += query(L, R, l, mid, rt << 1);\n     }\n     if (R > mid) {\n       ans += query(L, R, mid + 1, r, rt << 1 | 1);\n     }\n     return ans;\n   }\n   ```\n\n#### \n\n```java\npublic class Code01_SegmentTree {\n\n\tpublic static class SegmentTree {\n\t\t\n\t\tprivate int MAXN;\n\t\tprivate int[] arr; // arr[]0arr1\n\t\tprivate int[] sum; // sum[]0\n\t\tprivate int[] lazy; // lazy[]\n\t\tprivate int[] change; // change[]\n\t\tprivate boolean[] update; // update[]\n\n\t\tpublic SegmentTree(int[] origin) {\n\t\t\tMAXN = origin.length + 1;\n\t\t\tarr = new int[MAXN]; // arr[0]   1\n\t\t\tfor (int i = 1; i < MAXN; i++) {\n\t\t\t\tarr[i] = origin[i - 1];\n\t\t\t}\n\t\t\tsum = new int[MAXN << 2]; // \n\t\t\tlazy = new int[MAXN << 2]; // \n\t\t\tchange = new int[MAXN << 2]; // \n\t\t\tupdate = new boolean[MAXN << 2]; // \n\t\t}\n\n\t\t/**\n\t\t * =+\n\t\t * @param rt\n\t\t */\n\t\tprivate void pushUp(int rt) {\n\t\t\tsum[rt] = sum[rt << 1] + sum[rt << 1 | 1];\n\t\t}\n\n\t\t// \n\t\t// lnrn\n\t\tprivate void pushDown(int rt, int ln, int rn) {\n\t\t\tif (update[rt]) {\n\t\t\t\tupdate[rt << 1] = true;\n\t\t\t\tupdate[rt << 1 | 1] = true;\n\t\t\t\tchange[rt << 1] = change[rt];\n\t\t\t\tchange[rt << 1 | 1] = change[rt];\n\t\t\t\tlazy[rt << 1] = 0;\n\t\t\t\tlazy[rt << 1 | 1] = 0;\n\t\t\t\tsum[rt << 1] = change[rt] * ln;\n\t\t\t\tsum[rt << 1 | 1] = change[rt] * rn;\n\t\t\t\tupdate[rt] = false;\n\t\t\t}\n\t\t\tif (lazy[rt] != 0) {\n\t\t\t\tlazy[rt << 1] += lazy[rt];\n\t\t\t\tsum[rt << 1] += lazy[rt] * ln;\n\t\t\t\tlazy[rt << 1 | 1] += lazy[rt];\n\t\t\t\tsum[rt << 1 | 1] += lazy[rt] * rn;\n\t\t\t\tlazy[rt] = 0;\n\t\t\t}\n\t\t}\n\n\t\t// sum\n\t\t// arr[l~r]build1~N(l: 1, r: origin.length)\n\t\t// rt :  sum\n\t\tpublic void build(int l, int r, int rt) {\n\t\t\tif (l == r) {\n\t\t\t\tsum[rt] = arr[l];\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tbuild(l, mid, rt << 1); //  2*rt\n\t\t\tbuild(mid + 1, r, rt << 1 | 1); //  2*rt + 1\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\t// L..R ->  ,C\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt  lr(root)\n\t\tpublic void add(int L, int R, int C,\n\t\t\t\t\t\tint l, int r,\n\t\t\t\t\t\tint rt) {\n\t\t\t// \n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tsum[rt] += C * (r - l + 1);\n\t\t\t\tlazy[rt] += C;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// \n\t\t\t//   L, R   l,r \n\t\t\tint mid = (l + r) >> 1;\n\t\t\t// \n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\t// \n\t\t\tif (L <= mid) {\n\t\t\t\tadd(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\t// \n\t\t\tif (R > mid) {\n\t\t\t\tadd(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\t// sum\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\t// L..R ->  ,C\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt  lr(root)\n\t\tpublic void update(int L, int R, int C, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tupdate[rt] = true;\n\t\t\t\tchange[rt] = C;\n\t\t\t\tsum[rt] = C * (r - l + 1);\n\t\t\t\tlazy[rt] = 0;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// \n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tif (L <= mid) {\n\t\t\t\tupdate(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\tpushUp(rt);\n\t\t}\n\t\t\n\t\t// L..R ->  ,\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt lr(root)\n\t\tpublic long query(int L, int R, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\treturn sum[rt];\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tlong ans = 0;\n\t\t\tif (L <= mid) {\n\t\t\t\tans += query(L, R, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tans += query(L, R, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\treturn ans;\n\t\t}\n\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic static class Right {\n\t\tpublic int[] arr;\n\n\t\tpublic Right(int[] origin) {\n\t\t\tarr = new int[origin.length + 1];\n\t\t\tfor (int i = 0; i < origin.length; i++) {\n\t\t\t\tarr[i + 1] = origin[i];\n\t\t\t}\n\t\t}\n\n\t\tpublic void update(int L, int R, int C) {\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tarr[i] = C;\n\t\t\t}\n\t\t}\n\n\t\tpublic void add(int L, int R, int C) {\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tarr[i] += C;\n\t\t\t}\n\t\t}\n\n\t\tpublic long query(int L, int R) {\n\t\t\tlong ans = 0;\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tans += arr[i];\n\t\t\t}\n\t\t\treturn ans;\n\t\t}\n\n\t}\n\n\tpublic static int[] genarateRandomArray(int len, int max) {\n\t\tint size = (int) (Math.random() * len) + 1;\n\t\tint[] origin = new int[size];\n\t\tfor (int i = 0; i < size; i++) {\n\t\t\torigin[i] = (int) (Math.random() * max) - (int) (Math.random() * max);\n\t\t}\n\t\treturn origin;\n\t}\n\n\t/**\n\t * \n\t * @return\n\t */\n\tpublic static boolean test() {\n\t\tint len = 100;\n\t\tint max = 1000;\n\t\tint testTimes = 5000;\n\t\tint addOrUpdateTimes = 1000;\n\t\tint queryTimes = 500;\n\t\tfor (int i = 0; i < testTimes; i++) {\n\t\t\tint[] origin = genarateRandomArray(len, max);\n\t\t\tSegmentTree seg = new SegmentTree(origin);\n\t\t\tint S = 1;\n\t\t\tint N = origin.length;\n\t\t\tint root = 1;\n\t\t\tseg.build(S, N, root);\n\t\t\tRight rig = new Right(origin);\n\t\t\tfor (int j = 0; j < addOrUpdateTimes; j++) {\n\t\t\t\tint num1 = (int) (Math.random() * N) + 1;\n\t\t\t\tint num2 = (int) (Math.random() * N) + 1;\n\t\t\t\tint L = Math.min(num1, num2);\n\t\t\t\tint R = Math.max(num1, num2);\n\t\t\t\tint C = (int) (Math.random() * max) - (int) (Math.random() * max);\n\t\t\t\tif (Math.random() < 0.5) {\n\t\t\t\t\tseg.add(L, R, C, S, N, root);\n\t\t\t\t\trig.add(L, R, C);\n\t\t\t\t} else {\n\t\t\t\t\tseg.update(L, R, C, S, N, root);\n\t\t\t\t\trig.update(L, R, C);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int k = 0; k < queryTimes; k++) {\n\t\t\t\tint num1 = (int) (Math.random() * N) + 1;\n\t\t\t\tint num2 = (int) (Math.random() * N) + 1;\n\t\t\t\tint L = Math.min(num1, num2);\n\t\t\t\tint R = Math.max(num1, num2);\n\t\t\t\tlong ans1 = seg.query(L, R, S, N, root);\n\t\t\t\tlong ans2 = rig.query(L, R);\n\t\t\t\tif (ans1 != ans2) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tint[] origin = { 2, 1, 1, 2, 3, 4, 5 };\n\t\tSegmentTree seg = new SegmentTree(origin);\n\t\tint S = 1; // 10 -> \n\t\tint N = origin.length; // NN-1 -> \n\t\tint root = 1; // 10 -> \n\t\tint L = 2; //  -> \n\t\tint R = 5; //  -> \n\t\tint C = 4; //  -> \n\t\t// [S,N]build\n\t\tseg.build(S, N, root);\n\t\t// LRC\n\t\tseg.add(L, R, C, S, N, root);\n\t\t// LRC\n\t\tseg.update(L, R, C, S, N, root);\n\t\t// LR\n\t\tlong sum = seg.query(L, R, S, N, root);\n\t\tSystem.out.println(sum);\n\n\t\tSystem.out.println(\"...\");\n\t\tSystem.out.println(\" : \" + (test() ? \"\" : \"\"));\n\t}\n\n}\n```\n\n\n\n### Falling Squares\n\n#### \n\n\t[leetcode 699. Falling Squares](https://leetcode.com/problems/falling-squares/ ) X\n\n\n\t1\n\t2[a,b] -> bX = a\n\t3X\n\t4\n\nN*2matrixN\n\n#### \n\n1. X(`[a, b]``x=a``b``[a, a+b-1]`X)\n2. `map``1`\n3. \n\n#### \n\n```java\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.TreeSet;\n\npublic class Code02_FallingSquares {\n\n\tpublic static class SegmentTree {\n\t\tprivate int[] max;\n\t\tprivate int[] change;\n\t\tprivate boolean[] update;\n\n\t\tpublic SegmentTree(int size) {\n\t\t\tint N = size + 1;\n\t\t\tmax = new int[N << 2];\n\t\t\tchange = new int[N << 2];\n\t\t\tupdate = new boolean[N << 2];\n\t\t}\n\n\t\tprivate void pushUp(int rt) {\n\t\t\tmax[rt] = Math.max(max[rt << 1], max[rt << 1 | 1]);\n\t\t}\n\n\t\t// lnrn\n\t\tprivate void pushDown(int rt, int ln, int rn) {\n\t\t\tif (update[rt]) {\n\t\t\t\tupdate[rt << 1] = true;\n\t\t\t\tupdate[rt << 1 | 1] = true;\n\t\t\t\tchange[rt << 1] = change[rt];\n\t\t\t\tchange[rt << 1 | 1] = change[rt];\n\t\t\t\tmax[rt << 1] = change[rt];\n\t\t\t\tmax[rt << 1 | 1] = change[rt];\n\t\t\t\tupdate[rt] = false;\n\t\t\t}\n\t\t}\n\n\t\tpublic void update(int L, int R, int C, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tupdate[rt] = true;\n\t\t\t\tchange[rt] = C;\n\t\t\t\tmax[rt] = C;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tif (L <= mid) {\n\t\t\t\tupdate(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\tpublic int query(int L, int R, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\treturn max[rt];\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tint left = 0;\n\t\t\tint right = 0;\n\t\t\tif (L <= mid) {\n\t\t\t\tleft = query(L, R, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tright = query(L, R, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\treturn Math.max(left, right);\n\t\t}\n\n\t}\n\n  // positions\n  // X([a, b]x=ab[a, a+b-1]X)\n  // [2, 7] -> 2, 8\n  // [3, 10] -> 3, 12\n\tpublic HashMap<Integer, Integer> index(int[][] positions) {\n\t\tTreeSet<Integer> pos = new TreeSet<>();\n\t\tfor (int[] arr : positions) {\n\t\t\tpos.add(arr[0]);\n\t\t\tpos.add(arr[0] + arr[1] - 1);\n\t\t}\n\t\tHashMap<Integer, Integer> map = new HashMap<>();\n\t\tint count = 0;\n\t\tfor (Integer index : pos) {\n\t\t\tmap.put(index, ++count);\n\t\t}\n\t\treturn map;\n\t}\n\n\tpublic List<Integer> fallingSquares(int[][] positions) {\n\t\tHashMap<Integer, Integer> map = index(positions);\n    // map1\n    // 100 -> 1   306 -> 2   403 -> 3\n    // [100, 403]   1 ~ 3\n\t\tint N = map.size(); // 1 ~ N\n\t\tSegmentTree segmentTree = new SegmentTree(N);\n\t\tint max = 0;\n\t\tList<Integer> res = new ArrayList<>();\n    // \n\t\tfor (int[] arr : positions) {\n\t\t\tint L = map.get(arr[0]);\n\t\t\tint R = map.get(arr[0] + arr[1] - 1);\n\t\t\tint height = segmentTree.query(L, R, 1, N, 1) + arr[1];\n\t\t\tmax = Math.max(max, height);\n\t\t\tres.add(max);\n\t\t\tsegmentTree.update(L, R, height, 1, N, 1);\n\t\t}\n\t\treturn res;\n\t}\n\n}\n```\n\n\n\n\n","source":"_posts/algorithm-segment-tree.md","raw":"---\ntitle: ---\ncatalog: true\nabbrlink: f82e\ndate: 2022-04-10 15:35:07\nsubtitle:\nheader-img: /img/header_img/post-bg-desk.jpg\ntop: 2\ntags:\n    - algorithm\n    - data structure\ncategories:\n    - work \n---\n\n# ---\n\n## \n\n\n\n## \n\n\n\n## \n\n### SegmentTree\n\n#### :\n\n\tarr\n\t1void add(int L, int R, int V) :  arr[LR]V\n\t2void update(int L, int R, int V) :  arr[LR]V\n\t3int sum(int L, int R) :arr[LR]\n\tO(logN)\n\n#### \n\n1. `origin``0``1``arr`\n\n   ```java\n   int MAXN = origin.length + 1;\n   arr = new int[MAXN]; // arr[0]   1\n   for (int i = 1; i < MAXN; i++) {\n   \tarr[i] = origin[i - 1];\n   }\n   ```\n\n2. `arr``sum``sum``4*MAXN``arr``2^n``2*MAXN`\n\n   `arr[x, 3, 2, 5, 7]sum[x, 17, 5, 12, 3, 2, 5, 7]` \n\n   \t\t\t\t\t\t\t\t\t\t\t\t\t\t\t`arr(1-4)``sum[1],` \n\n   \t\t\t\t\t\t\t\t\t\t`arr(1-2)``sum[2]``arr(3-4)``sum[3]`\n\n   `arr(1-1)``sum[4]``arr(2-2)``sum[5]``arr(3-3)``sum[6]``arr(4-4)``sum[7]`\n\n   ```java\n   int[] sum = new int[MAXN << 2];\n   \n   // \n   // arr[l~r]build1~N(l: 1, r: origin.length)\n   // rt :  sumroot\n   public void build(int l, int r, int rt) {\n     if (l == r) {\n       sum[rt] = arr[l];\n       return;\n     }\n     int mid = (l + r) >> 1;\n     build(l, mid, rt << 1); //  2*rt\n     build(mid + 1, r, rt << 1 | 1); //  2*rt + 1\n     pushUp(rt);\n   }\n   \n   /**\n    * =+\n    * @param rt\n    */\n   private void pushUp(int rt) {\n     sum[rt] = sum[rt << 1] + sum[rt << 1 | 1];\n   }\n   ```\n\n3. `lr``C``int[] lazy` `l~r`lazy add`sum``lazy`(`lazy[rt << 1] += lazy[rt];``sum`*lazy(`sum[rt << 1] += lazy[rt] * ln;`)`lazy``0`\n\n   ```java\n   // L..R ->  ,C\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public void add(int L, int R, int C,\n   \tint l, int r, \n   \tint rt) {\n     // \n     if (L <= l && r <= R) {\n       sum[rt] += C * (r - l + 1);\n       lazy[rt] += C;\n       return;\n     }\n     // \n     //   L, R   l,r \n     int mid = (l + r) >> 1;\n     // \n     pushDown(rt, mid - l + 1, r - mid);\n     // \n     if (L <= mid) {\n     \tadd(L, R, C, l, mid, rt << 1); // \n     }\n     // \n     if (R > mid) {\n     \tadd(L, R, C, mid + 1, r, rt << 1 | 1); // \n     }\n     // sum\n     pushUp(rt); // 2.\n   }\n   \n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (lazy[rt] != 0) {\n       lazy[rt << 1] += lazy[rt];\n       sum[rt << 1] += lazy[rt] * ln;\n       lazy[rt << 1 | 1] += lazy[rt];\n       sum[rt << 1 | 1] += lazy[rt] * rn;\n       lazy[rt] = 0;\n     }\n   }\n   ```\n\n4. `lr``C``int[] change``boolean[] update``l~r`lazy update`sum`update(`update[rt << 1] = true;change[rt << 1] = change[rt];``sum`*`update`(`sum[rt << 1] = change[rt] * ln;`)`lazy`0`update``false`\n\n   ```java\n   // L..R ->  ,C\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public void update(int L, int R, int C, int l, int r, int rt) {\n     if (L <= l && r <= R) {\n       update[rt] = true;\n       change[rt] = C;\n       sum[rt] = C * (r - l + 1);\n       lazy[rt] = 0;\n       return;\n     }\n     // \n     int mid = (l + r) >> 1;\n     pushDown(rt, mid - l + 1, r - mid);\n     if (L <= mid) {\n     \tupdate(L, R, C, l, mid, rt << 1);\n     }\n     if (R > mid) {\n     \tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n     }\n     pushUp(rt);\n   }\n   \n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (update[rt]) {\n       update[rt << 1] = true;\n       update[rt << 1 | 1] = true;\n       change[rt << 1] = change[rt];\n       change[rt << 1 | 1] = change[rt];\n       lazy[rt << 1] = 0;\n       lazy[rt << 1 | 1] = 0;\n       sum[rt << 1] = change[rt] * ln;\n       sum[rt << 1 | 1] = change[rt] * rn;\n       update[rt] = false;\n     }\n   }\n   ```\n\n5. \n\n   ```java\n   // \n   // lnrn\n   private void pushDown(int rt, int ln, int rn) {\n     if (update[rt]) {\n       update[rt << 1] = true;\n       update[rt << 1 | 1] = true;\n       change[rt << 1] = change[rt];\n       change[rt << 1 | 1] = change[rt];\n       lazy[rt << 1] = 0;\n       lazy[rt << 1 | 1] = 0;\n       sum[rt << 1] = change[rt] * ln;\n       sum[rt << 1 | 1] = change[rt] * rn;\n       update[rt] = false;\n     }\n     if (lazy[rt] != 0) {\n       lazy[rt << 1] += lazy[rt];\n       sum[rt << 1] += lazy[rt] * ln;\n       lazy[rt << 1 | 1] += lazy[rt];\n       sum[rt << 1 | 1] += lazy[rt] * rn;\n       lazy[rt] = 0;\n     }\n   }\n   ```\n\n6. `lr``l~r``sum`lazy addlazy update`sum`\n\n   ```java\n   // l,r -> (l: 1, r: origin.length)\n   // rt  lrroot\n   public long query(int L, int R, int l, int r, int rt) {\n     if (L <= l && r <= R) {\n       return sum[rt]; // sum\n     }\n     int mid = (l + r) >> 1;\n     pushDown(rt, mid - l + 1, r - mid); // \n     long ans = 0;\n     if (L <= mid) {\n       ans += query(L, R, l, mid, rt << 1);\n     }\n     if (R > mid) {\n       ans += query(L, R, mid + 1, r, rt << 1 | 1);\n     }\n     return ans;\n   }\n   ```\n\n#### \n\n```java\npublic class Code01_SegmentTree {\n\n\tpublic static class SegmentTree {\n\t\t\n\t\tprivate int MAXN;\n\t\tprivate int[] arr; // arr[]0arr1\n\t\tprivate int[] sum; // sum[]0\n\t\tprivate int[] lazy; // lazy[]\n\t\tprivate int[] change; // change[]\n\t\tprivate boolean[] update; // update[]\n\n\t\tpublic SegmentTree(int[] origin) {\n\t\t\tMAXN = origin.length + 1;\n\t\t\tarr = new int[MAXN]; // arr[0]   1\n\t\t\tfor (int i = 1; i < MAXN; i++) {\n\t\t\t\tarr[i] = origin[i - 1];\n\t\t\t}\n\t\t\tsum = new int[MAXN << 2]; // \n\t\t\tlazy = new int[MAXN << 2]; // \n\t\t\tchange = new int[MAXN << 2]; // \n\t\t\tupdate = new boolean[MAXN << 2]; // \n\t\t}\n\n\t\t/**\n\t\t * =+\n\t\t * @param rt\n\t\t */\n\t\tprivate void pushUp(int rt) {\n\t\t\tsum[rt] = sum[rt << 1] + sum[rt << 1 | 1];\n\t\t}\n\n\t\t// \n\t\t// lnrn\n\t\tprivate void pushDown(int rt, int ln, int rn) {\n\t\t\tif (update[rt]) {\n\t\t\t\tupdate[rt << 1] = true;\n\t\t\t\tupdate[rt << 1 | 1] = true;\n\t\t\t\tchange[rt << 1] = change[rt];\n\t\t\t\tchange[rt << 1 | 1] = change[rt];\n\t\t\t\tlazy[rt << 1] = 0;\n\t\t\t\tlazy[rt << 1 | 1] = 0;\n\t\t\t\tsum[rt << 1] = change[rt] * ln;\n\t\t\t\tsum[rt << 1 | 1] = change[rt] * rn;\n\t\t\t\tupdate[rt] = false;\n\t\t\t}\n\t\t\tif (lazy[rt] != 0) {\n\t\t\t\tlazy[rt << 1] += lazy[rt];\n\t\t\t\tsum[rt << 1] += lazy[rt] * ln;\n\t\t\t\tlazy[rt << 1 | 1] += lazy[rt];\n\t\t\t\tsum[rt << 1 | 1] += lazy[rt] * rn;\n\t\t\t\tlazy[rt] = 0;\n\t\t\t}\n\t\t}\n\n\t\t// sum\n\t\t// arr[l~r]build1~N(l: 1, r: origin.length)\n\t\t// rt :  sum\n\t\tpublic void build(int l, int r, int rt) {\n\t\t\tif (l == r) {\n\t\t\t\tsum[rt] = arr[l];\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tbuild(l, mid, rt << 1); //  2*rt\n\t\t\tbuild(mid + 1, r, rt << 1 | 1); //  2*rt + 1\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\t// L..R ->  ,C\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt  lr(root)\n\t\tpublic void add(int L, int R, int C,\n\t\t\t\t\t\tint l, int r,\n\t\t\t\t\t\tint rt) {\n\t\t\t// \n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tsum[rt] += C * (r - l + 1);\n\t\t\t\tlazy[rt] += C;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// \n\t\t\t//   L, R   l,r \n\t\t\tint mid = (l + r) >> 1;\n\t\t\t// \n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\t// \n\t\t\tif (L <= mid) {\n\t\t\t\tadd(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\t// \n\t\t\tif (R > mid) {\n\t\t\t\tadd(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\t// sum\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\t// L..R ->  ,C\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt  lr(root)\n\t\tpublic void update(int L, int R, int C, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tupdate[rt] = true;\n\t\t\t\tchange[rt] = C;\n\t\t\t\tsum[rt] = C * (r - l + 1);\n\t\t\t\tlazy[rt] = 0;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\t// \n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tif (L <= mid) {\n\t\t\t\tupdate(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\tpushUp(rt);\n\t\t}\n\t\t\n\t\t// L..R ->  ,\n\t\t// l,r -> (l: 1, r: origin.length)\n\t\t// rt lr(root)\n\t\tpublic long query(int L, int R, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\treturn sum[rt];\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tlong ans = 0;\n\t\t\tif (L <= mid) {\n\t\t\t\tans += query(L, R, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tans += query(L, R, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\treturn ans;\n\t\t}\n\n\t}\n\n\t/**\n\t * \n\t */\n\tpublic static class Right {\n\t\tpublic int[] arr;\n\n\t\tpublic Right(int[] origin) {\n\t\t\tarr = new int[origin.length + 1];\n\t\t\tfor (int i = 0; i < origin.length; i++) {\n\t\t\t\tarr[i + 1] = origin[i];\n\t\t\t}\n\t\t}\n\n\t\tpublic void update(int L, int R, int C) {\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tarr[i] = C;\n\t\t\t}\n\t\t}\n\n\t\tpublic void add(int L, int R, int C) {\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tarr[i] += C;\n\t\t\t}\n\t\t}\n\n\t\tpublic long query(int L, int R) {\n\t\t\tlong ans = 0;\n\t\t\tfor (int i = L; i <= R; i++) {\n\t\t\t\tans += arr[i];\n\t\t\t}\n\t\t\treturn ans;\n\t\t}\n\n\t}\n\n\tpublic static int[] genarateRandomArray(int len, int max) {\n\t\tint size = (int) (Math.random() * len) + 1;\n\t\tint[] origin = new int[size];\n\t\tfor (int i = 0; i < size; i++) {\n\t\t\torigin[i] = (int) (Math.random() * max) - (int) (Math.random() * max);\n\t\t}\n\t\treturn origin;\n\t}\n\n\t/**\n\t * \n\t * @return\n\t */\n\tpublic static boolean test() {\n\t\tint len = 100;\n\t\tint max = 1000;\n\t\tint testTimes = 5000;\n\t\tint addOrUpdateTimes = 1000;\n\t\tint queryTimes = 500;\n\t\tfor (int i = 0; i < testTimes; i++) {\n\t\t\tint[] origin = genarateRandomArray(len, max);\n\t\t\tSegmentTree seg = new SegmentTree(origin);\n\t\t\tint S = 1;\n\t\t\tint N = origin.length;\n\t\t\tint root = 1;\n\t\t\tseg.build(S, N, root);\n\t\t\tRight rig = new Right(origin);\n\t\t\tfor (int j = 0; j < addOrUpdateTimes; j++) {\n\t\t\t\tint num1 = (int) (Math.random() * N) + 1;\n\t\t\t\tint num2 = (int) (Math.random() * N) + 1;\n\t\t\t\tint L = Math.min(num1, num2);\n\t\t\t\tint R = Math.max(num1, num2);\n\t\t\t\tint C = (int) (Math.random() * max) - (int) (Math.random() * max);\n\t\t\t\tif (Math.random() < 0.5) {\n\t\t\t\t\tseg.add(L, R, C, S, N, root);\n\t\t\t\t\trig.add(L, R, C);\n\t\t\t\t} else {\n\t\t\t\t\tseg.update(L, R, C, S, N, root);\n\t\t\t\t\trig.update(L, R, C);\n\t\t\t\t}\n\t\t\t}\n\t\t\tfor (int k = 0; k < queryTimes; k++) {\n\t\t\t\tint num1 = (int) (Math.random() * N) + 1;\n\t\t\t\tint num2 = (int) (Math.random() * N) + 1;\n\t\t\t\tint L = Math.min(num1, num2);\n\t\t\t\tint R = Math.max(num1, num2);\n\t\t\t\tlong ans1 = seg.query(L, R, S, N, root);\n\t\t\t\tlong ans2 = rig.query(L, R);\n\t\t\t\tif (ans1 != ans2) {\n\t\t\t\t\treturn false;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn true;\n\t}\n\n\tpublic static void main(String[] args) {\n\t\tint[] origin = { 2, 1, 1, 2, 3, 4, 5 };\n\t\tSegmentTree seg = new SegmentTree(origin);\n\t\tint S = 1; // 10 -> \n\t\tint N = origin.length; // NN-1 -> \n\t\tint root = 1; // 10 -> \n\t\tint L = 2; //  -> \n\t\tint R = 5; //  -> \n\t\tint C = 4; //  -> \n\t\t// [S,N]build\n\t\tseg.build(S, N, root);\n\t\t// LRC\n\t\tseg.add(L, R, C, S, N, root);\n\t\t// LRC\n\t\tseg.update(L, R, C, S, N, root);\n\t\t// LR\n\t\tlong sum = seg.query(L, R, S, N, root);\n\t\tSystem.out.println(sum);\n\n\t\tSystem.out.println(\"...\");\n\t\tSystem.out.println(\" : \" + (test() ? \"\" : \"\"));\n\t}\n\n}\n```\n\n\n\n### Falling Squares\n\n#### \n\n\t[leetcode 699. Falling Squares](https://leetcode.com/problems/falling-squares/ ) X\n\n\n\t1\n\t2[a,b] -> bX = a\n\t3X\n\t4\n\nN*2matrixN\n\n#### \n\n1. X(`[a, b]``x=a``b``[a, a+b-1]`X)\n2. `map``1`\n3. \n\n#### \n\n```java\nimport java.util.ArrayList;\nimport java.util.HashMap;\nimport java.util.List;\nimport java.util.TreeSet;\n\npublic class Code02_FallingSquares {\n\n\tpublic static class SegmentTree {\n\t\tprivate int[] max;\n\t\tprivate int[] change;\n\t\tprivate boolean[] update;\n\n\t\tpublic SegmentTree(int size) {\n\t\t\tint N = size + 1;\n\t\t\tmax = new int[N << 2];\n\t\t\tchange = new int[N << 2];\n\t\t\tupdate = new boolean[N << 2];\n\t\t}\n\n\t\tprivate void pushUp(int rt) {\n\t\t\tmax[rt] = Math.max(max[rt << 1], max[rt << 1 | 1]);\n\t\t}\n\n\t\t// lnrn\n\t\tprivate void pushDown(int rt, int ln, int rn) {\n\t\t\tif (update[rt]) {\n\t\t\t\tupdate[rt << 1] = true;\n\t\t\t\tupdate[rt << 1 | 1] = true;\n\t\t\t\tchange[rt << 1] = change[rt];\n\t\t\t\tchange[rt << 1 | 1] = change[rt];\n\t\t\t\tmax[rt << 1] = change[rt];\n\t\t\t\tmax[rt << 1 | 1] = change[rt];\n\t\t\t\tupdate[rt] = false;\n\t\t\t}\n\t\t}\n\n\t\tpublic void update(int L, int R, int C, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\tupdate[rt] = true;\n\t\t\t\tchange[rt] = C;\n\t\t\t\tmax[rt] = C;\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tif (L <= mid) {\n\t\t\t\tupdate(L, R, C, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tupdate(L, R, C, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\tpushUp(rt);\n\t\t}\n\n\t\tpublic int query(int L, int R, int l, int r, int rt) {\n\t\t\tif (L <= l && r <= R) {\n\t\t\t\treturn max[rt];\n\t\t\t}\n\t\t\tint mid = (l + r) >> 1;\n\t\t\tpushDown(rt, mid - l + 1, r - mid);\n\t\t\tint left = 0;\n\t\t\tint right = 0;\n\t\t\tif (L <= mid) {\n\t\t\t\tleft = query(L, R, l, mid, rt << 1);\n\t\t\t}\n\t\t\tif (R > mid) {\n\t\t\t\tright = query(L, R, mid + 1, r, rt << 1 | 1);\n\t\t\t}\n\t\t\treturn Math.max(left, right);\n\t\t}\n\n\t}\n\n  // positions\n  // X([a, b]x=ab[a, a+b-1]X)\n  // [2, 7] -> 2, 8\n  // [3, 10] -> 3, 12\n\tpublic HashMap<Integer, Integer> index(int[][] positions) {\n\t\tTreeSet<Integer> pos = new TreeSet<>();\n\t\tfor (int[] arr : positions) {\n\t\t\tpos.add(arr[0]);\n\t\t\tpos.add(arr[0] + arr[1] - 1);\n\t\t}\n\t\tHashMap<Integer, Integer> map = new HashMap<>();\n\t\tint count = 0;\n\t\tfor (Integer index : pos) {\n\t\t\tmap.put(index, ++count);\n\t\t}\n\t\treturn map;\n\t}\n\n\tpublic List<Integer> fallingSquares(int[][] positions) {\n\t\tHashMap<Integer, Integer> map = index(positions);\n    // map1\n    // 100 -> 1   306 -> 2   403 -> 3\n    // [100, 403]   1 ~ 3\n\t\tint N = map.size(); // 1 ~ N\n\t\tSegmentTree segmentTree = new SegmentTree(N);\n\t\tint max = 0;\n\t\tList<Integer> res = new ArrayList<>();\n    // \n\t\tfor (int[] arr : positions) {\n\t\t\tint L = map.get(arr[0]);\n\t\t\tint R = map.get(arr[0] + arr[1] - 1);\n\t\t\tint height = segmentTree.query(L, R, 1, N, 1) + arr[1];\n\t\t\tmax = Math.max(max, height);\n\t\t\tres.add(max);\n\t\t\tsegmentTree.update(L, R, height, 1, N, 1);\n\t\t}\n\t\treturn res;\n\t}\n\n}\n```\n\n\n\n\n","slug":"algorithm-segment-tree","published":1,"updated":"2022-04-23T07:45:59.865Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweef000bkh6z2prkczq1","content":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"SegmentTree\"><a href=\"#SegmentTree\" class=\"headerlink\" title=\"SegmentTree\"></a>SegmentTree</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h4><p>    arr<br>    1void add(int L, int R, int V) :  arr[LR]V<br>    2void update(int L, int R, int V) :  arr[LR]V<br>    3int sum(int L, int R) :arr[LR]<br>    O(logN)</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p><code>origin</code><code>0</code><code>1</code><code>arr</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> MAXN = origin.length + <span class=\"number\">1</span>;</span><br><span class=\"line\">arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN]; <span class=\"comment\">// arr[0]   1</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; MAXN; i++) &#123;</span><br><span class=\"line\">\tarr[i] = origin[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>arr</code><code>sum</code><code>sum</code><code>4*MAXN</code><code>arr</code><code>2^n</code><code>2*MAXN</code></p>\n<p><code>arr[x, 3, 2, 5, 7]sum[x, 17, 5, 12, 3, 2, 5, 7]</code> </p>\n<p>                                                            <code>arr(1-4)</code><code>sum[1],</code> </p>\n<p>                                        <code>arr(1-2)</code><code>sum[2]</code><code>arr(3-4)</code><code>sum[3]</code></p>\n<p><code>arr(1-1)</code><code>sum[4]</code><code>arr(2-2)</code><code>sum[5]</code><code>arr(3-3)</code><code>sum[6]</code><code>arr(4-4)</code><code>sum[7]</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span>[] sum = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// arr[l~r]build1~N(l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt :  sumroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (l == r) &#123;</span><br><span class=\"line\">    sum[rt] = arr[l];</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  build(l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt</span></span><br><span class=\"line\">  build(mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt + 1</span></span><br><span class=\"line\">  pushUp(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * =+</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> rt</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  sum[rt] = sum[rt &lt;&lt; <span class=\"number\">1</span>] + sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>C</code><code>int[] lazy</code> <code>l~r</code>lazy add<code>sum</code><code>lazy</code>(<code>lazy[rt &lt;&lt; 1] += lazy[rt];</code><code>sum</code>*lazy(<code>sum[rt &lt;&lt; 1] += lazy[rt] * ln;</code>)<code>lazy</code><code>0</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    sum[rt] += C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">    lazy[rt] += C;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"comment\">//   L, R   l,r </span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">  \tadd(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">  \tadd(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// sum</span></span><br><span class=\"line\">  pushUp(rt); <span class=\"comment\">// 2.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>C</code><code>int[] change</code><code>boolean[] update</code><code>l~r</code>lazy update<code>sum</code>update(<code>update[rt &lt;&lt; 1] = true;change[rt &lt;&lt; 1] = change[rt];</code><code>sum</code>*<code>update</code>(<code>sum[rt &lt;&lt; 1] = change[rt] * ln;</code>)<code>lazy</code>0<code>update</code><code>false</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt] = C;</span><br><span class=\"line\">    sum[rt] = C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">  \tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">  \tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  pushUp(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>l~r</code><code>sum</code>lazy addlazy update<code>sum</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum[rt]; <span class=\"comment\">// sum</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid); <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">    ans += query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">    ans += query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Code01_SegmentTree</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SegmentTree</span> </span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> MAXN;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] arr; <span class=\"comment\">// arr[]0arr1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] sum; <span class=\"comment\">// sum[]0</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] lazy; <span class=\"comment\">// lazy[]</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] change; <span class=\"comment\">// change[]</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>[] update; <span class=\"comment\">// update[]</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SegmentTree</span><span class=\"params\">(<span class=\"keyword\">int</span>[] origin)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tMAXN = origin.length + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tarr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN]; <span class=\"comment\">// arr[0]   1</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; MAXN; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] = origin[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tsum = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tlazy = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tchange = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tupdate = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t\t * =+</span></span><br><span class=\"line\"><span class=\"comment\">\t\t * <span class=\"doctag\">@param</span> rt</span></span><br><span class=\"line\"><span class=\"comment\">\t\t */</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tsum[rt] = sum[rt &lt;&lt; <span class=\"number\">1</span>] + sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// lnrn</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">\t\t\t\tlazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// sum</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// arr[l~r]build1~N(l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt :  sum</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (l == r) &#123;</span><br><span class=\"line\">\t\t\t\tsum[rt] = arr[l];</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tbuild(l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt</span></span><br><span class=\"line\">\t\t\tbuild(mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt + 1</span></span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt  lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\t\t\t\t\t<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\t\t\t\t\t<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tsum[rt] += C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\tlazy[rt] += C;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">//   L, R   l,r </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tadd(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tadd(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// sum</span></span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt  lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt] = C;</span><br><span class=\"line\">\t\t\t\tsum[rt] = C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\tlazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> sum[rt];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tans += query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tans += query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Right</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] arr;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Right</span><span class=\"params\">(<span class=\"keyword\">int</span>[] origin)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tarr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[origin.length + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; origin.length; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i + <span class=\"number\">1</span>] = origin[i];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] = C;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] += C;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tans += arr[i];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] genarateRandomArray(<span class=\"keyword\">int</span> len, <span class=\"keyword\">int</span> max) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> size = (<span class=\"keyword\">int</span>) (Math.random() * len) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] origin = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[size];</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; size; i++) &#123;</span><br><span class=\"line\">\t\t\torigin[i] = (<span class=\"keyword\">int</span>) (Math.random() * max) - (<span class=\"keyword\">int</span>) (Math.random() * max);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> origin;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> len = <span class=\"number\">100</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> max = <span class=\"number\">1000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> testTimes = <span class=\"number\">5000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> addOrUpdateTimes = <span class=\"number\">1000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> queryTimes = <span class=\"number\">500</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; testTimes; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span>[] origin = genarateRandomArray(len, max);</span><br><span class=\"line\">\t\t\tSegmentTree seg = <span class=\"keyword\">new</span> SegmentTree(origin);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> S = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> N = origin.length;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> root = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tseg.build(S, N, root);</span><br><span class=\"line\">\t\t\tRight rig = <span class=\"keyword\">new</span> Right(origin);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; addOrUpdateTimes; j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num1 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num2 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> L = Math.min(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> R = Math.max(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> C = (<span class=\"keyword\">int</span>) (Math.random() * max) - (<span class=\"keyword\">int</span>) (Math.random() * max);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (Math.random() &lt; <span class=\"number\">0.5</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tseg.add(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t\t\t\trig.add(L, R, C);</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t\tseg.update(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t\t\t\trig.update(L, R, C);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; queryTimes; k++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num1 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num2 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> L = Math.min(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> R = Math.max(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">long</span> ans1 = seg.query(L, R, S, N, root);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">long</span> ans2 = rig.query(L, R);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (ans1 != ans2) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] origin = &#123; <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">\t\tSegmentTree seg = <span class=\"keyword\">new</span> SegmentTree(origin);</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> S = <span class=\"number\">1</span>; <span class=\"comment\">// 10 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> N = origin.length; <span class=\"comment\">// NN-1 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> root = <span class=\"number\">1</span>; <span class=\"comment\">// 10 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> L = <span class=\"number\">2</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> R = <span class=\"number\">5</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> C = <span class=\"number\">4</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// [S,N]build</span></span><br><span class=\"line\">\t\tseg.build(S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LRC</span></span><br><span class=\"line\">\t\tseg.add(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LRC</span></span><br><span class=\"line\">\t\tseg.update(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LR</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">long</span> sum = seg.query(L, R, S, N, root);</span><br><span class=\"line\">\t\tSystem.out.println(sum);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"...\"</span>);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\" : \"</span> + (test() ? <span class=\"string\">\"\"</span> : <span class=\"string\">\"\"</span>));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"Falling-Squares\"><a href=\"#Falling-Squares\" class=\"headerlink\" title=\"Falling Squares\"></a>Falling Squares</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>    <a href=\"https://leetcode.com/problems/falling-squares/\" target=\"_blank\" rel=\"noopener\">leetcode 699. Falling Squares</a> X</p>\n<p><br>    1<br>    2[a,b] -&gt; bX = a<br>    3X<br>    4</p>\n<p>N*2matrixN</p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>X(<code>[a, b]</code><code>x=a</code><code>b</code><code>[a, a+b-1]</code>X)</li>\n<li><code>map</code><code>1</code></li>\n<li></li>\n</ol>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.TreeSet;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Code02_FallingSquares</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SegmentTree</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] max;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] change;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>[] update;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SegmentTree</span><span class=\"params\">(<span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> N = size + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tmax = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t\tchange = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t\tupdate = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tmax[rt] = Math.max(max[rt &lt;&lt; <span class=\"number\">1</span>], max[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// lnrn</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tmax[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tmax[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt] = C;</span><br><span class=\"line\">\t\t\t\tmax[rt] = C;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> max[rt];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> left = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> right = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tleft = query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tright = query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> Math.max(left, right);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// positions</span></span><br><span class=\"line\">  <span class=\"comment\">// X([a, b]x=ab[a, a+b-1]X)</span></span><br><span class=\"line\">  <span class=\"comment\">// [2, 7] -&gt; 2, 8</span></span><br><span class=\"line\">  <span class=\"comment\">// [3, 10] -&gt; 3, 12</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> HashMap&lt;Integer, Integer&gt; <span class=\"title\">index</span><span class=\"params\">(<span class=\"keyword\">int</span>[][] positions)</span> </span>&#123;</span><br><span class=\"line\">\t\tTreeSet&lt;Integer&gt; pos = <span class=\"keyword\">new</span> TreeSet&lt;&gt;();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span>[] arr : positions) &#123;</span><br><span class=\"line\">\t\t\tpos.add(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\t\tpos.add(arr[<span class=\"number\">0</span>] + arr[<span class=\"number\">1</span>] - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tHashMap&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (Integer index : pos) &#123;</span><br><span class=\"line\">\t\t\tmap.put(index, ++count);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> map;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">fallingSquares</span><span class=\"params\">(<span class=\"keyword\">int</span>[][] positions)</span> </span>&#123;</span><br><span class=\"line\">\t\tHashMap&lt;Integer, Integer&gt; map = index(positions);</span><br><span class=\"line\">    <span class=\"comment\">// map1</span></span><br><span class=\"line\">    <span class=\"comment\">// 100 -&gt; 1   306 -&gt; 2   403 -&gt; 3</span></span><br><span class=\"line\">    <span class=\"comment\">// [100, 403]   1 ~ 3</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> N = map.size(); <span class=\"comment\">// 1 ~ N</span></span><br><span class=\"line\">\t\tSegmentTree segmentTree = <span class=\"keyword\">new</span> SegmentTree(N);</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> max = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tList&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span>[] arr : positions) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> L = map.get(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> R = map.get(arr[<span class=\"number\">0</span>] + arr[<span class=\"number\">1</span>] - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> height = segmentTree.query(L, R, <span class=\"number\">1</span>, N, <span class=\"number\">1</span>) + arr[<span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\tmax = Math.max(max, height);</span><br><span class=\"line\">\t\t\tres.add(max);</span><br><span class=\"line\">\t\t\tsegmentTree.update(L, R, height, <span class=\"number\">1</span>, N, <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h1 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h1><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><p></p>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"SegmentTree\"><a href=\"#SegmentTree\" class=\"headerlink\" title=\"SegmentTree\"></a>SegmentTree</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\":\"></a>:</h4><p>    arr<br>    1void add(int L, int R, int V) :  arr[LR]V<br>    2void update(int L, int R, int V) :  arr[LR]V<br>    3int sum(int L, int R) :arr[LR]<br>    O(logN)</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p><code>origin</code><code>0</code><code>1</code><code>arr</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> MAXN = origin.length + <span class=\"number\">1</span>;</span><br><span class=\"line\">arr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN]; <span class=\"comment\">// arr[0]   1</span></span><br><span class=\"line\"><span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; MAXN; i++) &#123;</span><br><span class=\"line\">\tarr[i] = origin[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>arr</code><code>sum</code><code>sum</code><code>4*MAXN</code><code>arr</code><code>2^n</code><code>2*MAXN</code></p>\n<p><code>arr[x, 3, 2, 5, 7]sum[x, 17, 5, 12, 3, 2, 5, 7]</code> </p>\n<p>                                                            <code>arr(1-4)</code><code>sum[1],</code> </p>\n<p>                                        <code>arr(1-2)</code><code>sum[2]</code><code>arr(3-4)</code><code>sum[3]</code></p>\n<p><code>arr(1-1)</code><code>sum[4]</code><code>arr(2-2)</code><code>sum[5]</code><code>arr(3-3)</code><code>sum[6]</code><code>arr(4-4)</code><code>sum[7]</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span>[] sum = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// arr[l~r]build1~N(l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt :  sumroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (l == r) &#123;</span><br><span class=\"line\">    sum[rt] = arr[l];</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  build(l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt</span></span><br><span class=\"line\">  build(mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt + 1</span></span><br><span class=\"line\">  pushUp(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * =+</span></span><br><span class=\"line\"><span class=\"comment\"> * <span class=\"doctag\">@param</span> rt</span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  sum[rt] = sum[rt &lt;&lt; <span class=\"number\">1</span>] + sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>];</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>C</code><code>int[] lazy</code> <code>l~r</code>lazy add<code>sum</code><code>lazy</code>(<code>lazy[rt &lt;&lt; 1] += lazy[rt];</code><code>sum</code>*lazy(<code>sum[rt &lt;&lt; 1] += lazy[rt] * ln;</code>)<code>lazy</code><code>0</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, </span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    sum[rt] += C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">    lazy[rt] += C;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"comment\">//   L, R   l,r </span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">  \tadd(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">  \tadd(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">// </span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// sum</span></span><br><span class=\"line\">  pushUp(rt); <span class=\"comment\">// 2.</span></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>C</code><code>int[] change</code><code>boolean[] update</code><code>l~r</code>lazy update<code>sum</code>update(<code>update[rt &lt;&lt; 1] = true;change[rt &lt;&lt; 1] = change[rt];</code><code>sum</code>*<code>update</code>(<code>sum[rt &lt;&lt; 1] = change[rt] * ln;</code>)<code>lazy</code>0<code>update</code><code>false</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt] = C;</span><br><span class=\"line\">    sum[rt] = C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">  \tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">  \tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  pushUp(rt);</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"comment\">// lnrn</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    update[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    change[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">    update[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">    lazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">    sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">    lazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><code>lr</code><code>l~r</code><code>sum</code>lazy addlazy update<code>sum</code></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\"><span class=\"comment\">// rt  lrroot</span></span><br><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> sum[rt]; <span class=\"comment\">// sum</span></span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">  pushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid); <span class=\"comment\">// </span></span><br><span class=\"line\">  <span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">    ans += query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">    ans += query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">  &#125;</span><br><span class=\"line\">  <span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br><span class=\"line\">114</span><br><span class=\"line\">115</span><br><span class=\"line\">116</span><br><span class=\"line\">117</span><br><span class=\"line\">118</span><br><span class=\"line\">119</span><br><span class=\"line\">120</span><br><span class=\"line\">121</span><br><span class=\"line\">122</span><br><span class=\"line\">123</span><br><span class=\"line\">124</span><br><span class=\"line\">125</span><br><span class=\"line\">126</span><br><span class=\"line\">127</span><br><span class=\"line\">128</span><br><span class=\"line\">129</span><br><span class=\"line\">130</span><br><span class=\"line\">131</span><br><span class=\"line\">132</span><br><span class=\"line\">133</span><br><span class=\"line\">134</span><br><span class=\"line\">135</span><br><span class=\"line\">136</span><br><span class=\"line\">137</span><br><span class=\"line\">138</span><br><span class=\"line\">139</span><br><span class=\"line\">140</span><br><span class=\"line\">141</span><br><span class=\"line\">142</span><br><span class=\"line\">143</span><br><span class=\"line\">144</span><br><span class=\"line\">145</span><br><span class=\"line\">146</span><br><span class=\"line\">147</span><br><span class=\"line\">148</span><br><span class=\"line\">149</span><br><span class=\"line\">150</span><br><span class=\"line\">151</span><br><span class=\"line\">152</span><br><span class=\"line\">153</span><br><span class=\"line\">154</span><br><span class=\"line\">155</span><br><span class=\"line\">156</span><br><span class=\"line\">157</span><br><span class=\"line\">158</span><br><span class=\"line\">159</span><br><span class=\"line\">160</span><br><span class=\"line\">161</span><br><span class=\"line\">162</span><br><span class=\"line\">163</span><br><span class=\"line\">164</span><br><span class=\"line\">165</span><br><span class=\"line\">166</span><br><span class=\"line\">167</span><br><span class=\"line\">168</span><br><span class=\"line\">169</span><br><span class=\"line\">170</span><br><span class=\"line\">171</span><br><span class=\"line\">172</span><br><span class=\"line\">173</span><br><span class=\"line\">174</span><br><span class=\"line\">175</span><br><span class=\"line\">176</span><br><span class=\"line\">177</span><br><span class=\"line\">178</span><br><span class=\"line\">179</span><br><span class=\"line\">180</span><br><span class=\"line\">181</span><br><span class=\"line\">182</span><br><span class=\"line\">183</span><br><span class=\"line\">184</span><br><span class=\"line\">185</span><br><span class=\"line\">186</span><br><span class=\"line\">187</span><br><span class=\"line\">188</span><br><span class=\"line\">189</span><br><span class=\"line\">190</span><br><span class=\"line\">191</span><br><span class=\"line\">192</span><br><span class=\"line\">193</span><br><span class=\"line\">194</span><br><span class=\"line\">195</span><br><span class=\"line\">196</span><br><span class=\"line\">197</span><br><span class=\"line\">198</span><br><span class=\"line\">199</span><br><span class=\"line\">200</span><br><span class=\"line\">201</span><br><span class=\"line\">202</span><br><span class=\"line\">203</span><br><span class=\"line\">204</span><br><span class=\"line\">205</span><br><span class=\"line\">206</span><br><span class=\"line\">207</span><br><span class=\"line\">208</span><br><span class=\"line\">209</span><br><span class=\"line\">210</span><br><span class=\"line\">211</span><br><span class=\"line\">212</span><br><span class=\"line\">213</span><br><span class=\"line\">214</span><br><span class=\"line\">215</span><br><span class=\"line\">216</span><br><span class=\"line\">217</span><br><span class=\"line\">218</span><br><span class=\"line\">219</span><br><span class=\"line\">220</span><br><span class=\"line\">221</span><br><span class=\"line\">222</span><br><span class=\"line\">223</span><br><span class=\"line\">224</span><br><span class=\"line\">225</span><br><span class=\"line\">226</span><br><span class=\"line\">227</span><br><span class=\"line\">228</span><br><span class=\"line\">229</span><br><span class=\"line\">230</span><br><span class=\"line\">231</span><br><span class=\"line\">232</span><br><span class=\"line\">233</span><br><span class=\"line\">234</span><br><span class=\"line\">235</span><br><span class=\"line\">236</span><br><span class=\"line\">237</span><br><span class=\"line\">238</span><br><span class=\"line\">239</span><br><span class=\"line\">240</span><br><span class=\"line\">241</span><br><span class=\"line\">242</span><br><span class=\"line\">243</span><br><span class=\"line\">244</span><br><span class=\"line\">245</span><br><span class=\"line\">246</span><br><span class=\"line\">247</span><br><span class=\"line\">248</span><br><span class=\"line\">249</span><br><span class=\"line\">250</span><br><span class=\"line\">251</span><br><span class=\"line\">252</span><br><span class=\"line\">253</span><br><span class=\"line\">254</span><br><span class=\"line\">255</span><br><span class=\"line\">256</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Code01_SegmentTree</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SegmentTree</span> </span>&#123;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span> MAXN;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] arr; <span class=\"comment\">// arr[]0arr1</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] sum; <span class=\"comment\">// sum[]0</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] lazy; <span class=\"comment\">// lazy[]</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] change; <span class=\"comment\">// change[]</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>[] update; <span class=\"comment\">// update[]</span></span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SegmentTree</span><span class=\"params\">(<span class=\"keyword\">int</span>[] origin)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tMAXN = origin.length + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tarr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN]; <span class=\"comment\">// arr[0]   1</span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">1</span>; i &lt; MAXN; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] = origin[i - <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tsum = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tlazy = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tchange = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tupdate = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[MAXN &lt;&lt; <span class=\"number\">2</span>]; <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t\t * =+</span></span><br><span class=\"line\"><span class=\"comment\">\t\t * <span class=\"doctag\">@param</span> rt</span></span><br><span class=\"line\"><span class=\"comment\">\t\t */</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tsum[rt] = sum[rt &lt;&lt; <span class=\"number\">1</span>] + sum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// lnrn</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt] * ln;</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt] * rn;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (lazy[rt] != <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span>] += lazy[rt] * ln;</span><br><span class=\"line\">\t\t\t\tlazy[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt];</span><br><span class=\"line\">\t\t\t\tsum[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] += lazy[rt] * rn;</span><br><span class=\"line\">\t\t\t\tlazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// sum</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// arr[l~r]build1~N(l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt :  sum</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">build</span><span class=\"params\">(<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (l == r) &#123;</span><br><span class=\"line\">\t\t\t\tsum[rt] = arr[l];</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tbuild(l, mid, rt &lt;&lt; <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt</span></span><br><span class=\"line\">\t\t\tbuild(mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>); <span class=\"comment\">//  2*rt + 1</span></span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt  lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\t\t\t\t\t<span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r,</span></span></span><br><span class=\"line\"><span class=\"function\"><span class=\"params\">\t\t\t\t\t\t<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tsum[rt] += C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\tlazy[rt] += C;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"comment\">//   L, R   l,r </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tadd(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tadd(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// sum</span></span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,C</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt  lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt] = C;</span><br><span class=\"line\">\t\t\t\tsum[rt] = C * (r - l + <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t\tlazy[rt] = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t</span><br><span class=\"line\">\t\t<span class=\"comment\">// L..R -&gt;  ,</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// l,r -&gt; (l: 1, r: origin.length)</span></span><br><span class=\"line\">\t\t<span class=\"comment\">// rt lr(root)</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> sum[rt];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tans += query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tans += query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Right</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">public</span> <span class=\"keyword\">int</span>[] arr;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">Right</span><span class=\"params\">(<span class=\"keyword\">int</span>[] origin)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tarr = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[origin.length + <span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; origin.length; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i + <span class=\"number\">1</span>] = origin[i];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] = C;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">add</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tarr[i] += C;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">long</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">long</span> ans = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = L; i &lt;= R; i++) &#123;</span><br><span class=\"line\">\t\t\t\tans += arr[i];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> ans;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">int</span>[] genarateRandomArray(<span class=\"keyword\">int</span> len, <span class=\"keyword\">int</span> max) &#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> size = (<span class=\"keyword\">int</span>) (Math.random() * len) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] origin = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[size];</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; size; i++) &#123;</span><br><span class=\"line\">\t\t\torigin[i] = (<span class=\"keyword\">int</span>) (Math.random() * max) - (<span class=\"keyword\">int</span>) (Math.random() * max);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> origin;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\">\t * </span></span><br><span class=\"line\"><span class=\"comment\">\t * <span class=\"doctag\">@return</span></span></span><br><span class=\"line\"><span class=\"comment\">\t */</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">boolean</span> <span class=\"title\">test</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> len = <span class=\"number\">100</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> max = <span class=\"number\">1000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> testTimes = <span class=\"number\">5000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> addOrUpdateTimes = <span class=\"number\">1000</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> queryTimes = <span class=\"number\">500</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> i = <span class=\"number\">0</span>; i &lt; testTimes; i++) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span>[] origin = genarateRandomArray(len, max);</span><br><span class=\"line\">\t\t\tSegmentTree seg = <span class=\"keyword\">new</span> SegmentTree(origin);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> S = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> N = origin.length;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> root = <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tseg.build(S, N, root);</span><br><span class=\"line\">\t\t\tRight rig = <span class=\"keyword\">new</span> Right(origin);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> j = <span class=\"number\">0</span>; j &lt; addOrUpdateTimes; j++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num1 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num2 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> L = Math.min(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> R = Math.max(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> C = (<span class=\"keyword\">int</span>) (Math.random() * max) - (<span class=\"keyword\">int</span>) (Math.random() * max);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (Math.random() &lt; <span class=\"number\">0.5</span>) &#123;</span><br><span class=\"line\">\t\t\t\t\tseg.add(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t\t\t\trig.add(L, R, C);</span><br><span class=\"line\">\t\t\t\t&#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">\t\t\t\t\tseg.update(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t\t\t\trig.update(L, R, C);</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span> k = <span class=\"number\">0</span>; k &lt; queryTimes; k++) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num1 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> num2 = (<span class=\"keyword\">int</span>) (Math.random() * N) + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> L = Math.min(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">int</span> R = Math.max(num1, num2);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">long</span> ans1 = seg.query(L, R, S, N, root);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">long</span> ans2 = rig.query(L, R);</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">if</span> (ans1 != ans2) &#123;</span><br><span class=\"line\">\t\t\t\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t\t&#125;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String[] args)</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span>[] origin = &#123; <span class=\"number\">2</span>, <span class=\"number\">1</span>, <span class=\"number\">1</span>, <span class=\"number\">2</span>, <span class=\"number\">3</span>, <span class=\"number\">4</span>, <span class=\"number\">5</span> &#125;;</span><br><span class=\"line\">\t\tSegmentTree seg = <span class=\"keyword\">new</span> SegmentTree(origin);</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> S = <span class=\"number\">1</span>; <span class=\"comment\">// 10 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> N = origin.length; <span class=\"comment\">// NN-1 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> root = <span class=\"number\">1</span>; <span class=\"comment\">// 10 -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> L = <span class=\"number\">2</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> R = <span class=\"number\">5</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> C = <span class=\"number\">4</span>; <span class=\"comment\">//  -&gt; </span></span><br><span class=\"line\">\t\t<span class=\"comment\">// [S,N]build</span></span><br><span class=\"line\">\t\tseg.build(S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LRC</span></span><br><span class=\"line\">\t\tseg.add(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LRC</span></span><br><span class=\"line\">\t\tseg.update(L, R, C, S, N, root);</span><br><span class=\"line\">\t\t<span class=\"comment\">// LR</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">long</span> sum = seg.query(L, R, S, N, root);</span><br><span class=\"line\">\t\tSystem.out.println(sum);</span><br><span class=\"line\"></span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\"...\"</span>);</span><br><span class=\"line\">\t\tSystem.out.println(<span class=\"string\">\" : \"</span> + (test() ? <span class=\"string\">\"\"</span> : <span class=\"string\">\"\"</span>));</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"Falling-Squares\"><a href=\"#Falling-Squares\" class=\"headerlink\" title=\"Falling Squares\"></a>Falling Squares</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>    <a href=\"https://leetcode.com/problems/falling-squares/\" target=\"_blank\" rel=\"noopener\">leetcode 699. Falling Squares</a> X</p>\n<p><br>    1<br>    2[a,b] -&gt; bX = a<br>    3X<br>    4</p>\n<p>N*2matrixN</p>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li>X(<code>[a, b]</code><code>x=a</code><code>b</code><code>[a, a+b-1]</code>X)</li>\n<li><code>map</code><code>1</code></li>\n<li></li>\n</ol>\n<h4 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h4><figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br><span class=\"line\">72</span><br><span class=\"line\">73</span><br><span class=\"line\">74</span><br><span class=\"line\">75</span><br><span class=\"line\">76</span><br><span class=\"line\">77</span><br><span class=\"line\">78</span><br><span class=\"line\">79</span><br><span class=\"line\">80</span><br><span class=\"line\">81</span><br><span class=\"line\">82</span><br><span class=\"line\">83</span><br><span class=\"line\">84</span><br><span class=\"line\">85</span><br><span class=\"line\">86</span><br><span class=\"line\">87</span><br><span class=\"line\">88</span><br><span class=\"line\">89</span><br><span class=\"line\">90</span><br><span class=\"line\">91</span><br><span class=\"line\">92</span><br><span class=\"line\">93</span><br><span class=\"line\">94</span><br><span class=\"line\">95</span><br><span class=\"line\">96</span><br><span class=\"line\">97</span><br><span class=\"line\">98</span><br><span class=\"line\">99</span><br><span class=\"line\">100</span><br><span class=\"line\">101</span><br><span class=\"line\">102</span><br><span class=\"line\">103</span><br><span class=\"line\">104</span><br><span class=\"line\">105</span><br><span class=\"line\">106</span><br><span class=\"line\">107</span><br><span class=\"line\">108</span><br><span class=\"line\">109</span><br><span class=\"line\">110</span><br><span class=\"line\">111</span><br><span class=\"line\">112</span><br><span class=\"line\">113</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">import</span> java.util.ArrayList;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.HashMap;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.List;</span><br><span class=\"line\"><span class=\"keyword\">import</span> java.util.TreeSet;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Code02_FallingSquares</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SegmentTree</span> </span>&#123;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] max;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">int</span>[] change;</span><br><span class=\"line\">\t\t<span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span>[] update;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"title\">SegmentTree</span><span class=\"params\">(<span class=\"keyword\">int</span> size)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> N = size + <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tmax = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t\tchange = <span class=\"keyword\">new</span> <span class=\"keyword\">int</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t\tupdate = <span class=\"keyword\">new</span> <span class=\"keyword\">boolean</span>[N &lt;&lt; <span class=\"number\">2</span>];</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushUp</span><span class=\"params\">(<span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\tmax[rt] = Math.max(max[rt &lt;&lt; <span class=\"number\">1</span>], max[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>]);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"comment\">// lnrn</span></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">void</span> <span class=\"title\">pushDown</span><span class=\"params\">(<span class=\"keyword\">int</span> rt, <span class=\"keyword\">int</span> ln, <span class=\"keyword\">int</span> rn)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (update[rt]) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tupdate[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tchange[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tmax[rt &lt;&lt; <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tmax[rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>] = change[rt];</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">update</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> C, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\tupdate[rt] = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">\t\t\t\tchange[rt] = C;</span><br><span class=\"line\">\t\t\t\tmax[rt] = C;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span>;</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tupdate(L, R, C, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\tpushUp(rt);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t\t<span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">int</span> <span class=\"title\">query</span><span class=\"params\">(<span class=\"keyword\">int</span> L, <span class=\"keyword\">int</span> R, <span class=\"keyword\">int</span> l, <span class=\"keyword\">int</span> r, <span class=\"keyword\">int</span> rt)</span> </span>&#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= l &amp;&amp; r &lt;= R) &#123;</span><br><span class=\"line\">\t\t\t\t<span class=\"keyword\">return</span> max[rt];</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> mid = (l + r) &gt;&gt; <span class=\"number\">1</span>;</span><br><span class=\"line\">\t\t\tpushDown(rt, mid - l + <span class=\"number\">1</span>, r - mid);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> left = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> right = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (L &lt;= mid) &#123;</span><br><span class=\"line\">\t\t\t\tleft = query(L, R, l, mid, rt &lt;&lt; <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">if</span> (R &gt; mid) &#123;</span><br><span class=\"line\">\t\t\t\tright = query(L, R, mid + <span class=\"number\">1</span>, r, rt &lt;&lt; <span class=\"number\">1</span> | <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t&#125;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">return</span> Math.max(left, right);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"comment\">// positions</span></span><br><span class=\"line\">  <span class=\"comment\">// X([a, b]x=ab[a, a+b-1]X)</span></span><br><span class=\"line\">  <span class=\"comment\">// [2, 7] -&gt; 2, 8</span></span><br><span class=\"line\">  <span class=\"comment\">// [3, 10] -&gt; 3, 12</span></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> HashMap&lt;Integer, Integer&gt; <span class=\"title\">index</span><span class=\"params\">(<span class=\"keyword\">int</span>[][] positions)</span> </span>&#123;</span><br><span class=\"line\">\t\tTreeSet&lt;Integer&gt; pos = <span class=\"keyword\">new</span> TreeSet&lt;&gt;();</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span>[] arr : positions) &#123;</span><br><span class=\"line\">\t\t\tpos.add(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\t\tpos.add(arr[<span class=\"number\">0</span>] + arr[<span class=\"number\">1</span>] - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\tHashMap&lt;Integer, Integer&gt; map = <span class=\"keyword\">new</span> HashMap&lt;&gt;();</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> count = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (Integer index : pos) &#123;</span><br><span class=\"line\">\t\t\tmap.put(index, ++count);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> map;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">\t<span class=\"function\"><span class=\"keyword\">public</span> List&lt;Integer&gt; <span class=\"title\">fallingSquares</span><span class=\"params\">(<span class=\"keyword\">int</span>[][] positions)</span> </span>&#123;</span><br><span class=\"line\">\t\tHashMap&lt;Integer, Integer&gt; map = index(positions);</span><br><span class=\"line\">    <span class=\"comment\">// map1</span></span><br><span class=\"line\">    <span class=\"comment\">// 100 -&gt; 1   306 -&gt; 2   403 -&gt; 3</span></span><br><span class=\"line\">    <span class=\"comment\">// [100, 403]   1 ~ 3</span></span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> N = map.size(); <span class=\"comment\">// 1 ~ N</span></span><br><span class=\"line\">\t\tSegmentTree segmentTree = <span class=\"keyword\">new</span> SegmentTree(N);</span><br><span class=\"line\">\t\t<span class=\"keyword\">int</span> max = <span class=\"number\">0</span>;</span><br><span class=\"line\">\t\tList&lt;Integer&gt; res = <span class=\"keyword\">new</span> ArrayList&lt;&gt;();</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">\t\t<span class=\"keyword\">for</span> (<span class=\"keyword\">int</span>[] arr : positions) &#123;</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> L = map.get(arr[<span class=\"number\">0</span>]);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> R = map.get(arr[<span class=\"number\">0</span>] + arr[<span class=\"number\">1</span>] - <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t\t<span class=\"keyword\">int</span> height = segmentTree.query(L, R, <span class=\"number\">1</span>, N, <span class=\"number\">1</span>) + arr[<span class=\"number\">1</span>];</span><br><span class=\"line\">\t\t\tmax = Math.max(max, height);</span><br><span class=\"line\">\t\t\tres.add(max);</span><br><span class=\"line\">\t\t\tsegmentTree.update(L, R, height, <span class=\"number\">1</span>, N, <span class=\"number\">1</span>);</span><br><span class=\"line\">\t\t&#125;</span><br><span class=\"line\">\t\t<span class=\"keyword\">return</span> res;</span><br><span class=\"line\">\t&#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n\n\n\n"},{"title":"---","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":0,"abbrlink":"c608","date":"2020-12-20T16:00:00.000Z","subtitle":null,"_content":"### ---\n### ---\n### ---\n#### AVL\n#### \n### ---\n### ---\n","source":"_posts/algorithm-tree.md","raw":"---\ntitle: ---\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: 0\ntags:\n  - algorithm\ncategories:\n  - work\nabbrlink: c608\ndate: 2020-12-21 00:00:00\nsubtitle:\n---\n### ---\n### ---\n### ---\n#### AVL\n#### \n### ---\n### ---\n","slug":"algorithm-tree","published":1,"updated":"2021-11-10T13:43:16.136Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweeh000ckh6z76kh03mb","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"AVL\"><a href=\"#AVL\" class=\"headerlink\" title=\"AVL\"></a>AVL</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h4 id=\"AVL\"><a href=\"#AVL\" class=\"headerlink\" title=\"AVL\"></a>AVL</h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>"},{"title":"---","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":0,"abbrlink":"211a","date":"2020-12-20T16:00:00.000Z","subtitle":null,"_content":"### ---O(n^2)\n#### \n#### \n#### \n#### \n### ---O(nlogn)\n#### \n#### \n#### \n### ---O(n)\n#### \n#### \n#### ","source":"_posts/algorithm-sort.md","raw":"---\ntitle: ---\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: 0\ntags:\n  - algorithm\ncategories:\n  - work\nabbrlink: 211a\ndate: 2020-12-21 00:00:00\nsubtitle:\n---\n### ---O(n^2)\n#### \n#### \n#### \n#### \n### ---O(nlogn)\n#### \n#### \n#### \n### ---O(n)\n#### \n#### \n#### ","slug":"algorithm-sort","published":1,"updated":"2021-11-10T13:43:16.135Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweej000hkh6zby3u6vtg","content":"<h3 id=\"O-n-2-\"><a href=\"#O-n-2-\" class=\"headerlink\" title=\"O(n^2)\"></a>O(n^2)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"O-nlogn-\"><a href=\"#O-nlogn-\" class=\"headerlink\" title=\"O(nlogn)\"></a>O(nlogn)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"O-n-\"><a href=\"#O-n-\" class=\"headerlink\" title=\"O(n)\"></a>O(n)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"O-n-2-\"><a href=\"#O-n-2-\" class=\"headerlink\" title=\"O(n^2)\"></a>O(n^2)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"O-nlogn-\"><a href=\"#O-nlogn-\" class=\"headerlink\" title=\"O(nlogn)\"></a>O(nlogn)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h3 id=\"O-n-\"><a href=\"#O-n-\" class=\"headerlink\" title=\"O(n)\"></a>O(n)</h3><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4>"},{"title":"VirtualBoxCentos","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"130","date":"2020-10-22T16:00:00.000Z","subtitle":null,"_content":"\n### \n\n /etc/profile ,:\n\n```\nhttp_proxy=http://name:pwd@ip:port\nhttps_proxy=http://name:pwd@ip:port\nftp_proxy=http://name:pwd@ip:port\nexport http_proxy\nexport https_proxy\nexport ftp_proxy\n```\n\n\n\n```\n[root@lcoalhost]# source /etc/profile\n```\n\n, ~/.bash_profile ,;\n\n,\n\n### yum\n\n /etc/yum.conf:\n\n```\nhttp_proxy=http://name:pwd@ip:port\n```\n\nyum\n\n### wget\n\n/etc/wgetrc:\n\n```\nhttp_proxy = http://name:pwd@ip:port\nftp_proxy = http://name:pwd@ip:port\n```\n\n### \n\nVirtualBoxHost-OnlyDHCPdhcp\n\nHost-Only\n\nnet-tools\n\n```\n[root@lcoalhost]# yum -y install net-tools\n```\n\nipping\n\n```\n[root@lcoalhost]# ifconfig\nenp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 10.112.118.81  netmask 255.255.254.0  broadcast 10.112.119.255 \n        inet6 fe80::f41f:d:f042:d8ae  prefixlen 64  scopeid 0x20<link> \n        ether 08:00:27:fb:62:61  txqueuelen 1000  (Ethernet) //ethermac\n        RX packets 220530  bytes 251839085 (240.1 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 42719  bytes 2891040 (2.7 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\nenp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.56.103  netmask 255.255.255.0  broadcast 192.168.56.255 // inetdhcp\n        inet6 fe80::5ff8:c6c:90:9239  prefixlen 64  scopeid 0x20<link>\n        ether 08:00:27:96:49:8d  txqueuelen 1000  (Ethernet) //ethermac\n        RX packets 62911  bytes 3926194 (3.7 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 117073  bytes 10861798 (10.3 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n```\n\n### git\n\n```\n[root@lcoalhost]# yun -y install git\n[root@lcoalhost]# git config --global https.proxy http://name:pwd@ip:port\n[root@lcoalhost]# git config --global http.proxy http://name:pwd@ip:port\n```\n\n### docker \n\n1Docker  CentOS  3.10 CentOS  Docker \n\n uname -r \n\n```\n [root@lcoalhost]# uname -r\n```\n\n2 root  Centos yum \n\n```\n[root@lcoalhost]# sudo yum update\n```\n\n\n3()\n\n```\n[root@lcoalhost]#sudo yum remove docker  docker-common docker-selinux docker-engine\n```\n\n4 yum-util yum-config-managerdevicemapper\n\n```\n[root@lcoalhost]# sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n```\n\n5yum\n\n```\n[root@lcoalhost]# sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n```\n\n \n\n```\n[root@lcoalhost]# yum-config-manager --add-repo http://mirrors.aliyun.com/dockerce/linux/centos/docker-ce.repo\n```\n\n6docker\n\n```\n[root@lcoalhost]# yum list docker-ce --showduplicates | sort -r\n```\n\n7docker\n\n```\n[root@lcoalhost]# sudo yum install docker-ce  #repostable17.12.0\n[root@lcoalhost]# sudo yum install <FQPN>  # sudo yum install docker-ce-17.12.0.ce\n```\n\n8\n\n```\n[root@lcoalhost]# sudo systemctl start docker\n[root@lcoalhost]# sudo systemctl enable docker\n```\n\n\n9(clientservicedocker)\n\n```\n[root@lcoalhost]# docker version\n```\n\n### docker \n\n```\n[root@lcoalhost]# mkdir -p /etc/systemd/system/docker.service.d\n[root@lcoalhost]# cat > /etc/systemd/system/docker.service.d/https-proxy.conf << EOF\n[Service]\nEnvironment=\"http://name:pwd@ip:port\" \"HTTPS_PROXY=http://name:pwd@ip:port\" \nEOF\n[root@lcoalhost]# systemctl daemon-reload\n[root@lcoalhost]# systemctl restart docker\n[root@lcoalhost]# systemctl show --property=Environment docker\n```\n\ndocker docker 1.10.0 ,daemon/etc/docker/daemon.json\n\n```\n[root@lcoalhost]#sudo mkdir -p /etc/docker\n[root@lcoalhost]#sudo tee /etc/docker/daemon.json <<-'EOF'\n{\n\"registry-mirrors\": [\"https://4ld4cyzt.mirror.aliyuncs.com\"]\n}\nEOF\n[root@lcoalhost]#sudo systemctl daemon-reload\n[root@lcoalhost]#sudo systemctl restart docker\n```\n\n\n\n### dockerMysql\n\nmysql\n\n```\n[root@lcoalhost]# docker pull mysql:5.7\n5.7: Pulling from library/mysql\n123275d6e508: Already exists \n27cddf5c7140: Pull complete \nc17d442e14c9: Pull complete \n2eb72ffed068: Pull complete \nd4aa125eb616: Pull complete \n52560afb169c: Pull complete \n68190f37a1d2: Pull complete \n3fd1dc6e2990: Pull complete \n85a79b83df29: Pull complete \n35e0b437fe88: Pull complete \n992f6a10268c: Pull complete \nDigest: sha256:82b72085b2fcff073a6616b84c7c3bcbb36e2d13af838cec11a9ed1d0b183f5e\nStatus: Downloaded newer image for mysql:5.7\ndocker.io/library/mysql:5.7\n```\n\n\n\n```\n[root@lcoalhost]# docker images\nREPOSITORY  TAG    IMAGE ID     CREATED       SIZE\nmysql       5.7    f5829c0eee9e 2 hours ago   455MB\n[root@lcoalhost]# \n```\n\nmysql\n\n```shell\nsudo docker run -p 3306:3306 --name mysql \\\n-v /mydata/mysql/log:/var/log/mysql \\\n-v /mydata/mysql/data:/var/lib/mysql \\\n-v /mydata/mysql/conf:/etc/mysql \\\n-e MYSQL_ROOT_PASSWORD=root \\\n-d mysql:5.7\n```\n\n\n\n```\n[root@lcoalhost]# cd /mydata/mysql/conf\n// \n[root@lcoalhost conf]# cat my.cnf\n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\n\n[root@lcoalhost conf]# docker restart mysql\nmysql\n[root@lcoalhost conf]# \n```\n\n\n\n```shell\n[root@lcoalhost conf]# docker exec -it mysql /bin/bash\nroot@b3a74e031bd7:/# whereis mysql\nmysql: /usr/bin/mysql /usr/lib/mysql /etc/mysql /usr/share/mysql\n\nroot@b3a74e031bd7:/# ls /etc/mysql \nmy.cnf\nroot@b3a74e031bd7:/# cat /etc/mysql/my.cnf \n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\nroot@b3a74e031bd7:/# \n```\n\nmysqldocker\n\n```\n[root@lcoalhost ~]# docker update mysql --restart=always\nmysql\n```\n\n### dockerRedis\n\nredis\n\n```shell\n[root@lcoalhost ~]# docker pull redis\nUsing default tag: latest\nlatest: Pulling from library/redis\n123275d6e508: Already exists \nf2edbd6a658e: Pull complete \n66960bede47c: Pull complete \n79dc0b596c90: Pull complete \nde36df38e0b6: Pull complete \n602cd484ff92: Pull complete \nDigest: sha256:1d0b903e3770c2c3c79961b73a53e963f4fd4b2674c2c4911472e8a054cb5728\nStatus: Downloaded newer image for redis:latest\ndocker.io/library/redis:latest\n```\n\n\n\n```shell\n[root@lcoalhost ~]# mkdir -p /mydata/redis/conf\n[root@lcoalhost ~]# touch /mydata/redis/conf/redis.conf\n[root@lcoalhost ~]# echo \"appendonly yes\"  >> /mydata/redis/conf/redis.conf // \n[root@lcoalhost ~]# docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\\n -v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\\n -d redis redis-server /etc/redis/redis.conf\nce7ae709711986e3f90c9278b284fe6f51f1c1102ba05f3692f0e934ceca1565\n```\n\n dockerredis\n\n```shell\n[root@lcoalhost ~]# docker exec -it redis redis-cli\n127.0.0.1:6379> set key1 v1\nOK\n127.0.0.1:6379> get key1\n\"v1\"\n```\n\nredisdocker\n\n```shell\n[root@lcoalhost ~]# docker update redis --restart=always\nredis\n```\n\n\n\n","source":"_posts/centos-config.md","raw":"---\ntitle: VirtualBoxCentos\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - tools\ncategories:\n  - work\nabbrlink: '130'\ndate: 2020-10-23 00:00:00\nsubtitle:\n---\n\n### \n\n /etc/profile ,:\n\n```\nhttp_proxy=http://name:pwd@ip:port\nhttps_proxy=http://name:pwd@ip:port\nftp_proxy=http://name:pwd@ip:port\nexport http_proxy\nexport https_proxy\nexport ftp_proxy\n```\n\n\n\n```\n[root@lcoalhost]# source /etc/profile\n```\n\n, ~/.bash_profile ,;\n\n,\n\n### yum\n\n /etc/yum.conf:\n\n```\nhttp_proxy=http://name:pwd@ip:port\n```\n\nyum\n\n### wget\n\n/etc/wgetrc:\n\n```\nhttp_proxy = http://name:pwd@ip:port\nftp_proxy = http://name:pwd@ip:port\n```\n\n### \n\nVirtualBoxHost-OnlyDHCPdhcp\n\nHost-Only\n\nnet-tools\n\n```\n[root@lcoalhost]# yum -y install net-tools\n```\n\nipping\n\n```\n[root@lcoalhost]# ifconfig\nenp0s3: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 10.112.118.81  netmask 255.255.254.0  broadcast 10.112.119.255 \n        inet6 fe80::f41f:d:f042:d8ae  prefixlen 64  scopeid 0x20<link> \n        ether 08:00:27:fb:62:61  txqueuelen 1000  (Ethernet) //ethermac\n        RX packets 220530  bytes 251839085 (240.1 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 42719  bytes 2891040 (2.7 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\nenp0s8: flags=4163<UP,BROADCAST,RUNNING,MULTICAST>  mtu 1500\n        inet 192.168.56.103  netmask 255.255.255.0  broadcast 192.168.56.255 // inetdhcp\n        inet6 fe80::5ff8:c6c:90:9239  prefixlen 64  scopeid 0x20<link>\n        ether 08:00:27:96:49:8d  txqueuelen 1000  (Ethernet) //ethermac\n        RX packets 62911  bytes 3926194 (3.7 MiB)\n        RX errors 0  dropped 0  overruns 0  frame 0\n        TX packets 117073  bytes 10861798 (10.3 MiB)\n        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0\n```\n\n### git\n\n```\n[root@lcoalhost]# yun -y install git\n[root@lcoalhost]# git config --global https.proxy http://name:pwd@ip:port\n[root@lcoalhost]# git config --global http.proxy http://name:pwd@ip:port\n```\n\n### docker \n\n1Docker  CentOS  3.10 CentOS  Docker \n\n uname -r \n\n```\n [root@lcoalhost]# uname -r\n```\n\n2 root  Centos yum \n\n```\n[root@lcoalhost]# sudo yum update\n```\n\n\n3()\n\n```\n[root@lcoalhost]#sudo yum remove docker  docker-common docker-selinux docker-engine\n```\n\n4 yum-util yum-config-managerdevicemapper\n\n```\n[root@lcoalhost]# sudo yum install -y yum-utils device-mapper-persistent-data lvm2\n```\n\n5yum\n\n```\n[root@lcoalhost]# sudo yum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n```\n\n \n\n```\n[root@lcoalhost]# yum-config-manager --add-repo http://mirrors.aliyun.com/dockerce/linux/centos/docker-ce.repo\n```\n\n6docker\n\n```\n[root@lcoalhost]# yum list docker-ce --showduplicates | sort -r\n```\n\n7docker\n\n```\n[root@lcoalhost]# sudo yum install docker-ce  #repostable17.12.0\n[root@lcoalhost]# sudo yum install <FQPN>  # sudo yum install docker-ce-17.12.0.ce\n```\n\n8\n\n```\n[root@lcoalhost]# sudo systemctl start docker\n[root@lcoalhost]# sudo systemctl enable docker\n```\n\n\n9(clientservicedocker)\n\n```\n[root@lcoalhost]# docker version\n```\n\n### docker \n\n```\n[root@lcoalhost]# mkdir -p /etc/systemd/system/docker.service.d\n[root@lcoalhost]# cat > /etc/systemd/system/docker.service.d/https-proxy.conf << EOF\n[Service]\nEnvironment=\"http://name:pwd@ip:port\" \"HTTPS_PROXY=http://name:pwd@ip:port\" \nEOF\n[root@lcoalhost]# systemctl daemon-reload\n[root@lcoalhost]# systemctl restart docker\n[root@lcoalhost]# systemctl show --property=Environment docker\n```\n\ndocker docker 1.10.0 ,daemon/etc/docker/daemon.json\n\n```\n[root@lcoalhost]#sudo mkdir -p /etc/docker\n[root@lcoalhost]#sudo tee /etc/docker/daemon.json <<-'EOF'\n{\n\"registry-mirrors\": [\"https://4ld4cyzt.mirror.aliyuncs.com\"]\n}\nEOF\n[root@lcoalhost]#sudo systemctl daemon-reload\n[root@lcoalhost]#sudo systemctl restart docker\n```\n\n\n\n### dockerMysql\n\nmysql\n\n```\n[root@lcoalhost]# docker pull mysql:5.7\n5.7: Pulling from library/mysql\n123275d6e508: Already exists \n27cddf5c7140: Pull complete \nc17d442e14c9: Pull complete \n2eb72ffed068: Pull complete \nd4aa125eb616: Pull complete \n52560afb169c: Pull complete \n68190f37a1d2: Pull complete \n3fd1dc6e2990: Pull complete \n85a79b83df29: Pull complete \n35e0b437fe88: Pull complete \n992f6a10268c: Pull complete \nDigest: sha256:82b72085b2fcff073a6616b84c7c3bcbb36e2d13af838cec11a9ed1d0b183f5e\nStatus: Downloaded newer image for mysql:5.7\ndocker.io/library/mysql:5.7\n```\n\n\n\n```\n[root@lcoalhost]# docker images\nREPOSITORY  TAG    IMAGE ID     CREATED       SIZE\nmysql       5.7    f5829c0eee9e 2 hours ago   455MB\n[root@lcoalhost]# \n```\n\nmysql\n\n```shell\nsudo docker run -p 3306:3306 --name mysql \\\n-v /mydata/mysql/log:/var/log/mysql \\\n-v /mydata/mysql/data:/var/lib/mysql \\\n-v /mydata/mysql/conf:/etc/mysql \\\n-e MYSQL_ROOT_PASSWORD=root \\\n-d mysql:5.7\n```\n\n\n\n```\n[root@lcoalhost]# cd /mydata/mysql/conf\n// \n[root@lcoalhost conf]# cat my.cnf\n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\n\n[root@lcoalhost conf]# docker restart mysql\nmysql\n[root@lcoalhost conf]# \n```\n\n\n\n```shell\n[root@lcoalhost conf]# docker exec -it mysql /bin/bash\nroot@b3a74e031bd7:/# whereis mysql\nmysql: /usr/bin/mysql /usr/lib/mysql /etc/mysql /usr/share/mysql\n\nroot@b3a74e031bd7:/# ls /etc/mysql \nmy.cnf\nroot@b3a74e031bd7:/# cat /etc/mysql/my.cnf \n[client]\ndefault-character-set=utf8\n[mysql]\ndefault-character-set=utf8\n[mysqld]\ninit_connect='SET collation_connection = utf8_unicode_ci'\ninit_connect='SET NAMES utf8'\ncharacter-set-server=utf8\ncollation-server=utf8_unicode_ci\nskip-character-set-client-handshake\nskip-name-resolve\nroot@b3a74e031bd7:/# \n```\n\nmysqldocker\n\n```\n[root@lcoalhost ~]# docker update mysql --restart=always\nmysql\n```\n\n### dockerRedis\n\nredis\n\n```shell\n[root@lcoalhost ~]# docker pull redis\nUsing default tag: latest\nlatest: Pulling from library/redis\n123275d6e508: Already exists \nf2edbd6a658e: Pull complete \n66960bede47c: Pull complete \n79dc0b596c90: Pull complete \nde36df38e0b6: Pull complete \n602cd484ff92: Pull complete \nDigest: sha256:1d0b903e3770c2c3c79961b73a53e963f4fd4b2674c2c4911472e8a054cb5728\nStatus: Downloaded newer image for redis:latest\ndocker.io/library/redis:latest\n```\n\n\n\n```shell\n[root@lcoalhost ~]# mkdir -p /mydata/redis/conf\n[root@lcoalhost ~]# touch /mydata/redis/conf/redis.conf\n[root@lcoalhost ~]# echo \"appendonly yes\"  >> /mydata/redis/conf/redis.conf // \n[root@lcoalhost ~]# docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\\n -v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\\n -d redis redis-server /etc/redis/redis.conf\nce7ae709711986e3f90c9278b284fe6f51f1c1102ba05f3692f0e934ceca1565\n```\n\n dockerredis\n\n```shell\n[root@lcoalhost ~]# docker exec -it redis redis-cli\n127.0.0.1:6379> set key1 v1\nOK\n127.0.0.1:6379> get key1\n\"v1\"\n```\n\nredisdocker\n\n```shell\n[root@lcoalhost ~]# docker update redis --restart=always\nredis\n```\n\n\n\n","slug":"centos-config","published":1,"updated":"2022-04-23T08:54:59.571Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweek000kkh6z63jgemaa","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> /etc/profile ,:</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">http_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"attribute\">https_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"attribute\">ftp_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> http_proxy</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> https_proxy</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> ftp_proxy</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># source /etc/profile</span></span><br></pre></td></tr></table></figure>\n\n<p>, ~/.bash_profile ,;</p>\n<p>,</p>\n<h3 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h3><p> /etc/yum.conf:</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http_proxy=<span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br></pre></td></tr></table></figure>\n\n<p>yum</p>\n<h3 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h3><p>/etc/wgetrc:</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http_proxy = <span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br><span class=\"line\">ftp_proxy = <span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>VirtualBoxHost-OnlyDHCPdhcp</p>\n<p>Host-Only</p>\n<p>net-tools</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># yum -y install net-tools</span></span><br></pre></td></tr></table></figure>\n\n<p>ipping</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]# ifconfig</span><br><span class=\"line\">enp0s3: flags=<span class=\"number\">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=\"number\">1500</span></span><br><span class=\"line\">        inet <span class=\"number\">10.112</span><span class=\"number\">.118</span><span class=\"number\">.81</span>  netmask <span class=\"number\">255.255</span><span class=\"number\">.254</span><span class=\"number\">.0</span>  broadcast <span class=\"number\">10.112</span><span class=\"number\">.119</span><span class=\"number\">.255</span> </span><br><span class=\"line\">        inet6 fe80::f41f:d:f042:d8ae  prefixlen <span class=\"number\">64</span>  scopeid <span class=\"number\">0x20</span>&lt;link&gt; </span><br><span class=\"line\">        ether <span class=\"number\">08</span>:<span class=\"number\">00</span>:<span class=\"number\">27</span>:fb:<span class=\"number\">62</span>:<span class=\"number\">61</span>  txqueuelen <span class=\"number\">1000</span>  (Ethernet) <span class=\"comment\">//ethermac</span></span><br><span class=\"line\">        RX packets <span class=\"number\">220530</span>  bytes <span class=\"number\">251839085</span> (<span class=\"number\">240.1</span> MiB)</span><br><span class=\"line\">        RX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        TX packets <span class=\"number\">42719</span>  bytes <span class=\"number\">2891040</span> (<span class=\"number\">2.7</span> MiB)</span><br><span class=\"line\">        TX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br><span class=\"line\">enp0s8: flags=<span class=\"number\">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=\"number\">1500</span></span><br><span class=\"line\">        inet <span class=\"number\">192.168</span><span class=\"number\">.56</span><span class=\"number\">.103</span>  netmask <span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span>  broadcast <span class=\"number\">192.168</span><span class=\"number\">.56</span><span class=\"number\">.255</span> <span class=\"comment\">// inetdhcp</span></span><br><span class=\"line\">        inet6 fe80::<span class=\"number\">5f</span>f8:c6c:<span class=\"number\">90</span>:<span class=\"number\">9239</span>  prefixlen <span class=\"number\">64</span>  scopeid <span class=\"number\">0x20</span>&lt;link&gt;</span><br><span class=\"line\">        ether <span class=\"number\">08</span>:<span class=\"number\">00</span>:<span class=\"number\">27</span>:<span class=\"number\">96</span>:<span class=\"number\">49</span>:<span class=\"number\">8</span>d  txqueuelen <span class=\"number\">1000</span>  (Ethernet) <span class=\"comment\">//ethermac</span></span><br><span class=\"line\">        RX packets <span class=\"number\">62911</span>  bytes <span class=\"number\">3926194</span> (<span class=\"number\">3.7</span> MiB)</span><br><span class=\"line\">        RX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        TX packets <span class=\"number\">117073</span>  bytes <span class=\"number\">10861798</span> (<span class=\"number\">10.3</span> MiB)</span><br><span class=\"line\">        TX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># yun -y install git</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># git config --global https.proxy http://name:pwd<span class=\"doctag\">@ip</span>:port</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># git config --global http.proxy http://name:pwd<span class=\"doctag\">@ip</span>:port</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h3><p>1Docker  CentOS  3.10 CentOS  Docker </p>\n<p> uname -r </p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># uname -r</span></span><br></pre></td></tr></table></figure>\n\n<p>2 root  Centos yum </p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo yum update</span></span><br></pre></td></tr></table></figure>\n\n\n<p>3()</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo yum remove docker  docker-common docker-selinux docker-engine</span></span><br></pre></td></tr></table></figure>\n\n<p>4 yum-util yum-config-managerdevicemapper</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span><br></pre></td></tr></table></figure>\n\n<p>5yum</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# sudo yum-config-manager --<span class=\"built_in\">add</span>-repo http<span class=\"variable\">s:</span>//download.docker.<span class=\"keyword\">com</span>/linux/centos/docker-<span class=\"keyword\">ce</span>.repo</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# yum-config-manager --<span class=\"built_in\">add</span>-repo http://mirrors.aliyun.<span class=\"keyword\">com</span>/dockerce/linux/centos/docker-<span class=\"keyword\">ce</span>.repo</span><br></pre></td></tr></table></figure>\n\n<p>6docker</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# yum <span class=\"keyword\">list</span> docker-<span class=\"keyword\">ce</span> --showduplicates | <span class=\"keyword\">sort</span> -r</span><br></pre></td></tr></table></figure>\n\n<p>7docker</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-attr\">[root@lcoalhost]</span># <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> <span class=\"selector-tag\">docker-ce</span>  #<span class=\"selector-tag\">repo</span><span class=\"selector-tag\">stable</span>17<span class=\"selector-class\">.12</span><span class=\"selector-class\">.0</span></span><br><span class=\"line\"><span class=\"selector-attr\">[root@lcoalhost]</span># <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> &lt;<span class=\"selector-tag\">FQPN</span>&gt;  # <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> <span class=\"selector-tag\">docker-ce-17</span><span class=\"selector-class\">.12</span><span class=\"selector-class\">.0</span><span class=\"selector-class\">.ce</span></span><br></pre></td></tr></table></figure>\n\n<p>8</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo systemctl start docker</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo systemctl enable docker</span></span><br></pre></td></tr></table></figure>\n\n\n<p>9(clientservicedocker)</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># docker version</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h3><figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># mkdir -p /etc/systemd/system/docker.service.d</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># cat &gt; /etc/systemd/system/docker.service.d/https-proxy.conf &lt;&lt; EOF</span></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=<span class=\"string\">\"http://name:pwd@ip:port\"</span> <span class=\"string\">\"HTTPS_PROXY=http://name:pwd@ip:port\"</span> </span><br><span class=\"line\">EOF</span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl daemon-reload</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl restart docker</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl show --property=Environment docker</span></span><br></pre></td></tr></table></figure>\n\n<p>docker docker 1.10.0 ,daemon/etc/docker/daemon.json</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo mkdir -p /etc/docker</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo tee /etc/docker/daemon.json &lt;&lt;-<span class=\"string\">'EOF'</span></span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"registry-mirrors\"</span>: [<span class=\"string\">\"https://4ld4cyzt.mirror.aliyuncs.com\"</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">EOF</span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo systemctl daemon-reload</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo systemctl restart docker</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"dockerMysql\"><a href=\"#dockerMysql\" class=\"headerlink\" title=\"dockerMysql\"></a>dockerMysql</h3><p>mysql</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# docker pull mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">5.7</span>: Pulling from library/mysql</span><br><span class=\"line\"><span class=\"number\">123275</span>d6e508: Already <span class=\"built_in\">exists</span> </span><br><span class=\"line\"><span class=\"number\">27</span>cddf5c7140: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">c17d442e14c9: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">2</span>eb72ffed068: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">d4aa125eb616: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">52560</span>afb169c: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">68190</span>f37a1d2: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">3</span>fd1dc6e2990: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">85</span>a79b83df29: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">35</span>e0b437fe88: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">992</span>f6a10268c: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">Diges<span class=\"variable\">t:</span> <span class=\"built_in\">sha256</span>:<span class=\"number\">82</span>b72085b2fcff073a6616b84c7c3bcbb36e2d13af838cec11a9ed1d0b183f5e</span><br><span class=\"line\">Statu<span class=\"variable\">s:</span> Downloaded newer image <span class=\"keyword\">for</span> mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br><span class=\"line\">docker.io/library/mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]# docker images</span><br><span class=\"line\">REPOSITORY  TAG    IMAGE ID     CREATED       SIZE</span><br><span class=\"line\">mysql       <span class=\"number\">5.7</span>    f5829c0eee9e <span class=\"number\">2</span> hours ago   <span class=\"number\">455</span>MB</span><br><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]#</span><br></pre></td></tr></table></figure>\n\n<p>mysql</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker run -p 3306:3306 --name mysql \\</span><br><span class=\"line\">-v /mydata/mysql/log:/var/log/mysql \\</span><br><span class=\"line\">-v /mydata/mysql/data:/var/lib/mysql \\</span><br><span class=\"line\">-v /mydata/mysql/conf:/etc/mysql \\</span><br><span class=\"line\">-e MYSQL_ROOT_PASSWORD=root \\</span><br><span class=\"line\">-d mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># cd /mydata/mysql/conf</span></span><br><span class=\"line\">// </span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\"># cat my.cnf</span></span><br><span class=\"line\">[client]</span><br><span class=\"line\">default-character-<span class=\"keyword\">set</span>=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\"><span class=\"keyword\">default</span>-<span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>=utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">init_connect=<span class=\"string\">'SET collation_connection = utf8_unicode_ci'</span></span><br><span class=\"line\">init_connect=<span class=\"string\">'SET NAMES utf8'</span></span><br><span class=\"line\"><span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>-<span class=\"keyword\">server</span>=utf8</span><br><span class=\"line\"><span class=\"keyword\">collation</span>-<span class=\"keyword\">server</span>=utf8_unicode_ci</span><br><span class=\"line\"><span class=\"keyword\">skip</span>-<span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>-<span class=\"keyword\">client</span>-handshake</span><br><span class=\"line\"><span class=\"keyword\">skip</span>-<span class=\"keyword\">name</span>-resolve</span><br><span class=\"line\"></span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\"># docker restart mysql</span></span><br><span class=\"line\">mysql</span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost conf]# docker exec -it mysql /bin/bash</span><br><span class=\"line\">root@b3a74e031bd7:/# whereis mysql</span><br><span class=\"line\">mysql: /usr/bin/mysql /usr/lib/mysql /etc/mysql /usr/share/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">root@b3a74e031bd7:/# ls /etc/mysql </span><br><span class=\"line\">my.cnf</span><br><span class=\"line\">root@b3a74e031bd7:/# cat /etc/mysql/my.cnf </span><br><span class=\"line\">[client]</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">init_connect='SET collation_connection = utf8_unicode_ci'</span><br><span class=\"line\">init_connect='SET NAMES utf8'</span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">collation-server=utf8_unicode_ci</span><br><span class=\"line\">skip-character-set-client-handshake</span><br><span class=\"line\">skip-name-resolve</span><br><span class=\"line\">root@b3a74e031bd7:/#</span><br></pre></td></tr></table></figure>\n\n<p>mysqldocker</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost</span> ~]<span class=\"meta\"># docker update mysql --restart=always</span></span><br><span class=\"line\">mysql</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dockerRedis\"><a href=\"#dockerRedis\" class=\"headerlink\" title=\"dockerRedis\"></a>dockerRedis</h3><p>redis</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker pull redis</span><br><span class=\"line\">Using default tag: latest</span><br><span class=\"line\">latest: Pulling from library/redis</span><br><span class=\"line\">123275d6e508: Already exists </span><br><span class=\"line\">f2edbd6a658e: Pull complete </span><br><span class=\"line\">66960bede47c: Pull complete </span><br><span class=\"line\">79dc0b596c90: Pull complete </span><br><span class=\"line\">de36df38e0b6: Pull complete </span><br><span class=\"line\">602cd484ff92: Pull complete </span><br><span class=\"line\">Digest: sha256:1d0b903e3770c2c3c79961b73a53e963f4fd4b2674c2c4911472e8a054cb5728</span><br><span class=\"line\">Status: Downloaded newer image for redis:latest</span><br><span class=\"line\">docker.io/library/redis:latest</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# mkdir -p /mydata/redis/conf</span><br><span class=\"line\">[root@lcoalhost ~]# touch /mydata/redis/conf/redis.conf</span><br><span class=\"line\">[root@lcoalhost ~]# echo \"appendonly yes\"  &gt;&gt; /mydata/redis/conf/redis.conf // </span><br><span class=\"line\">[root@lcoalhost ~]# docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\</span><br><span class=\"line\"> -v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\</span><br><span class=\"line\"> -d redis redis-server /etc/redis/redis.conf</span><br><span class=\"line\">ce7ae709711986e3f90c9278b284fe6f51f1c1102ba05f3692f0e934ceca1565</span><br></pre></td></tr></table></figure>\n\n<p> dockerredis</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker exec -it redis redis-cli</span><br><span class=\"line\">127.0.0.1:6379&gt; set key1 v1</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; get key1</span><br><span class=\"line\">\"v1\"</span><br></pre></td></tr></table></figure>\n\n<p>redisdocker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker update redis --restart=always</span><br><span class=\"line\">redis</span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p> /etc/profile ,:</p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">http_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"attribute\">https_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"attribute\">ftp_proxy</span>=http://name:pwd@ip:port</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> http_proxy</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> https_proxy</span><br><span class=\"line\"><span class=\"builtin-name\">export</span> ftp_proxy</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># source /etc/profile</span></span><br></pre></td></tr></table></figure>\n\n<p>, ~/.bash_profile ,;</p>\n<p>,</p>\n<h3 id=\"yum\"><a href=\"#yum\" class=\"headerlink\" title=\"yum\"></a>yum</h3><p> /etc/yum.conf:</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http_proxy=<span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br></pre></td></tr></table></figure>\n\n<p>yum</p>\n<h3 id=\"wget\"><a href=\"#wget\" class=\"headerlink\" title=\"wget\"></a>wget</h3><p>/etc/wgetrc:</p>\n<figure class=\"highlight groovy\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">http_proxy = <span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br><span class=\"line\">ftp_proxy = <span class=\"string\">http:</span><span class=\"comment\">//name:pwd@ip:port</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>VirtualBoxHost-OnlyDHCPdhcp</p>\n<p>Host-Only</p>\n<p>net-tools</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># yum -y install net-tools</span></span><br></pre></td></tr></table></figure>\n\n<p>ipping</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]# ifconfig</span><br><span class=\"line\">enp0s3: flags=<span class=\"number\">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=\"number\">1500</span></span><br><span class=\"line\">        inet <span class=\"number\">10.112</span><span class=\"number\">.118</span><span class=\"number\">.81</span>  netmask <span class=\"number\">255.255</span><span class=\"number\">.254</span><span class=\"number\">.0</span>  broadcast <span class=\"number\">10.112</span><span class=\"number\">.119</span><span class=\"number\">.255</span> </span><br><span class=\"line\">        inet6 fe80::f41f:d:f042:d8ae  prefixlen <span class=\"number\">64</span>  scopeid <span class=\"number\">0x20</span>&lt;link&gt; </span><br><span class=\"line\">        ether <span class=\"number\">08</span>:<span class=\"number\">00</span>:<span class=\"number\">27</span>:fb:<span class=\"number\">62</span>:<span class=\"number\">61</span>  txqueuelen <span class=\"number\">1000</span>  (Ethernet) <span class=\"comment\">//ethermac</span></span><br><span class=\"line\">        RX packets <span class=\"number\">220530</span>  bytes <span class=\"number\">251839085</span> (<span class=\"number\">240.1</span> MiB)</span><br><span class=\"line\">        RX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        TX packets <span class=\"number\">42719</span>  bytes <span class=\"number\">2891040</span> (<span class=\"number\">2.7</span> MiB)</span><br><span class=\"line\">        TX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br><span class=\"line\">enp0s8: flags=<span class=\"number\">4163</span>&lt;UP,BROADCAST,RUNNING,MULTICAST&gt;  mtu <span class=\"number\">1500</span></span><br><span class=\"line\">        inet <span class=\"number\">192.168</span><span class=\"number\">.56</span><span class=\"number\">.103</span>  netmask <span class=\"number\">255.255</span><span class=\"number\">.255</span><span class=\"number\">.0</span>  broadcast <span class=\"number\">192.168</span><span class=\"number\">.56</span><span class=\"number\">.255</span> <span class=\"comment\">// inetdhcp</span></span><br><span class=\"line\">        inet6 fe80::<span class=\"number\">5f</span>f8:c6c:<span class=\"number\">90</span>:<span class=\"number\">9239</span>  prefixlen <span class=\"number\">64</span>  scopeid <span class=\"number\">0x20</span>&lt;link&gt;</span><br><span class=\"line\">        ether <span class=\"number\">08</span>:<span class=\"number\">00</span>:<span class=\"number\">27</span>:<span class=\"number\">96</span>:<span class=\"number\">49</span>:<span class=\"number\">8</span>d  txqueuelen <span class=\"number\">1000</span>  (Ethernet) <span class=\"comment\">//ethermac</span></span><br><span class=\"line\">        RX packets <span class=\"number\">62911</span>  bytes <span class=\"number\">3926194</span> (<span class=\"number\">3.7</span> MiB)</span><br><span class=\"line\">        RX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span>  overruns <span class=\"number\">0</span>  frame <span class=\"number\">0</span></span><br><span class=\"line\">        TX packets <span class=\"number\">117073</span>  bytes <span class=\"number\">10861798</span> (<span class=\"number\">10.3</span> MiB)</span><br><span class=\"line\">        TX errors <span class=\"number\">0</span>  dropped <span class=\"number\">0</span> overruns <span class=\"number\">0</span>  carrier <span class=\"number\">0</span>  collisions <span class=\"number\">0</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"git\"><a href=\"#git\" class=\"headerlink\" title=\"git\"></a>git</h3><figure class=\"highlight ruby\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># yun -y install git</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># git config --global https.proxy http://name:pwd<span class=\"doctag\">@ip</span>:port</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># git config --global http.proxy http://name:pwd<span class=\"doctag\">@ip</span>:port</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h3><p>1Docker  CentOS  3.10 CentOS  Docker </p>\n<p> uname -r </p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># uname -r</span></span><br></pre></td></tr></table></figure>\n\n<p>2 root  Centos yum </p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo yum update</span></span><br></pre></td></tr></table></figure>\n\n\n<p>3()</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo yum remove docker  docker-common docker-selinux docker-engine</span></span><br></pre></td></tr></table></figure>\n\n<p>4 yum-util yum-config-managerdevicemapper</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo yum install -y yum-utils device-mapper-persistent-data lvm2</span></span><br></pre></td></tr></table></figure>\n\n<p>5yum</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# sudo yum-config-manager --<span class=\"built_in\">add</span>-repo http<span class=\"variable\">s:</span>//download.docker.<span class=\"keyword\">com</span>/linux/centos/docker-<span class=\"keyword\">ce</span>.repo</span><br></pre></td></tr></table></figure>\n\n<p> </p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# yum-config-manager --<span class=\"built_in\">add</span>-repo http://mirrors.aliyun.<span class=\"keyword\">com</span>/dockerce/linux/centos/docker-<span class=\"keyword\">ce</span>.repo</span><br></pre></td></tr></table></figure>\n\n<p>6docker</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# yum <span class=\"keyword\">list</span> docker-<span class=\"keyword\">ce</span> --showduplicates | <span class=\"keyword\">sort</span> -r</span><br></pre></td></tr></table></figure>\n\n<p>7docker</p>\n<figure class=\"highlight css\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-attr\">[root@lcoalhost]</span># <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> <span class=\"selector-tag\">docker-ce</span>  #<span class=\"selector-tag\">repo</span><span class=\"selector-tag\">stable</span>17<span class=\"selector-class\">.12</span><span class=\"selector-class\">.0</span></span><br><span class=\"line\"><span class=\"selector-attr\">[root@lcoalhost]</span># <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> &lt;<span class=\"selector-tag\">FQPN</span>&gt;  # <span class=\"selector-tag\">sudo</span> <span class=\"selector-tag\">yum</span> <span class=\"selector-tag\">install</span> <span class=\"selector-tag\">docker-ce-17</span><span class=\"selector-class\">.12</span><span class=\"selector-class\">.0</span><span class=\"selector-class\">.ce</span></span><br></pre></td></tr></table></figure>\n\n<p>8</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo systemctl start docker</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># sudo systemctl enable docker</span></span><br></pre></td></tr></table></figure>\n\n\n<p>9(clientservicedocker)</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\"># docker version</span></span><br></pre></td></tr></table></figure>\n\n<h3 id=\"docker-\"><a href=\"#docker-\" class=\"headerlink\" title=\"docker \"></a>docker </h3><figure class=\"highlight perl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># mkdir -p /etc/systemd/system/docker.service.d</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># cat &gt; /etc/systemd/system/docker.service.d/https-proxy.conf &lt;&lt; EOF</span></span><br><span class=\"line\">[Service]</span><br><span class=\"line\">Environment=<span class=\"string\">\"http://name:pwd@ip:port\"</span> <span class=\"string\">\"HTTPS_PROXY=http://name:pwd@ip:port\"</span> </span><br><span class=\"line\">EOF</span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl daemon-reload</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl restart docker</span></span><br><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># systemctl show --property=Environment docker</span></span><br></pre></td></tr></table></figure>\n\n<p>docker docker 1.10.0 ,daemon/etc/docker/daemon.json</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo mkdir -p /etc/docker</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo tee /etc/docker/daemon.json &lt;&lt;-<span class=\"string\">'EOF'</span></span></span><br><span class=\"line\">&#123;</span><br><span class=\"line\"><span class=\"string\">\"registry-mirrors\"</span>: [<span class=\"string\">\"https://4ld4cyzt.mirror.aliyuncs.com\"</span>]</span><br><span class=\"line\">&#125;</span><br><span class=\"line\">EOF</span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo systemctl daemon-reload</span></span><br><span class=\"line\">[root<span class=\"symbol\">@lcoalhost]</span><span class=\"meta\">#sudo systemctl restart docker</span></span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"dockerMysql\"><a href=\"#dockerMysql\" class=\"headerlink\" title=\"dockerMysql\"></a>dockerMysql</h3><p>mysql</p>\n<figure class=\"highlight vim\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]# docker pull mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br><span class=\"line\"><span class=\"number\">5.7</span>: Pulling from library/mysql</span><br><span class=\"line\"><span class=\"number\">123275</span>d6e508: Already <span class=\"built_in\">exists</span> </span><br><span class=\"line\"><span class=\"number\">27</span>cddf5c7140: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">c17d442e14c9: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">2</span>eb72ffed068: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">d4aa125eb616: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">52560</span>afb169c: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">68190</span>f37a1d2: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">3</span>fd1dc6e2990: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">85</span>a79b83df29: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">35</span>e0b437fe88: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\"><span class=\"number\">992</span>f6a10268c: Pull <span class=\"built_in\">complete</span> </span><br><span class=\"line\">Diges<span class=\"variable\">t:</span> <span class=\"built_in\">sha256</span>:<span class=\"number\">82</span>b72085b2fcff073a6616b84c7c3bcbb36e2d13af838cec11a9ed1d0b183f5e</span><br><span class=\"line\">Statu<span class=\"variable\">s:</span> Downloaded newer image <span class=\"keyword\">for</span> mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br><span class=\"line\">docker.io/library/mysq<span class=\"variable\">l:5</span>.<span class=\"number\">7</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]# docker images</span><br><span class=\"line\">REPOSITORY  TAG    IMAGE ID     CREATED       SIZE</span><br><span class=\"line\">mysql       <span class=\"number\">5.7</span>    f5829c0eee9e <span class=\"number\">2</span> hours ago   <span class=\"number\">455</span>MB</span><br><span class=\"line\">[<span class=\"symbol\">root@</span>lcoalhost]#</span><br></pre></td></tr></table></figure>\n\n<p>mysql</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">sudo docker run -p 3306:3306 --name mysql \\</span><br><span class=\"line\">-v /mydata/mysql/log:/var/log/mysql \\</span><br><span class=\"line\">-v /mydata/mysql/data:/var/lib/mysql \\</span><br><span class=\"line\">-v /mydata/mysql/conf:/etc/mysql \\</span><br><span class=\"line\">-e MYSQL_ROOT_PASSWORD=root \\</span><br><span class=\"line\">-d mysql:5.7</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight sql\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost]<span class=\"comment\"># cd /mydata/mysql/conf</span></span><br><span class=\"line\">// </span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\"># cat my.cnf</span></span><br><span class=\"line\">[client]</span><br><span class=\"line\">default-character-<span class=\"keyword\">set</span>=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\"><span class=\"keyword\">default</span>-<span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>=utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">init_connect=<span class=\"string\">'SET collation_connection = utf8_unicode_ci'</span></span><br><span class=\"line\">init_connect=<span class=\"string\">'SET NAMES utf8'</span></span><br><span class=\"line\"><span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>-<span class=\"keyword\">server</span>=utf8</span><br><span class=\"line\"><span class=\"keyword\">collation</span>-<span class=\"keyword\">server</span>=utf8_unicode_ci</span><br><span class=\"line\"><span class=\"keyword\">skip</span>-<span class=\"built_in\">character</span>-<span class=\"keyword\">set</span>-<span class=\"keyword\">client</span>-handshake</span><br><span class=\"line\"><span class=\"keyword\">skip</span>-<span class=\"keyword\">name</span>-resolve</span><br><span class=\"line\"></span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\"># docker restart mysql</span></span><br><span class=\"line\">mysql</span><br><span class=\"line\">[root@lcoalhost conf]<span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost conf]# docker exec -it mysql /bin/bash</span><br><span class=\"line\">root@b3a74e031bd7:/# whereis mysql</span><br><span class=\"line\">mysql: /usr/bin/mysql /usr/lib/mysql /etc/mysql /usr/share/mysql</span><br><span class=\"line\"></span><br><span class=\"line\">root@b3a74e031bd7:/# ls /etc/mysql </span><br><span class=\"line\">my.cnf</span><br><span class=\"line\">root@b3a74e031bd7:/# cat /etc/mysql/my.cnf </span><br><span class=\"line\">[client]</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\">[mysql]</span><br><span class=\"line\">default-character-set=utf8</span><br><span class=\"line\">[mysqld]</span><br><span class=\"line\">init_connect='SET collation_connection = utf8_unicode_ci'</span><br><span class=\"line\">init_connect='SET NAMES utf8'</span><br><span class=\"line\">character-set-server=utf8</span><br><span class=\"line\">collation-server=utf8_unicode_ci</span><br><span class=\"line\">skip-character-set-client-handshake</span><br><span class=\"line\">skip-name-resolve</span><br><span class=\"line\">root@b3a74e031bd7:/#</span><br></pre></td></tr></table></figure>\n\n<p>mysqldocker</p>\n<figure class=\"highlight autoit\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root<span class=\"symbol\">@lcoalhost</span> ~]<span class=\"meta\"># docker update mysql --restart=always</span></span><br><span class=\"line\">mysql</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"dockerRedis\"><a href=\"#dockerRedis\" class=\"headerlink\" title=\"dockerRedis\"></a>dockerRedis</h3><p>redis</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker pull redis</span><br><span class=\"line\">Using default tag: latest</span><br><span class=\"line\">latest: Pulling from library/redis</span><br><span class=\"line\">123275d6e508: Already exists </span><br><span class=\"line\">f2edbd6a658e: Pull complete </span><br><span class=\"line\">66960bede47c: Pull complete </span><br><span class=\"line\">79dc0b596c90: Pull complete </span><br><span class=\"line\">de36df38e0b6: Pull complete </span><br><span class=\"line\">602cd484ff92: Pull complete </span><br><span class=\"line\">Digest: sha256:1d0b903e3770c2c3c79961b73a53e963f4fd4b2674c2c4911472e8a054cb5728</span><br><span class=\"line\">Status: Downloaded newer image for redis:latest</span><br><span class=\"line\">docker.io/library/redis:latest</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# mkdir -p /mydata/redis/conf</span><br><span class=\"line\">[root@lcoalhost ~]# touch /mydata/redis/conf/redis.conf</span><br><span class=\"line\">[root@lcoalhost ~]# echo \"appendonly yes\"  &gt;&gt; /mydata/redis/conf/redis.conf // </span><br><span class=\"line\">[root@lcoalhost ~]# docker run -p 6379:6379 --name redis -v /mydata/redis/data:/data \\</span><br><span class=\"line\"> -v /mydata/redis/conf/redis.conf:/etc/redis/redis.conf \\</span><br><span class=\"line\"> -d redis redis-server /etc/redis/redis.conf</span><br><span class=\"line\">ce7ae709711986e3f90c9278b284fe6f51f1c1102ba05f3692f0e934ceca1565</span><br></pre></td></tr></table></figure>\n\n<p> dockerredis</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker exec -it redis redis-cli</span><br><span class=\"line\">127.0.0.1:6379&gt; set key1 v1</span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt; get key1</span><br><span class=\"line\">\"v1\"</span><br></pre></td></tr></table></figure>\n\n<p>redisdocker</p>\n<figure class=\"highlight shell\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[root@lcoalhost ~]# docker update redis --restart=always</span><br><span class=\"line\">redis</span><br></pre></td></tr></table></figure>\n\n\n\n"},{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":false,"toc_number":false,"top":0,"abbrlink":"86e5","date":"2021-08-17T16:00:00.000Z","subtitle":null,"_content":"\n<div id=\"chinaMap\" style=\"width: 100%;height:600px;\"></div>\n<script type=\"text/javascript\" src=\"/js/echarts/echarts.min.js\"></script>\n<script type=\"text/javascript\" src=\"/js/echarts/china.js\"></script>\n<script type=\"text/javascript\" src=\"/js/src/chinamap.js\"></script>","source":"_posts/chinamap.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: false\ntoc_number: false\ntop: 0\ntags:\n  - map\ncategories:\n  - life\nabbrlink: '86e5'\ndate: 2021-08-18 00:00:00\nsubtitle:\n---\n\n<div id=\"chinaMap\" style=\"width: 100%;height:600px;\"></div>\n<script type=\"text/javascript\" src=\"/js/echarts/echarts.min.js\"></script>\n<script type=\"text/javascript\" src=\"/js/echarts/china.js\"></script>\n<script type=\"text/javascript\" src=\"/js/src/chinamap.js\"></script>","slug":"chinamap","published":1,"updated":"2022-04-23T08:54:10.182Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweem000okh6zbdy68yey","content":"<div id=\"chinaMap\" style=\"width: 100%;height:600px;\"></div>\n<script type=\"text/javascript\" src=\"/js/echarts/echarts.min.js\"></script>\n<script type=\"text/javascript\" src=\"/js/echarts/china.js\"></script>\n<script type=\"text/javascript\" src=\"/js/src/chinamap.js\"></script>","site":{"data":{}},"excerpt":"","more":"<div id=\"chinaMap\" style=\"width: 100%;height:600px;\"></div>\n<script type=\"text/javascript\" src=\"/js/echarts/echarts.min.js\"></script>\n<script type=\"text/javascript\" src=\"/js/echarts/china.js\"></script>\n<script type=\"text/javascript\" src=\"/js/src/chinamap.js\"></script>"},{"title":"Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"9f70","date":"2021-06-03T16:00:00.000Z","_content":"\n#### git push\n\nremote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.\n\n#### \n\n1. ###### github  Settings  Developer settings  Personal access tokens  Generate new token\n\n2. ###### token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\n\n    ```\n    git remote set-url origin https://$new-token@github.com/$username/$repo-name.git\n    ```\n\n3. ###### push","source":"_posts/git-push-error.md","raw":"---\ntitle: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: \ntags:\n  - git\ncategories:\n  - work\nabbrlink: 9f70\ndate: 2021-06-04 00:00:00\n---\n\n#### git push\n\nremote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.\n\n#### \n\n1. ###### github  Settings  Developer settings  Personal access tokens  Generate new token\n\n2. ###### token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\n\n    ```\n    git remote set-url origin https://$new-token@github.com/$username/$repo-name.git\n    ```\n\n3. ###### push","slug":"git-push-error","published":1,"updated":"2022-04-23T08:53:52.245Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmween000rkh6za0jh3rau","content":"<h4 id=\"git-push\"><a href=\"#git-push\" class=\"headerlink\" title=\"git push\"></a>git push</h4><p>remote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><h6 id=\"github--Settings--Developer-settings--Personal-access-tokens--Generate-new-token\"><a href=\"#github--Settings--Developer-settings--Personal-access-tokens--Generate-new-token\" class=\"headerlink\" title=\"github  Settings  Developer settings  Personal access tokens  Generate new token\"></a>github  Settings  Developer settings  Personal access tokens  Generate new token</h6></li>\n<li><h6 id=\"tokenghp-YVupNqZjSNU0wB1xu61jqOjAOEHcs826HsTK\"><a href=\"#tokenghp-YVupNqZjSNU0wB1xu61jqOjAOEHcs826HsTK\" class=\"headerlink\" title=\"token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\"></a>token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</h6> <figure class=\"highlight dsconfig\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">git </span><span class=\"string\">remote </span><span class=\"built_in\">set-url</span> <span class=\"string\">origin </span><span class=\"string\">https:</span>//$<span class=\"string\">new-token@</span><span class=\"string\">github.</span><span class=\"string\">com/</span>$<span class=\"string\">username/</span>$<span class=\"string\">repo-name.</span><span class=\"string\">git</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"push\"><a href=\"#push\" class=\"headerlink\" title=\"push\"></a>push</h6></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h4 id=\"git-push\"><a href=\"#git-push\" class=\"headerlink\" title=\"git push\"></a>git push</h4><p>remote: Support for password authentication was removed on August 13, 2021. Please use a personal access token instead.</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><h6 id=\"github--Settings--Developer-settings--Personal-access-tokens--Generate-new-token\"><a href=\"#github--Settings--Developer-settings--Personal-access-tokens--Generate-new-token\" class=\"headerlink\" title=\"github  Settings  Developer settings  Personal access tokens  Generate new token\"></a>github  Settings  Developer settings  Personal access tokens  Generate new token</h6></li>\n<li><h6 id=\"tokenghp-YVupNqZjSNU0wB1xu61jqOjAOEHcs826HsTK\"><a href=\"#tokenghp-YVupNqZjSNU0wB1xu61jqOjAOEHcs826HsTK\" class=\"headerlink\" title=\"token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\"></a>token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</h6> <figure class=\"highlight dsconfig\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">git </span><span class=\"string\">remote </span><span class=\"built_in\">set-url</span> <span class=\"string\">origin </span><span class=\"string\">https:</span>//$<span class=\"string\">new-token@</span><span class=\"string\">github.</span><span class=\"string\">com/</span>$<span class=\"string\">username/</span>$<span class=\"string\">repo-name.</span><span class=\"string\">git</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"push\"><a href=\"#push\" class=\"headerlink\" title=\"push\"></a>push</h6></li>\n</ol>\n"},{"title":"git ","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"6186","date":"2020-11-25T16:00:00.000Z","_content":"\n1. ###### \n\n    ```\n    git log //\n    git reset --hard $commit\n    ```\n\n2. ###### \n\n    ```\n    git checkout -b temp            // \n    git push origin temp:temp       // pushtemp\n    git push origin --delete main   // main\n    git branch -d main              // main\n    ```\n\n3. ###### \n\n    ```\n    git checkout -b main            // main\n    git push origin main            // main\n    git branch -d temp\t\t\t\t// \n    git push origin --delete temp\t// \n    ```\n\n    > ###### github\n    >\n    > \trepo  Settings  Branches  Switch to another branch","source":"_posts/git-reset.md","raw":"---\ntitle: git \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - git\ncategories:\n  - work\nabbrlink: '6186'\ndate: 2020-11-26 00:00:00\n---\n\n1. ###### \n\n    ```\n    git log //\n    git reset --hard $commit\n    ```\n\n2. ###### \n\n    ```\n    git checkout -b temp            // \n    git push origin temp:temp       // pushtemp\n    git push origin --delete main   // main\n    git branch -d main              // main\n    ```\n\n3. ###### \n\n    ```\n    git checkout -b main            // main\n    git push origin main            // main\n    git branch -d temp\t\t\t\t// \n    git push origin --delete temp\t// \n    ```\n\n    > ###### github\n    >\n    > \trepo  Settings  Branches  Switch to another branch","slug":"git-reset","published":1,"updated":"2022-04-23T08:53:46.153Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweep000wkh6z4alr5exx","content":"<ol>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built-in\">log</span> <span class=\"comment\">//</span></span><br><span class=\"line\">git reset --hard <span class=\"symbol\">$</span>commit</span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b temp            <span class=\"comment\">// </span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin temp:temp       <span class=\"comment\">// pushtemp</span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin --<span class=\"keyword\">delete</span> main   <span class=\"comment\">// main</span></span><br><span class=\"line\">git branch -d main              <span class=\"comment\">// main</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b main            <span class=\"comment\">// main</span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin main            <span class=\"comment\">// main</span></span><br><span class=\"line\">git branch -d temp\t\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin --<span class=\"keyword\">delete</span> temp\t<span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<h6 id=\"github\"><a href=\"#github\" class=\"headerlink\" title=\"github\"></a>github</h6><pre><code>repo  Settings  Branches  Switch to another branch</code></pre></blockquote>\n</li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<ol>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git <span class=\"built-in\">log</span> <span class=\"comment\">//</span></span><br><span class=\"line\">git reset --hard <span class=\"symbol\">$</span>commit</span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b temp            <span class=\"comment\">// </span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin temp:temp       <span class=\"comment\">// pushtemp</span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin --<span class=\"keyword\">delete</span> main   <span class=\"comment\">// main</span></span><br><span class=\"line\">git branch -d main              <span class=\"comment\">// main</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><h6 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h6> <figure class=\"highlight gauss\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">git checkout -b main            <span class=\"comment\">// main</span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin main            <span class=\"comment\">// main</span></span><br><span class=\"line\">git branch -d temp\t\t\t\t<span class=\"comment\">// </span></span><br><span class=\"line\">git <span class=\"keyword\">push</span> origin --<span class=\"keyword\">delete</span> temp\t<span class=\"comment\">// </span></span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<h6 id=\"github\"><a href=\"#github\" class=\"headerlink\" title=\"github\"></a>github</h6><pre><code>repo  Settings  Branches  Switch to another branch</code></pre></blockquote>\n</li>\n</ol>\n"},{"title":"GitpushGithubGitee","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"1af5","date":"2020-12-17T16:00:00.000Z","subtitle":null,"_content":"\n### \n\nGithubGiteeGithubGiteepushGithubGitee\n\n### 1. GiteeGithub\n\ngitee\n![create_gitee_repo](/img/1-work/tools/create_gitee_repo.png)\n\ngithubhttps\n![import-github-repo](/img/1-work/tools/import-github-repo.png)\n\n\n\n### 2. Gitee.git\n\nGitee\n`git clone $`\n\ngitorigingit remote\ngiteeorigin\n`git remote set-url --add origin $gitee`\n\ngithuborigin\n`git remote set-url --add origin $github`\n\n.git/config\n```\n[remote \"origin\"]\n \turl = https://gitee.com/$gitee\n \tfetch = +refs/heads/*:refs/remotes/origin/*\n \turl = https://github.com/$github\n```\n\n### 3. push\n\npush\n\n#### push\n\n\n`git config credential.helper store`\n\n","source":"_posts/git-push-two-repo.md","raw":"---\ntitle: GitpushGithubGitee\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - git\ncategories:\n  - work\nabbrlink: 1af5\ndate: 2020-12-18 00:00:00\nsubtitle:\n---\n\n### \n\nGithubGiteeGithubGiteepushGithubGitee\n\n### 1. GiteeGithub\n\ngitee\n![create_gitee_repo](/img/1-work/tools/create_gitee_repo.png)\n\ngithubhttps\n![import-github-repo](/img/1-work/tools/import-github-repo.png)\n\n\n\n### 2. Gitee.git\n\nGitee\n`git clone $`\n\ngitorigingit remote\ngiteeorigin\n`git remote set-url --add origin $gitee`\n\ngithuborigin\n`git remote set-url --add origin $github`\n\n.git/config\n```\n[remote \"origin\"]\n \turl = https://gitee.com/$gitee\n \tfetch = +refs/heads/*:refs/remotes/origin/*\n \turl = https://github.com/$github\n```\n\n### 3. push\n\npush\n\n#### push\n\n\n`git config credential.helper store`\n\n","slug":"git-push-two-repo","published":1,"updated":"2021-11-10T13:43:16.136Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweeq000zkh6z9bvm9cno","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GithubGiteeGithubGiteepushGithubGitee</p>\n<h3 id=\"1-GiteeGithub\"><a href=\"#1-GiteeGithub\" class=\"headerlink\" title=\"1. GiteeGithub\"></a>1. GiteeGithub</h3><p>gitee<br><img src=\"/img/1-work/tools/create_gitee_repo.png\" alt=\"create_gitee_repo\"></p>\n<p>githubhttps<br><img src=\"/img/1-work/tools/import-github-repo.png\" alt=\"import-github-repo\"></p>\n<p></p>\n<h3 id=\"2-Gitee-git\"><a href=\"#2-Gitee-git\" class=\"headerlink\" title=\"2. Gitee.git\"></a>2. Gitee.git</h3><p>Gitee<br><code>git clone $</code></p>\n<p>gitorigingit remote<br>giteeorigin<br><code>git remote set-url --add origin $gitee</code></p>\n<p>githuborigin<br><code>git remote set-url --add origin $github</code></p>\n<p>.git/config</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[remote <span class=\"string\">\"origin\"</span>]</span><br><span class=\"line\"> \turl = <span class=\"symbol\">https:</span>/<span class=\"regexp\">/gitee.com/</span><span class=\"variable\">$</span>gitee</span><br><span class=\"line\"> \tfetch = +refs/heads/*<span class=\"symbol\">:refs/remotes/origin/*</span></span><br><span class=\"line\"> \turl = <span class=\"symbol\">https:</span>/<span class=\"regexp\">/github.com/</span><span class=\"variable\">$</span>github</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-push\"><a href=\"#3-push\" class=\"headerlink\" title=\"3. push\"></a>3. push</h3><p>push</p>\n<h4 id=\"push\"><a href=\"#push\" class=\"headerlink\" title=\"push\"></a>push</h4><p><br><code>git config credential.helper store</code></p>\n<p></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>GithubGiteeGithubGiteepushGithubGitee</p>\n<h3 id=\"1-GiteeGithub\"><a href=\"#1-GiteeGithub\" class=\"headerlink\" title=\"1. GiteeGithub\"></a>1. GiteeGithub</h3><p>gitee<br><img src=\"/img/1-work/tools/create_gitee_repo.png\" alt=\"create_gitee_repo\"></p>\n<p>githubhttps<br><img src=\"/img/1-work/tools/import-github-repo.png\" alt=\"import-github-repo\"></p>\n<p></p>\n<h3 id=\"2-Gitee-git\"><a href=\"#2-Gitee-git\" class=\"headerlink\" title=\"2. Gitee.git\"></a>2. Gitee.git</h3><p>Gitee<br><code>git clone $</code></p>\n<p>gitorigingit remote<br>giteeorigin<br><code>git remote set-url --add origin $gitee</code></p>\n<p>githuborigin<br><code>git remote set-url --add origin $github</code></p>\n<p>.git/config</p>\n<figure class=\"highlight elixir\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">[remote <span class=\"string\">\"origin\"</span>]</span><br><span class=\"line\"> \turl = <span class=\"symbol\">https:</span>/<span class=\"regexp\">/gitee.com/</span><span class=\"variable\">$</span>gitee</span><br><span class=\"line\"> \tfetch = +refs/heads/*<span class=\"symbol\">:refs/remotes/origin/*</span></span><br><span class=\"line\"> \turl = <span class=\"symbol\">https:</span>/<span class=\"regexp\">/github.com/</span><span class=\"variable\">$</span>github</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"3-push\"><a href=\"#3-push\" class=\"headerlink\" title=\"3. push\"></a>3. push</h3><p>push</p>\n<h4 id=\"push\"><a href=\"#push\" class=\"headerlink\" title=\"push\"></a>push</h4><p><br><code>git config credential.helper store</code></p>\n<p></p>\n"},{"title":"IO","header-img":"/img/header_img/dawn.jpg","catalog":true,"top":null,"abbrlink":"1af5","date":"2021-03-24T07:42:45.000Z","subtitle":null,"_content":"\n## IO\n\n### IO\n\n> \t\tIOread&writereadwritereadwriteIOKernel\n\n#### \n\n\t\t\n\n**IO**\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gous8df2kgj30h0096mxz.jpg)\n\nJavasocket\n\n- Linux\n- JavareadLinuxJava\n- Java\n- Javawrite\n- LinuxIO\n\n### IO\n\n> ****IOIO\n>\n> ****IOIOIOIO\n\n#### 1. IOBlocking IO\n\n\t\tJavasocketIOJava**IO**Java****\n\n**IO**\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gov1uvelijj30i30bbgph.jpg)\n\n- IOIO\n\n- IOCPU\n\n- IOIOIO\n\n#### 2. IONon-blocking IO\n\n> NIOJavaNIONew IOJavaNIOIONIONone Blocking IOIOIO Multiplexing\n\n\t\tNIOIO\n\n\t\t1. ****\n\n\t\t2. ********\n\n**IO***()*\n\n![image](https://tva4.sinaimg.cn/large/006YzKDNgy1goxfc4wvqoj30ll0fmgmt.jpg)\n\n- IO****IO****IO\n\n- IO****IO\n\n- IO****CPU\n\n#### 3. IOIO Multiplexing\n\n> IO\n\n\t\tIOIOLinuxselect/epollsocketsocket/IO\n\n**IO**\n\n![image](https://tvax3.sinaimg.cn/large/006YzKDNly1gov3zz1xp6j30h80bhdkc.jpg)\n\n- IO****SystemCallselect/epollIOIOselect/epollselect/epollselect/epollIOsocketJavaSelector**socket******\n- IO****Connection*JavaNIONew IONettyIOLinuxepoll*\n- IO****select/epollIO\n\n##### select: \n\n\t\tselect  *()*\n\n![20210326180007](https://tva2.sinaimg.cn/large/006YzKDNgy1goxgnhkba8g30fa0b4x6p.gif)\n\n1.  socket  list \n2.  select list \n3.  select  list\n\n\n\n\t1. select  fd \n\n\t2. select \n\n\t3. select \n\n##### epoll:\n\n\t\t select :\n\n  1. \n\n  2.  IO \n\n  3.  IO \n\n     *()*\n\n     ![20210326181258](https://tvax2.sinaimg.cn/large/006YzKDNgy1goxh0qffnzg30fa0b4e81.gif)\n\n     **** while  +  while  http  http  rpc \n\n#### 4. IOAsynchronous IO\n\n> \n\n\t\tIOreadSignalread\n\n**IO**\n\n![image](https://tvax3.sinaimg.cn/large/006YzKDNly1gov4h3y1m6j30go0c2q7m.jpg)\n\n- IO********IOIOIOIO\n- IO\n\n>         WindowsIOCPIOLinuxIO2.6epollIOLinux**IO**\n\n### \n\n> LinuxLinux10241024socket\n\n#### \n\n\t\tLinuxFile DescriptorIOsocketLinux`ulimit -n`Linux1024\n\n\t\tQQSocket/File:Can't open so many files\n\n#### \n\n\t\t`ulimit -n 1000000`1048576 ulimit/etc/rc.local\n\n```\nulimit -SHn 1000000\n```\n\n\t\t-S-H-S-Hroot100Warning\n\n\t\tLinux/etc/security/limits.conf\n\n```\nsoft nofile 1000000\nhard nofile 1000000\n```\n\nsoft nofilehard nofileunlimited\n\n","source":"_posts/io.md","raw":"---\ntitle: IO\nheader-img: /img/header_img/dawn.jpg\ncatalog: true\ntop:\ntags:\n  - IO\ncategories:\n  - work\nabbrlink: 1af5\ndate: 2021-3-24 15:42:45\nsubtitle:\n---\n\n## IO\n\n### IO\n\n> \t\tIOread&writereadwritereadwriteIOKernel\n\n#### \n\n\t\t\n\n**IO**\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gous8df2kgj30h0096mxz.jpg)\n\nJavasocket\n\n- Linux\n- JavareadLinuxJava\n- Java\n- Javawrite\n- LinuxIO\n\n### IO\n\n> ****IOIO\n>\n> ****IOIOIOIO\n\n#### 1. IOBlocking IO\n\n\t\tJavasocketIOJava**IO**Java****\n\n**IO**\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gov1uvelijj30i30bbgph.jpg)\n\n- IOIO\n\n- IOCPU\n\n- IOIOIO\n\n#### 2. IONon-blocking IO\n\n> NIOJavaNIONew IOJavaNIOIONIONone Blocking IOIOIO Multiplexing\n\n\t\tNIOIO\n\n\t\t1. ****\n\n\t\t2. ********\n\n**IO***()*\n\n![image](https://tva4.sinaimg.cn/large/006YzKDNgy1goxfc4wvqoj30ll0fmgmt.jpg)\n\n- IO****IO****IO\n\n- IO****IO\n\n- IO****CPU\n\n#### 3. IOIO Multiplexing\n\n> IO\n\n\t\tIOIOLinuxselect/epollsocketsocket/IO\n\n**IO**\n\n![image](https://tvax3.sinaimg.cn/large/006YzKDNly1gov3zz1xp6j30h80bhdkc.jpg)\n\n- IO****SystemCallselect/epollIOIOselect/epollselect/epollselect/epollIOsocketJavaSelector**socket******\n- IO****Connection*JavaNIONew IONettyIOLinuxepoll*\n- IO****select/epollIO\n\n##### select: \n\n\t\tselect  *()*\n\n![20210326180007](https://tva2.sinaimg.cn/large/006YzKDNgy1goxgnhkba8g30fa0b4x6p.gif)\n\n1.  socket  list \n2.  select list \n3.  select  list\n\n\n\n\t1. select  fd \n\n\t2. select \n\n\t3. select \n\n##### epoll:\n\n\t\t select :\n\n  1. \n\n  2.  IO \n\n  3.  IO \n\n     *()*\n\n     ![20210326181258](https://tvax2.sinaimg.cn/large/006YzKDNgy1goxh0qffnzg30fa0b4e81.gif)\n\n     **** while  +  while  http  http  rpc \n\n#### 4. IOAsynchronous IO\n\n> \n\n\t\tIOreadSignalread\n\n**IO**\n\n![image](https://tvax3.sinaimg.cn/large/006YzKDNly1gov4h3y1m6j30go0c2q7m.jpg)\n\n- IO********IOIOIOIO\n- IO\n\n>         WindowsIOCPIOLinuxIO2.6epollIOLinux**IO**\n\n### \n\n> LinuxLinux10241024socket\n\n#### \n\n\t\tLinuxFile DescriptorIOsocketLinux`ulimit -n`Linux1024\n\n\t\tQQSocket/File:Can't open so many files\n\n#### \n\n\t\t`ulimit -n 1000000`1048576 ulimit/etc/rc.local\n\n```\nulimit -SHn 1000000\n```\n\n\t\t-S-H-S-Hroot100Warning\n\n\t\tLinux/etc/security/limits.conf\n\n```\nsoft nofile 1000000\nhard nofile 1000000\n```\n\nsoft nofilehard nofileunlimited\n\n","slug":"io","published":1,"updated":"2021-11-10T13:43:16.137Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweer0013kh6z2aa01snt","content":"<h2 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h2><h3 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h3><blockquote>\n<p>        IOread&amp;writereadwritereadwriteIOKernel</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        </p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gous8df2kgj30h0096mxz.jpg\" alt=\"image\"></p>\n<p>Javasocket</p>\n<ul>\n<li>Linux</li>\n<li>JavareadLinuxJava</li>\n<li>Java</li>\n<li>Javawrite</li>\n<li>LinuxIO</li>\n</ul>\n<h3 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h3><blockquote>\n<p><strong></strong>IOIO</p>\n<p><strong></strong>IOIOIOIO</p>\n</blockquote>\n<h4 id=\"1-IOBlocking-IO\"><a href=\"#1-IOBlocking-IO\" class=\"headerlink\" title=\"1. IOBlocking IO\"></a>1. IOBlocking IO</h4><p>        JavasocketIOJava<strong>IO</strong>Java<strong></strong></p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gov1uvelijj30i30bbgph.jpg\" alt=\"image\"></p>\n<ul>\n<li><p>IOIO</p>\n</li>\n<li><p>IOCPU</p>\n</li>\n<li><p>IOIOIO</p>\n</li>\n</ul>\n<h4 id=\"2-IONon-blocking-IO\"><a href=\"#2-IONon-blocking-IO\" class=\"headerlink\" title=\"2. IONon-blocking IO\"></a>2. IONon-blocking IO</h4><blockquote>\n<p>NIOJavaNIONew IOJavaNIOIONIONone Blocking IOIOIO Multiplexing</p>\n</blockquote>\n<p>        NIOIO</p>\n<p>        1. <strong></strong></p>\n<p>        2. <strong></strong><strong></strong></p>\n<p><strong>IO</strong><em>()</em></p>\n<p><img src=\"https://tva4.sinaimg.cn/large/006YzKDNgy1goxfc4wvqoj30ll0fmgmt.jpg\" alt=\"image\"></p>\n<ul>\n<li><p>IO<strong></strong>IO<strong></strong>IO</p>\n</li>\n<li><p>IO<strong></strong>IO</p>\n</li>\n<li><p>IO<strong></strong>CPU</p>\n</li>\n</ul>\n<h4 id=\"3-IOIO-Multiplexing\"><a href=\"#3-IOIO-Multiplexing\" class=\"headerlink\" title=\"3. IOIO Multiplexing\"></a>3. IOIO Multiplexing</h4><blockquote>\n<p>IO</p>\n</blockquote>\n<p>        IOIOLinuxselect/epollsocketsocket/IO</p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gov3zz1xp6j30h80bhdkc.jpg\" alt=\"image\"></p>\n<ul>\n<li>IO<strong></strong>SystemCallselect/epollIOIOselect/epollselect/epollselect/epollIOsocketJavaSelector<strong>socket</strong><strong></strong></li>\n<li>IO<strong></strong>Connection<em>JavaNIONew IONettyIOLinuxepoll</em></li>\n<li>IO<strong></strong>select/epollIO</li>\n</ul>\n<h5 id=\"select\"><a href=\"#select\" class=\"headerlink\" title=\"select:\"></a>select:</h5><p>        select  <em>()</em></p>\n<p><img src=\"https://tva2.sinaimg.cn/large/006YzKDNgy1goxgnhkba8g30fa0b4x6p.gif\" alt=\"20210326180007\"></p>\n<ol>\n<li> socket  list </li>\n<li> select list </li>\n<li> select  list</li>\n</ol>\n<p></p>\n<p>    1. select  fd </p>\n<p>    2. select </p>\n<p>    3. select </p>\n<h5 id=\"epoll\"><a href=\"#epoll\" class=\"headerlink\" title=\"epoll:\"></a>epoll:</h5><p>         select :</p>\n<ol>\n<li><p></p>\n</li>\n<li><p> IO </p>\n</li>\n<li><p> IO </p>\n<p><em>()</em></p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNgy1goxh0qffnzg30fa0b4e81.gif\" alt=\"20210326181258\"></p>\n<p><strong></strong> while  +  while  http  http  rpc </p>\n</li>\n</ol>\n<h4 id=\"4-IOAsynchronous-IO\"><a href=\"#4-IOAsynchronous-IO\" class=\"headerlink\" title=\"4. IOAsynchronous IO\"></a>4. IOAsynchronous IO</h4><blockquote>\n<p></p>\n</blockquote>\n<p>        IOreadSignalread</p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gov4h3y1m6j30go0c2q7m.jpg\" alt=\"image\"></p>\n<ul>\n<li>IO<strong></strong><strong></strong>IOIOIOIO</li>\n<li>IO</li>\n</ul>\n<blockquote>\n<p>        WindowsIOCPIOLinuxIO2.6epollIOLinux<strong>IO</strong></p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>LinuxLinux10241024socket</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        LinuxFile DescriptorIOsocketLinux<code>ulimit -n</code>Linux1024</p>\n<p>        QQSocket/File:Cant open so many files</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        <code>ulimit -n 1000000</code>1048576 ulimit/etc/rc.local</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ulimit -SHn <span class=\"number\">1000000</span></span><br></pre></td></tr></table></figure>\n\n<p>        -S-H-S-Hroot100Warning</p>\n<p>        Linux/etc/security/limits.conf</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">soft nofile <span class=\"number\">1000000</span></span><br><span class=\"line\">hard nofile <span class=\"number\">1000000</span></span><br></pre></td></tr></table></figure>\n\n<p>soft nofilehard nofileunlimited</p>\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h2><h3 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h3><blockquote>\n<p>        IOread&amp;writereadwritereadwriteIOKernel</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        </p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gous8df2kgj30h0096mxz.jpg\" alt=\"image\"></p>\n<p>Javasocket</p>\n<ul>\n<li>Linux</li>\n<li>JavareadLinuxJava</li>\n<li>Java</li>\n<li>Javawrite</li>\n<li>LinuxIO</li>\n</ul>\n<h3 id=\"IO\"><a href=\"#IO\" class=\"headerlink\" title=\"IO\"></a>IO</h3><blockquote>\n<p><strong></strong>IOIO</p>\n<p><strong></strong>IOIOIOIO</p>\n</blockquote>\n<h4 id=\"1-IOBlocking-IO\"><a href=\"#1-IOBlocking-IO\" class=\"headerlink\" title=\"1. IOBlocking IO\"></a>1. IOBlocking IO</h4><p>        JavasocketIOJava<strong>IO</strong>Java<strong></strong></p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gov1uvelijj30i30bbgph.jpg\" alt=\"image\"></p>\n<ul>\n<li><p>IOIO</p>\n</li>\n<li><p>IOCPU</p>\n</li>\n<li><p>IOIOIO</p>\n</li>\n</ul>\n<h4 id=\"2-IONon-blocking-IO\"><a href=\"#2-IONon-blocking-IO\" class=\"headerlink\" title=\"2. IONon-blocking IO\"></a>2. IONon-blocking IO</h4><blockquote>\n<p>NIOJavaNIONew IOJavaNIOIONIONone Blocking IOIOIO Multiplexing</p>\n</blockquote>\n<p>        NIOIO</p>\n<p>        1. <strong></strong></p>\n<p>        2. <strong></strong><strong></strong></p>\n<p><strong>IO</strong><em>()</em></p>\n<p><img src=\"https://tva4.sinaimg.cn/large/006YzKDNgy1goxfc4wvqoj30ll0fmgmt.jpg\" alt=\"image\"></p>\n<ul>\n<li><p>IO<strong></strong>IO<strong></strong>IO</p>\n</li>\n<li><p>IO<strong></strong>IO</p>\n</li>\n<li><p>IO<strong></strong>CPU</p>\n</li>\n</ul>\n<h4 id=\"3-IOIO-Multiplexing\"><a href=\"#3-IOIO-Multiplexing\" class=\"headerlink\" title=\"3. IOIO Multiplexing\"></a>3. IOIO Multiplexing</h4><blockquote>\n<p>IO</p>\n</blockquote>\n<p>        IOIOLinuxselect/epollsocketsocket/IO</p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gov3zz1xp6j30h80bhdkc.jpg\" alt=\"image\"></p>\n<ul>\n<li>IO<strong></strong>SystemCallselect/epollIOIOselect/epollselect/epollselect/epollIOsocketJavaSelector<strong>socket</strong><strong></strong></li>\n<li>IO<strong></strong>Connection<em>JavaNIONew IONettyIOLinuxepoll</em></li>\n<li>IO<strong></strong>select/epollIO</li>\n</ul>\n<h5 id=\"select\"><a href=\"#select\" class=\"headerlink\" title=\"select:\"></a>select:</h5><p>        select  <em>()</em></p>\n<p><img src=\"https://tva2.sinaimg.cn/large/006YzKDNgy1goxgnhkba8g30fa0b4x6p.gif\" alt=\"20210326180007\"></p>\n<ol>\n<li> socket  list </li>\n<li> select list </li>\n<li> select  list</li>\n</ol>\n<p></p>\n<p>    1. select  fd </p>\n<p>    2. select </p>\n<p>    3. select </p>\n<h5 id=\"epoll\"><a href=\"#epoll\" class=\"headerlink\" title=\"epoll:\"></a>epoll:</h5><p>         select :</p>\n<ol>\n<li><p></p>\n</li>\n<li><p> IO </p>\n</li>\n<li><p> IO </p>\n<p><em>()</em></p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNgy1goxh0qffnzg30fa0b4e81.gif\" alt=\"20210326181258\"></p>\n<p><strong></strong> while  +  while  http  http  rpc </p>\n</li>\n</ol>\n<h4 id=\"4-IOAsynchronous-IO\"><a href=\"#4-IOAsynchronous-IO\" class=\"headerlink\" title=\"4. IOAsynchronous IO\"></a>4. IOAsynchronous IO</h4><blockquote>\n<p></p>\n</blockquote>\n<p>        IOreadSignalread</p>\n<p><strong>IO</strong></p>\n<p><img src=\"https://tvax3.sinaimg.cn/large/006YzKDNly1gov4h3y1m6j30go0c2q7m.jpg\" alt=\"image\"></p>\n<ul>\n<li>IO<strong></strong><strong></strong>IOIOIOIO</li>\n<li>IO</li>\n</ul>\n<blockquote>\n<p>        WindowsIOCPIOLinuxIO2.6epollIOLinux<strong>IO</strong></p>\n</blockquote>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>LinuxLinux10241024socket</p>\n</blockquote>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        LinuxFile DescriptorIOsocketLinux<code>ulimit -n</code>Linux1024</p>\n<p>        QQSocket/File:Cant open so many files</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>        <code>ulimit -n 1000000</code>1048576 ulimit/etc/rc.local</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ulimit -SHn <span class=\"number\">1000000</span></span><br></pre></td></tr></table></figure>\n\n<p>        -S-H-S-Hroot100Warning</p>\n<p>        Linux/etc/security/limits.conf</p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">soft nofile <span class=\"number\">1000000</span></span><br><span class=\"line\">hard nofile <span class=\"number\">1000000</span></span><br></pre></td></tr></table></figure>\n\n<p>soft nofilehard nofileunlimited</p>\n"},{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"7b21","date":"2020-12-18T16:00:00.000Z","subtitle":null,"_content":"\n### ","source":"_posts/read-test.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - finance\ncategories:\n  - life\nabbrlink: 7b21\ndate: 2020-12-19 00:00:00\nsubtitle:\n---\n\n### ","slug":"read-test","published":1,"updated":"2021-11-10T13:43:16.138Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmwees0016kh6z9am6emp7","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>"},{"title":"nginx127.0.0.1localhost","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":0,"abbrlink":"9f48","date":"2021-10-27T16:00:00.000Z","subtitle":null,"_content":"### nginx127.0.0.1localhost\n\nvuespringbootnginxnginx\n\n```js\nserver {\n    listen 8090;\n    server_name localhost;\n    #\n    location /aclui { \n    \tproxy_pass   http://127.0.0.1:8031/;\n    }\n    #\n    location /aclrs {\n    \tproxy_pass   http://127.0.0.1:8032/;\n    }\n    ...\n}\n```\n\n`localhost:8090/aclui`F12200response`this request has no response data`\n\n\n```java\n401 Unauthorized: [{\"code\":\"401\",\"content\": { \"unauthorized\":\"token is invalidate\"}}] \n```\n\nnginx error.log\n\n```verilog\n2021/11/04 18:08:44 [error] 2540#8504: *7200 upstream prematurely closed connection while reading response header from upstream, client: 127.0.0.1, server: localhost, request: \"GET /aclrs/acl/option/set?option=2 HTTP/1.1\", upstream: \"http://127.0.0.1:8096//acl/option/set?option=2\", host: \"localhost:8090\", referrer: \"http://localhost:8090/aclui/view/acl/option/aclOptionCfg.html\n```\n\nnginx`127.0.0.1``localhost``this request has no response data``127.0.0.1:8090/aclui`","source":"_posts/nginx-cors.md","raw":"---\ntitle: nginx127.0.0.1localhost\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: 0\ntags:\n  - nginx\ncategories:\n  - work\nabbrlink: 9f48\ndate: 2021-10-28 00:00:00\nsubtitle:\n---\n### nginx127.0.0.1localhost\n\nvuespringbootnginxnginx\n\n```js\nserver {\n    listen 8090;\n    server_name localhost;\n    #\n    location /aclui { \n    \tproxy_pass   http://127.0.0.1:8031/;\n    }\n    #\n    location /aclrs {\n    \tproxy_pass   http://127.0.0.1:8032/;\n    }\n    ...\n}\n```\n\n`localhost:8090/aclui`F12200response`this request has no response data`\n\n\n```java\n401 Unauthorized: [{\"code\":\"401\",\"content\": { \"unauthorized\":\"token is invalidate\"}}] \n```\n\nnginx error.log\n\n```verilog\n2021/11/04 18:08:44 [error] 2540#8504: *7200 upstream prematurely closed connection while reading response header from upstream, client: 127.0.0.1, server: localhost, request: \"GET /aclrs/acl/option/set?option=2 HTTP/1.1\", upstream: \"http://127.0.0.1:8096//acl/option/set?option=2\", host: \"localhost:8090\", referrer: \"http://localhost:8090/aclui/view/acl/option/aclOptionCfg.html\n```\n\nnginx`127.0.0.1``localhost``this request has no response data``127.0.0.1:8090/aclui`","slug":"nginx-cors","published":1,"updated":"2021-11-10T13:43:16.138Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweet0019kh6zf5oo7sm1","content":"<h3 id=\"nginx127-0-0-1localhost\"><a href=\"#nginx127-0-0-1localhost\" class=\"headerlink\" title=\"nginx127.0.0.1localhost\"></a>nginx127.0.0.1localhost</h3><p>vuespringbootnginxnginx</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen <span class=\"number\">8090</span>;</span><br><span class=\"line\">    server_name localhost;</span><br><span class=\"line\">    #</span><br><span class=\"line\">    location /aclui &#123; </span><br><span class=\"line\">    \tproxy_pass   http:<span class=\"comment\">//127.0.0.1:8031/;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    #</span><br><span class=\"line\">    location /aclrs &#123;</span><br><span class=\"line\">    \tproxy_pass   http:<span class=\"comment\">//127.0.0.1:8032/;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>localhost:8090/aclui</code>F12200response<code>this request has no response data</code><br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">401</span> Unauthorized: [&#123;<span class=\"string\">\"code\"</span>:<span class=\"string\">\"401\"</span>,<span class=\"string\">\"content\"</span>: &#123; <span class=\"string\">\"unauthorized\"</span>:<span class=\"string\">\"token is invalidate\"</span>&#125;&#125;]</span><br></pre></td></tr></table></figure>\n\n<p>nginx error.log</p>\n<figure class=\"highlight verilog\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2021</span>/<span class=\"number\">11</span>/<span class=\"number\">04</span> <span class=\"number\">18</span>:<span class=\"number\">08</span>:<span class=\"number\">44</span> [error] <span class=\"number\">2540</span>#<span class=\"number\">8504</span>: *<span class=\"number\">7200</span> upstream prematurely closed connection <span class=\"keyword\">while</span> reading response header from upstream, client: <span class=\"number\">127</span><span class=\"variable\">.0</span><span class=\"variable\">.0</span><span class=\"variable\">.1</span>, server: localhost, request: <span class=\"string\">\"GET /aclrs/acl/option/set?option=2 HTTP/1.1\"</span>, upstream: <span class=\"string\">\"http://127.0.0.1:8096//acl/option/set?option=2\"</span>, host: <span class=\"string\">\"localhost:8090\"</span>, referrer: <span class=\"string\">\"http://localhost:8090/aclui/view/acl/option/aclOptionCfg.html</span></span><br></pre></td></tr></table></figure>\n\n<p>nginx<code>127.0.0.1</code><code>localhost</code><code>this request has no response data</code><code>127.0.0.1:8090/aclui</code></p>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"nginx127-0-0-1localhost\"><a href=\"#nginx127-0-0-1localhost\" class=\"headerlink\" title=\"nginx127.0.0.1localhost\"></a>nginx127.0.0.1localhost</h3><p>vuespringbootnginxnginx</p>\n<figure class=\"highlight js\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">server &#123;</span><br><span class=\"line\">    listen <span class=\"number\">8090</span>;</span><br><span class=\"line\">    server_name localhost;</span><br><span class=\"line\">    #</span><br><span class=\"line\">    location /aclui &#123; </span><br><span class=\"line\">    \tproxy_pass   http:<span class=\"comment\">//127.0.0.1:8031/;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    #</span><br><span class=\"line\">    location /aclrs &#123;</span><br><span class=\"line\">    \tproxy_pass   http:<span class=\"comment\">//127.0.0.1:8032/;</span></span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    ...</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><code>localhost:8090/aclui</code>F12200response<code>this request has no response data</code><br></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">401</span> Unauthorized: [&#123;<span class=\"string\">\"code\"</span>:<span class=\"string\">\"401\"</span>,<span class=\"string\">\"content\"</span>: &#123; <span class=\"string\">\"unauthorized\"</span>:<span class=\"string\">\"token is invalidate\"</span>&#125;&#125;]</span><br></pre></td></tr></table></figure>\n\n<p>nginx error.log</p>\n<figure class=\"highlight verilog\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"number\">2021</span>/<span class=\"number\">11</span>/<span class=\"number\">04</span> <span class=\"number\">18</span>:<span class=\"number\">08</span>:<span class=\"number\">44</span> [error] <span class=\"number\">2540</span>#<span class=\"number\">8504</span>: *<span class=\"number\">7200</span> upstream prematurely closed connection <span class=\"keyword\">while</span> reading response header from upstream, client: <span class=\"number\">127</span><span class=\"variable\">.0</span><span class=\"variable\">.0</span><span class=\"variable\">.1</span>, server: localhost, request: <span class=\"string\">\"GET /aclrs/acl/option/set?option=2 HTTP/1.1\"</span>, upstream: <span class=\"string\">\"http://127.0.0.1:8096//acl/option/set?option=2\"</span>, host: <span class=\"string\">\"localhost:8090\"</span>, referrer: <span class=\"string\">\"http://localhost:8090/aclui/view/acl/option/aclOptionCfg.html</span></span><br></pre></td></tr></table></figure>\n\n<p>nginx<code>127.0.0.1</code><code>localhost</code><code>this request has no response data</code><code>127.0.0.1:8090/aclui</code></p>\n"},{"title":"Java NIO","header-img":"/img/header_img/squirrel.jpg","catalog":true,"top":null,"abbrlink":"57bd","date":"2021-03-31T10:45:33.000Z","subtitle":null,"_content":"\n## Java NIO\n\n### NIO\n\n> 1.4Java IOIO1.4IOIOJava New IOJAVA NIOJava NIO IO\n\n**NIOOIOold IO**\n\n- OIOStream OrientedNIOBufferOriented\n- OIONIO\n- OIOSelectorNIO\n\nJava NIO Channel Buffer Selector\n\n#### 1. Channel\n\n\t\tOIOInput StreamOutput StreamNIONIOIOOIO\n\n#### 2. Selector\n\n> IO//\n\n\t\tIOselectIO/\n\n#### 3. Buffer\n\n\t\tChannelreadwrite\n\n### Buffer\n\n> Buffer\n\n#### Buffer\n\n\t\tBufferjava.nioNIO8ByteBufferCharBufferDoubleBufferFloatBufferIntBufferLongBufferShortBufferMappedByteBufferMappedByteBufferByteBufferByteBuffer\n\n#### Buffer\n\n\t\tBuffercapacitypositionlimitmark\n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gp33iz38e4j30kk05pt9v.jpg)\n\n#### Buffer\n\n1. **allocate()**\n\n    \t\tBuffernewallocate()capacity\n\n    ```java\n    IntBuffer intBuffer = intBuffer.allocate(10);\n    ```\n\n2. **put()**\n\n    ```java\n    intBuffer.put(1);\n    ```\n\n3. **flip()**\n\n    \t\tflip()flip()\n\n    ```java\n     public final Buffer flip() {\n         limit = position;\n         position = 0;\n         mark = -1;\n         return this;\n     }\n    ```\n\n    10intBuffer1position=1limit=10capacity=10position=0limit=1capacity=10\n\n    > Buffer.clear()Buffer.compact()\n\n    \n\n    ![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gp34tey3npj30g1071aay.jpg)\n\n4. **clear()**\n\n    \t\t\n\n    ```java\n    public final Buffer clear() {\n        position = 0;\n        limit = capacity;\n        mark = -1;\n    \treturn this;\n    }\n    ```\n\n5. **compact()**\n\n    \t\tBufferpositionlimitcapacity\n\n    ```java\n    public ByteBuffer compact() {\n        System.arraycopy(hb, ix(position()), hb, ix(0), remaining()); // \n        position(remaining()); // remaining()limit - position\n        limit(capacity()); // limitcapacity\n        discardMark(); // mark = -1\n        return this;\n    }\n    ```\n\n6. **get()**\n\n    \t\tpositionlimitposition==limitpositionBufferUnderflowException\n\n    ```java\n    byteBuffer.get();\n    ```\n\n7. **rewind()**\n\n    \t\trewind()rewind()\n\n    ```java\n    public final Buffer rewind() {\n        position = 0; // \n        mark = -1; // \n        return this;\n    }\n    ```\n\n    > rewind()flip()rewind()limitflip()limit\n\n8.  **mark( )reset( )**\n\n    \t\tBuffer.mark()Buffer.reset()3i= =2mark()positionmarkmark2resetmarkposition2\n\n**Buffer**\n\n```java\nIntBuffer intBuffer = intBuffer.allocate(10);\nintBuffer.put(1);\nintBuffer.flip();\nintBuffer.get();\nintBuffer.clear();||intBuffer.compact();\n```\n\n### Channel\n\n> NIOChannelJavaNIO Channel\n\n#### Channel\n\n1. FileChannel\n\n2. SocketChannelSocketTCP\n\n3. ServerSocketChannelTCPSocketChannel\n\n4. DatagramChannelUDP\n\n#### FileChannel\n\n> FileChannelFileChannel****\n\n1. **FileChannel**\n\n- \n\n    ```java\n    // \n    FileInputStream fis = new FileInputStream(srcFile);\n    // \n    FileChannel inChannel = fis.getChannel();\n    \n    // \n    FileOutputStream fos = new FileOutputStream(destFile);\n    // \n    FileChannel outChannel = fis.getChannel();\n    ```\n\n- RandomAccessFile\n\n    ```java\n    // RandomAccessFile\n    RandomAccessFile rafile = new RandomAccessFile(srcFile, \"rw\");\n    // \n    FileChannel raFileChannel = rafile.getChannel();\n    ```\n\n2. **FileChannel**\n\n    \t\t`public abstract int read(ByteBuffer src) throws IOException`ByteBuffer**ByteBufferByteBuffer**\n\n    ```java\n    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n    int length = -1;\n    while (-1 != (length = raFileChannel.read(byteBuffer))) {\n    // TODO\n    }\n    ```\n\n3. **FileChannel**\n\n    \t\t`public abstract int write(ByteBuffer src) throws IOException`**ByteBuffer**\n\n    ```java\n    // \n    byteBuffer.flip();\n    int outlength = 0;\n    while (0 != (outlength = raFileChannel.write(byteBuffer))) {\n    \tSystem.out.println(\"\" + outlength);\n    }\n    ```\n\n4. ****\n\n    ```java\n    inChannel.close();\n    ```\n\n5. ****\n\n    \t\tFileChannelforce()\n\n    ```java\n    inChannel.force(true);\n    ```\n\n#### SocketChannelServerSocketChannel\n\n> NIOSocketChannelServerSocketChannel****ServerSocketChannelSocketChannelSocketChannelSocketChannelOIOSocketServerSocketChannelOIOServerSocket\n\n1. **SocketChannel**\n\n    \t\t****SocketChannelopen()socketconnect()IP\n\n    ```java\n    // \n    SocketChannel socketChannel = SocketChannel.open();\n    // \n    socketChannel.configureBlocking(false);\n    // IP\n    socketChannel.connect(new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    ```\n\n    \t\tsocketChannel.connect\n\n    ```java\n    // \n    while (!socketChannel.finishConnect()) {\n    }\n    ```\n\n    \t\t****ServerSocketChannelaccept()\n\n    ```java\n    // ,key\n    ServerSocketChannel serverSocketChannel = ServerSocketChannelkey.channel();\n    // \n    SocketChannel socketChannel = serverSocketChannel.accept();\n    // \n    socketChannel.configureBlocking(false);\n    ```\n\n2. **SocketChannel**\n\n    \t\tFileChannel\n\n3. **SocketChannel**\n\n    \t\tFileChannel\n\n4. **SocketChannel**\n\n    \t\tSocketChannelshutdownOutput()-1socketChannel.close()\n\n    ```\n    // \n    socketChannel.shutdownOutput();\n    // \n    socketChannel.close();\n    ```\n\n#### DatagramChannel\n\n> DatagramChannelUDPSocketTCPUDPUDPIP\n\n1. **DatagramChannel**\n\n    \t\tDatagramChannelopen()\n\n    ```java\n    // \n    DatagramChannel datagramChannel = DatagramChannel.open();\n    // \n    datagramChannel.configureBlocking(false);\t\t\n    // IP\n    datagramChannel.socket().bind(new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    ```\n\n2. **DatagramChannel**\n\n    \t\treadreceive\n\n    ```java\n    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n    SocketAddress clientAddr = datagramChannel.receive(byteBuffer);\n    ```\n\n    \t\treceiveByteBuffer bufSocketAddressIP\n\n3. **DatagramChannel**\n\n    \t\twritesendUDP\n\n    ```java\n    byteBuffer.flip();\n    datagramChannel.send(byteBuffer, new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    byteBuffer.clear();\n    ```\n\n4. **DatagramChannel**\n\n    \t\tFileChannelclose()\n\n### Select\n\n> SocketChannelDatagramChannelNIOSelector\n>\n> **IO**IO\n\n#### Selector \n\n\t\t`Channel.registerSelector sel, int ops`\n\n**IO**\n\n1. SelectionKey.OP_READ\n2. SelectionKey.OP_WRITE\n3. SelectionKey.OP_CONNECT\n4. SelectionKey.OP_ACCEPT\n\nSelectionKeyIO\n\n```java\nint key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;\n```\n\n#### SelectableChannel()\n\n\t\tSelectableChannelSocketSelectableChannelFileChannelSelectableChannel\n\n#### SelectionKey()\n\n\t\tIOSelectionKeySelectionKeyIOSelectionKey.OP_READIO\n\n#### \n\n1. ****\n\n    \t\topen()\n\n    ```java\n    Selector selector = Selector.open();\n    ```\n\n    *open()SPISelectorProviderSPISPIService Provider InterfaceJDKJavaSPISPI*\n\n2. ****\n\n    \t\tIllegalBlockingModeExceptionIOServerSocketChannelAcceptIOSocketChannelAcceptIOvalidOps()IO\n\n    ```java\n    // \n    ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n    // \n    serverSocketChannel.configureBlocking(false);\n    // \n    serverSocketChannel.bind(new InetSocketAddress(5252));\n    System.out.println(\"\");\n    // IO\n    serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n    ```\n\n3. **IO**\n\n    ```java\n    // IO\n    while (selector.select() > 0) {\n        // \n        Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n        while (selectedKeys.hasNext()) {\n            // \n            SelectionKey selectedKey = selectedKeys.next();\n            if (selectedKey.isAcceptable()) {\n         \t\t// \n            } else if (selectedKey.isConnectalbe()) {\n                // \n            }  else if (selectedKey.isReadalbe()) {\n                // \n            }  else if (selectedKey.isWritalbe()) {\n                // \n            }\n            // \n            selectedKeys.remove();\n        }\n    }\n    ```\n\n    SelectionKeySelectionKeyjava.lang.UnsupportedOperationException\n\n    select()\n\n    1. select()IO\n    2. select(long timeout)select()timeout\n    3. selectNow()IO\n\n    select()selectselect****IOselect()IO\n\n#### \n\nNIODiscardDiscard\n\n****\n\n```java\n/**\n * NIODiscard\n *      \n */\npublic class NioDiscardServer {\n    public static void startServer() throws IOException {\n\n        // \n        Selector selector = Selector.open();\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5252));\n        System.out.println(\"\");\n        // IO\n        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        // IO\n        while (selector.select() > 0) {\n            // \n            Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n            while (selectedKeys.hasNext()) {\n                // \n                SelectionKey selectedKey = selectedKeys.next();\n                if (selectedKey.isAcceptable()) {\n                    // IO\n                    SocketChannel socketChannel = serverSocketChannel.accept();\n                    // \n                    socketChannel.configureBlocking(false);\n                    // \n                    socketChannel.register(selector, SelectionKey.OP_READ);\n                } else if (selectedKey.isReadable()) {\n                    // IO\n                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();\n                    // \n                    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                    int length = 0;\n                    // read\n                    while ((length = socketChannel.read(byteBuffer)) > 0) {\n                        byteBuffer.flip();\n                        System.out.println(new String(byteBuffer.array(), 0, length));\n                        byteBuffer.clear();\n                    }\n                    socketChannel.close();\n                }\n                // \n                selectedKeys.remove();\n            }\n        }\n        // \n        serverSocketChannel.close();\n    }\n}\n```\n\n****\n\n```java\n/**\n * NIODiscard\n *      \n */\npublic class NioDiscardClient {\n\n    public static void startClient() throws IOException {\n        InetSocketAddress address = new InetSocketAddress(InetAddress.getLocalHost(),5252);\n        // \n        SocketChannel socketChannel = SocketChannel.open(address);\n        // \n        socketChannel.configureBlocking(false);\n        // \n        while (!socketChannel.finishConnect()) {\n        }\n        System.out.println(\"\");\n        // \n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        byteBuffer.put(\"hello nio\".getBytes());\n        byteBuffer.flip();\n        // \n        socketChannel.write(byteBuffer);\n        // \n        socketChannel.shutdownOutput();\n        // \n        socketChannel.close();\n    }\n}\n```\n\n****\n\n\t\thello nio\n\n\n\n```\n\n```\n\n\n\n```\n\n```\n\n\n\n```\n\nhello nio\n```\n\n\n\n","source":"_posts/java-nio.md","raw":"---\ntitle: Java NIO\nheader-img: /img/header_img/squirrel.jpg\ncatalog: true\ntop:\ntags:\n  - IO\ncategories:\n  - work\nabbrlink: 57bd\ndate: 2021-03-31 18:45:33\nsubtitle:\n---\n\n## Java NIO\n\n### NIO\n\n> 1.4Java IOIO1.4IOIOJava New IOJAVA NIOJava NIO IO\n\n**NIOOIOold IO**\n\n- OIOStream OrientedNIOBufferOriented\n- OIONIO\n- OIOSelectorNIO\n\nJava NIO Channel Buffer Selector\n\n#### 1. Channel\n\n\t\tOIOInput StreamOutput StreamNIONIOIOOIO\n\n#### 2. Selector\n\n> IO//\n\n\t\tIOselectIO/\n\n#### 3. Buffer\n\n\t\tChannelreadwrite\n\n### Buffer\n\n> Buffer\n\n#### Buffer\n\n\t\tBufferjava.nioNIO8ByteBufferCharBufferDoubleBufferFloatBufferIntBufferLongBufferShortBufferMappedByteBufferMappedByteBufferByteBufferByteBuffer\n\n#### Buffer\n\n\t\tBuffercapacitypositionlimitmark\n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gp33iz38e4j30kk05pt9v.jpg)\n\n#### Buffer\n\n1. **allocate()**\n\n    \t\tBuffernewallocate()capacity\n\n    ```java\n    IntBuffer intBuffer = intBuffer.allocate(10);\n    ```\n\n2. **put()**\n\n    ```java\n    intBuffer.put(1);\n    ```\n\n3. **flip()**\n\n    \t\tflip()flip()\n\n    ```java\n     public final Buffer flip() {\n         limit = position;\n         position = 0;\n         mark = -1;\n         return this;\n     }\n    ```\n\n    10intBuffer1position=1limit=10capacity=10position=0limit=1capacity=10\n\n    > Buffer.clear()Buffer.compact()\n\n    \n\n    ![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gp34tey3npj30g1071aay.jpg)\n\n4. **clear()**\n\n    \t\t\n\n    ```java\n    public final Buffer clear() {\n        position = 0;\n        limit = capacity;\n        mark = -1;\n    \treturn this;\n    }\n    ```\n\n5. **compact()**\n\n    \t\tBufferpositionlimitcapacity\n\n    ```java\n    public ByteBuffer compact() {\n        System.arraycopy(hb, ix(position()), hb, ix(0), remaining()); // \n        position(remaining()); // remaining()limit - position\n        limit(capacity()); // limitcapacity\n        discardMark(); // mark = -1\n        return this;\n    }\n    ```\n\n6. **get()**\n\n    \t\tpositionlimitposition==limitpositionBufferUnderflowException\n\n    ```java\n    byteBuffer.get();\n    ```\n\n7. **rewind()**\n\n    \t\trewind()rewind()\n\n    ```java\n    public final Buffer rewind() {\n        position = 0; // \n        mark = -1; // \n        return this;\n    }\n    ```\n\n    > rewind()flip()rewind()limitflip()limit\n\n8.  **mark( )reset( )**\n\n    \t\tBuffer.mark()Buffer.reset()3i= =2mark()positionmarkmark2resetmarkposition2\n\n**Buffer**\n\n```java\nIntBuffer intBuffer = intBuffer.allocate(10);\nintBuffer.put(1);\nintBuffer.flip();\nintBuffer.get();\nintBuffer.clear();||intBuffer.compact();\n```\n\n### Channel\n\n> NIOChannelJavaNIO Channel\n\n#### Channel\n\n1. FileChannel\n\n2. SocketChannelSocketTCP\n\n3. ServerSocketChannelTCPSocketChannel\n\n4. DatagramChannelUDP\n\n#### FileChannel\n\n> FileChannelFileChannel****\n\n1. **FileChannel**\n\n- \n\n    ```java\n    // \n    FileInputStream fis = new FileInputStream(srcFile);\n    // \n    FileChannel inChannel = fis.getChannel();\n    \n    // \n    FileOutputStream fos = new FileOutputStream(destFile);\n    // \n    FileChannel outChannel = fis.getChannel();\n    ```\n\n- RandomAccessFile\n\n    ```java\n    // RandomAccessFile\n    RandomAccessFile rafile = new RandomAccessFile(srcFile, \"rw\");\n    // \n    FileChannel raFileChannel = rafile.getChannel();\n    ```\n\n2. **FileChannel**\n\n    \t\t`public abstract int read(ByteBuffer src) throws IOException`ByteBuffer**ByteBufferByteBuffer**\n\n    ```java\n    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n    int length = -1;\n    while (-1 != (length = raFileChannel.read(byteBuffer))) {\n    // TODO\n    }\n    ```\n\n3. **FileChannel**\n\n    \t\t`public abstract int write(ByteBuffer src) throws IOException`**ByteBuffer**\n\n    ```java\n    // \n    byteBuffer.flip();\n    int outlength = 0;\n    while (0 != (outlength = raFileChannel.write(byteBuffer))) {\n    \tSystem.out.println(\"\" + outlength);\n    }\n    ```\n\n4. ****\n\n    ```java\n    inChannel.close();\n    ```\n\n5. ****\n\n    \t\tFileChannelforce()\n\n    ```java\n    inChannel.force(true);\n    ```\n\n#### SocketChannelServerSocketChannel\n\n> NIOSocketChannelServerSocketChannel****ServerSocketChannelSocketChannelSocketChannelSocketChannelOIOSocketServerSocketChannelOIOServerSocket\n\n1. **SocketChannel**\n\n    \t\t****SocketChannelopen()socketconnect()IP\n\n    ```java\n    // \n    SocketChannel socketChannel = SocketChannel.open();\n    // \n    socketChannel.configureBlocking(false);\n    // IP\n    socketChannel.connect(new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    ```\n\n    \t\tsocketChannel.connect\n\n    ```java\n    // \n    while (!socketChannel.finishConnect()) {\n    }\n    ```\n\n    \t\t****ServerSocketChannelaccept()\n\n    ```java\n    // ,key\n    ServerSocketChannel serverSocketChannel = ServerSocketChannelkey.channel();\n    // \n    SocketChannel socketChannel = serverSocketChannel.accept();\n    // \n    socketChannel.configureBlocking(false);\n    ```\n\n2. **SocketChannel**\n\n    \t\tFileChannel\n\n3. **SocketChannel**\n\n    \t\tFileChannel\n\n4. **SocketChannel**\n\n    \t\tSocketChannelshutdownOutput()-1socketChannel.close()\n\n    ```\n    // \n    socketChannel.shutdownOutput();\n    // \n    socketChannel.close();\n    ```\n\n#### DatagramChannel\n\n> DatagramChannelUDPSocketTCPUDPUDPIP\n\n1. **DatagramChannel**\n\n    \t\tDatagramChannelopen()\n\n    ```java\n    // \n    DatagramChannel datagramChannel = DatagramChannel.open();\n    // \n    datagramChannel.configureBlocking(false);\t\t\n    // IP\n    datagramChannel.socket().bind(new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    ```\n\n2. **DatagramChannel**\n\n    \t\treadreceive\n\n    ```java\n    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n    SocketAddress clientAddr = datagramChannel.receive(byteBuffer);\n    ```\n\n    \t\treceiveByteBuffer bufSocketAddressIP\n\n3. **DatagramChannel**\n\n    \t\twritesendUDP\n\n    ```java\n    byteBuffer.flip();\n    datagramChannel.send(byteBuffer, new InetSocketAddress(InetAddress.getLocalHost(),5252));\n    byteBuffer.clear();\n    ```\n\n4. **DatagramChannel**\n\n    \t\tFileChannelclose()\n\n### Select\n\n> SocketChannelDatagramChannelNIOSelector\n>\n> **IO**IO\n\n#### Selector \n\n\t\t`Channel.registerSelector sel, int ops`\n\n**IO**\n\n1. SelectionKey.OP_READ\n2. SelectionKey.OP_WRITE\n3. SelectionKey.OP_CONNECT\n4. SelectionKey.OP_ACCEPT\n\nSelectionKeyIO\n\n```java\nint key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;\n```\n\n#### SelectableChannel()\n\n\t\tSelectableChannelSocketSelectableChannelFileChannelSelectableChannel\n\n#### SelectionKey()\n\n\t\tIOSelectionKeySelectionKeyIOSelectionKey.OP_READIO\n\n#### \n\n1. ****\n\n    \t\topen()\n\n    ```java\n    Selector selector = Selector.open();\n    ```\n\n    *open()SPISelectorProviderSPISPIService Provider InterfaceJDKJavaSPISPI*\n\n2. ****\n\n    \t\tIllegalBlockingModeExceptionIOServerSocketChannelAcceptIOSocketChannelAcceptIOvalidOps()IO\n\n    ```java\n    // \n    ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n    // \n    serverSocketChannel.configureBlocking(false);\n    // \n    serverSocketChannel.bind(new InetSocketAddress(5252));\n    System.out.println(\"\");\n    // IO\n    serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n    ```\n\n3. **IO**\n\n    ```java\n    // IO\n    while (selector.select() > 0) {\n        // \n        Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n        while (selectedKeys.hasNext()) {\n            // \n            SelectionKey selectedKey = selectedKeys.next();\n            if (selectedKey.isAcceptable()) {\n         \t\t// \n            } else if (selectedKey.isConnectalbe()) {\n                // \n            }  else if (selectedKey.isReadalbe()) {\n                // \n            }  else if (selectedKey.isWritalbe()) {\n                // \n            }\n            // \n            selectedKeys.remove();\n        }\n    }\n    ```\n\n    SelectionKeySelectionKeyjava.lang.UnsupportedOperationException\n\n    select()\n\n    1. select()IO\n    2. select(long timeout)select()timeout\n    3. selectNow()IO\n\n    select()selectselect****IOselect()IO\n\n#### \n\nNIODiscardDiscard\n\n****\n\n```java\n/**\n * NIODiscard\n *      \n */\npublic class NioDiscardServer {\n    public static void startServer() throws IOException {\n\n        // \n        Selector selector = Selector.open();\n        // \n        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();\n        // \n        serverSocketChannel.configureBlocking(false);\n        // \n        serverSocketChannel.bind(new InetSocketAddress(5252));\n        System.out.println(\"\");\n        // IO\n        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);\n\n        // IO\n        while (selector.select() > 0) {\n            // \n            Iterator<SelectionKey> selectedKeys = selector.selectedKeys().iterator();\n            while (selectedKeys.hasNext()) {\n                // \n                SelectionKey selectedKey = selectedKeys.next();\n                if (selectedKey.isAcceptable()) {\n                    // IO\n                    SocketChannel socketChannel = serverSocketChannel.accept();\n                    // \n                    socketChannel.configureBlocking(false);\n                    // \n                    socketChannel.register(selector, SelectionKey.OP_READ);\n                } else if (selectedKey.isReadable()) {\n                    // IO\n                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();\n                    // \n                    ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n                    int length = 0;\n                    // read\n                    while ((length = socketChannel.read(byteBuffer)) > 0) {\n                        byteBuffer.flip();\n                        System.out.println(new String(byteBuffer.array(), 0, length));\n                        byteBuffer.clear();\n                    }\n                    socketChannel.close();\n                }\n                // \n                selectedKeys.remove();\n            }\n        }\n        // \n        serverSocketChannel.close();\n    }\n}\n```\n\n****\n\n```java\n/**\n * NIODiscard\n *      \n */\npublic class NioDiscardClient {\n\n    public static void startClient() throws IOException {\n        InetSocketAddress address = new InetSocketAddress(InetAddress.getLocalHost(),5252);\n        // \n        SocketChannel socketChannel = SocketChannel.open(address);\n        // \n        socketChannel.configureBlocking(false);\n        // \n        while (!socketChannel.finishConnect()) {\n        }\n        System.out.println(\"\");\n        // \n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        byteBuffer.put(\"hello nio\".getBytes());\n        byteBuffer.flip();\n        // \n        socketChannel.write(byteBuffer);\n        // \n        socketChannel.shutdownOutput();\n        // \n        socketChannel.close();\n    }\n}\n```\n\n****\n\n\t\thello nio\n\n\n\n```\n\n```\n\n\n\n```\n\n```\n\n\n\n```\n\nhello nio\n```\n\n\n\n","slug":"java-nio","published":1,"updated":"2021-11-10T13:43:16.137Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweeu001dkh6z4mmhhcm5","content":"<h2 id=\"Java-NIO\"><a href=\"#Java-NIO\" class=\"headerlink\" title=\"Java NIO\"></a>Java NIO</h2><h3 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h3><blockquote>\n<p>1.4Java IOIO1.4IOIOJava New IOJAVA NIOJava NIO IO</p>\n</blockquote>\n<p><strong>NIOOIOold IO</strong></p>\n<ul>\n<li>OIOStream OrientedNIOBufferOriented</li>\n<li>OIONIO</li>\n<li>OIOSelectorNIO</li>\n</ul>\n<p>Java NIO Channel Buffer Selector</p>\n<h4 id=\"1-Channel\"><a href=\"#1-Channel\" class=\"headerlink\" title=\"1. Channel\"></a>1. Channel</h4><p>        OIOInput StreamOutput StreamNIONIOIOOIO</p>\n<h4 id=\"2-Selector\"><a href=\"#2-Selector\" class=\"headerlink\" title=\"2. Selector\"></a>2. Selector</h4><blockquote>\n<p>IO//</p>\n</blockquote>\n<p>        IOselectIO/</p>\n<h4 id=\"3-Buffer\"><a href=\"#3-Buffer\" class=\"headerlink\" title=\"3. Buffer\"></a>3. Buffer</h4><p>        Channelreadwrite</p>\n<h3 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h3><blockquote>\n<p>Buffer</p>\n</blockquote>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p>        Bufferjava.nioNIO8ByteBufferCharBufferDoubleBufferFloatBufferIntBufferLongBufferShortBufferMappedByteBufferMappedByteBufferByteBufferByteBuffer</p>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p>        Buffercapacitypositionlimitmark</p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gp33iz38e4j30kk05pt9v.jpg\" alt=\"image\"></p>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><ol>\n<li><p><strong>allocate()</strong></p>\n<p>         Buffernewallocate()capacity</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntBuffer intBuffer = intBuffer.allocate(<span class=\"number\">10</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>put()</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intBuffer.put(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>flip()</strong></p>\n<p>         flip()flip()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">flip</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    limit = position;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>;</span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> 10intBuffer1position=1limit=10capacity=10position=0limit=1capacity=10</p>\n<blockquote>\n<p>Buffer.clear()Buffer.compact()</p>\n</blockquote>\n<p> </p>\n<p> <img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gp34tey3npj30g1071aay.jpg\" alt=\"image\"></p>\n</li>\n<li><p><strong>clear()</strong></p>\n<p>         </p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>;</span><br><span class=\"line\">    limit = capacity;</span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>compact()</strong></p>\n<p>         Bufferpositionlimitcapacity</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ByteBuffer <span class=\"title\">compact</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    System.arraycopy(hb, ix(position()), hb, ix(<span class=\"number\">0</span>), remaining()); <span class=\"comment\">// </span></span><br><span class=\"line\">    position(remaining()); <span class=\"comment\">// remaining()limit - position</span></span><br><span class=\"line\">    limit(capacity()); <span class=\"comment\">// limitcapacity</span></span><br><span class=\"line\">    discardMark(); <span class=\"comment\">// mark = -1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>get()</strong></p>\n<p>         positionlimitposition==limitpositionBufferUnderflowException</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">byteBuffer.get();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>rewind()</strong></p>\n<p>         rewind()rewind()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">rewind</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>rewind()flip()rewind()limitflip()limit</p>\n</blockquote>\n</li>\n<li><p><strong>mark( )reset( )</strong></p>\n<p>        Buffer.mark()Buffer.reset()3i= =2mark()positionmarkmark2resetmarkposition2</p>\n</li>\n</ol>\n<p><strong>Buffer</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntBuffer intBuffer = intBuffer.allocate(<span class=\"number\">10</span>);</span><br><span class=\"line\">intBuffer.put(<span class=\"number\">1</span>);</span><br><span class=\"line\">intBuffer.flip();</span><br><span class=\"line\">intBuffer.get();</span><br><span class=\"line\">intBuffer.clear();||intBuffer.compact();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h3><blockquote>\n<p>NIOChannelJavaNIO Channel</p>\n</blockquote>\n<h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><ol>\n<li><p>FileChannel</p>\n</li>\n<li><p>SocketChannelSocketTCP</p>\n</li>\n<li><p>ServerSocketChannelTCPSocketChannel</p>\n</li>\n<li><p>DatagramChannelUDP</p>\n</li>\n</ol>\n<h4 id=\"FileChannel\"><a href=\"#FileChannel\" class=\"headerlink\" title=\"FileChannel\"></a>FileChannel</h4><blockquote>\n<p>FileChannelFileChannel<strong></strong></p>\n</blockquote>\n<ol>\n<li><strong>FileChannel</strong></li>\n</ol>\n<ul>\n<li><p></p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileInputStream fis = <span class=\"keyword\">new</span> FileInputStream(srcFile);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel inChannel = fis.getChannel();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileOutputStream fos = <span class=\"keyword\">new</span> FileOutputStream(destFile);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel outChannel = fis.getChannel();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>RandomAccessFile</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// RandomAccessFile</span></span><br><span class=\"line\">RandomAccessFile rafile = <span class=\"keyword\">new</span> RandomAccessFile(srcFile, <span class=\"string\">\"rw\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel raFileChannel = rafile.getChannel();</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ol start=\"2\">\n<li><p><strong>FileChannel</strong></p>\n<p>         <code>public abstract int read(ByteBuffer src) throws IOException</code>ByteBuffer<strong>ByteBufferByteBuffer</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> length = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (-<span class=\"number\">1</span> != (length = raFileChannel.read(byteBuffer))) &#123;</span><br><span class=\"line\"><span class=\"comment\">// TODO</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FileChannel</strong></p>\n<p>         <code>public abstract int write(ByteBuffer src) throws IOException</code><strong>ByteBuffer</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">byteBuffer.flip();</span><br><span class=\"line\"><span class=\"keyword\">int</span> outlength = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"number\">0</span> != (outlength = raFileChannel.write(byteBuffer))) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">\"\"</span> + outlength);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong></strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">inChannel.close();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong></strong></p>\n<p>         FileChannelforce()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">inChannel.force(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"SocketChannelServerSocketChannel\"><a href=\"#SocketChannelServerSocketChannel\" class=\"headerlink\" title=\"SocketChannelServerSocketChannel\"></a>SocketChannelServerSocketChannel</h4><blockquote>\n<p>NIOSocketChannelServerSocketChannel<strong></strong>ServerSocketChannelSocketChannelSocketChannelSocketChannelOIOSocketServerSocketChannelOIOServerSocket</p>\n</blockquote>\n<ol>\n<li><p><strong>SocketChannel</strong></p>\n<p>         <strong></strong>SocketChannelopen()socketconnect()IP</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">SocketChannel socketChannel = SocketChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// IP</span></span><br><span class=\"line\">socketChannel.connect(<span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br></pre></td></tr></table></figure>\n\n<p>         socketChannel.connect</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (!socketChannel.finishConnect()) &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>         <strong></strong>ServerSocketChannelaccept()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,key</span></span><br><span class=\"line\">ServerSocketChannel serverSocketChannel = ServerSocketChannelkey.channel();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         FileChannel</p>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         FileChannel</p>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         SocketChannelshutdownOutput()-1socketChannel.close()</p>\n <figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"selector-tag\">socketChannel</span><span class=\"selector-class\">.shutdownOutput</span>();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"selector-tag\">socketChannel</span><span class=\"selector-class\">.close</span>();</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"DatagramChannel\"><a href=\"#DatagramChannel\" class=\"headerlink\" title=\"DatagramChannel\"></a>DatagramChannel</h4><blockquote>\n<p>DatagramChannelUDPSocketTCPUDPUDPIP</p>\n</blockquote>\n<ol>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         DatagramChannelopen()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">DatagramChannel datagramChannel = DatagramChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">datagramChannel.configureBlocking(<span class=\"keyword\">false</span>);\t\t</span><br><span class=\"line\"><span class=\"comment\">// IP</span></span><br><span class=\"line\">datagramChannel.socket().bind(<span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         readreceive</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">SocketAddress clientAddr = datagramChannel.receive(byteBuffer);</span><br></pre></td></tr></table></figure>\n\n<p>         receiveByteBuffer bufSocketAddressIP</p>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         writesendUDP</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">byteBuffer.flip();</span><br><span class=\"line\">datagramChannel.send(byteBuffer, <span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br><span class=\"line\">byteBuffer.clear();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         FileChannelclose()</p>\n</li>\n</ol>\n<h3 id=\"Select\"><a href=\"#Select\" class=\"headerlink\" title=\"Select\"></a>Select</h3><blockquote>\n<p>SocketChannelDatagramChannelNIOSelector</p>\n<p><strong>IO</strong>IO</p>\n</blockquote>\n<h4 id=\"Selector-\"><a href=\"#Selector-\" class=\"headerlink\" title=\"Selector \"></a>Selector </h4><p>        <code>Channel.registerSelector sel, int ops</code></p>\n<p><strong>IO</strong></p>\n<ol>\n<li>SelectionKey.OP_READ</li>\n<li>SelectionKey.OP_WRITE</li>\n<li>SelectionKey.OP_CONNECT</li>\n<li>SelectionKey.OP_ACCEPT</li>\n</ol>\n<p>SelectionKeyIO</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"SelectableChannel-\"><a href=\"#SelectableChannel-\" class=\"headerlink\" title=\"SelectableChannel()\"></a>SelectableChannel()</h4><p>        SelectableChannelSocketSelectableChannelFileChannelSelectableChannel</p>\n<h4 id=\"SelectionKey-\"><a href=\"#SelectionKey-\" class=\"headerlink\" title=\"SelectionKey()\"></a>SelectionKey()</h4><p>        IOSelectionKeySelectionKeyIOSelectionKey.OP_READIO</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p><strong></strong></p>\n<p>         open()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Selector selector = Selector.open();</span><br></pre></td></tr></table></figure>\n\n<p> <em>open()SPISelectorProviderSPISPIService Provider InterfaceJDKJavaSPISPI</em></p>\n</li>\n<li><p><strong></strong></p>\n<p>         IllegalBlockingModeExceptionIOServerSocketChannelAcceptIOSocketChannelAcceptIOvalidOps()IO</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// IO</span></span><br><span class=\"line\">serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>IO</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// IO</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">     \t\t<span class=\"comment\">// </span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isConnectalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isWritalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        selectedKeys.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> SelectionKeySelectionKeyjava.lang.UnsupportedOperationException</p>\n<p> select()</p>\n<ol>\n<li><p>select()IO</p>\n</li>\n<li><p>select(long timeout)select()timeout</p>\n</li>\n<li><p>selectNow()IO</p>\n<p>select()selectselect<strong></strong>IOselect()IO</p>\n</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>NIODiscardDiscard</p>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * NIODiscard</span></span><br><span class=\"line\"><span class=\"comment\"> *      </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioDiscardServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Selector selector = Selector.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.register(selector, SelectionKey.OP_READ);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> length = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// read</span></span><br><span class=\"line\">                    <span class=\"keyword\">while</span> ((length = socketChannel.read(byteBuffer)) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        byteBuffer.flip();</span><br><span class=\"line\">                        System.out.println(<span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                        byteBuffer.clear();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    socketChannel.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                selectedKeys.remove();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * NIODiscard</span></span><br><span class=\"line\"><span class=\"comment\"> *      </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioDiscardClient</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startClient</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        InetSocketAddress address = <span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        SocketChannel socketChannel = SocketChannel.open(address);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!socketChannel.finishConnect()) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        byteBuffer.put(<span class=\"string\">\"hello nio\"</span>.getBytes());</span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.write(byteBuffer);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.shutdownOutput();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p>        hello nio</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\"></span></span><br><span class=\"line\"><span class=\"attr\">hello</span> <span class=\"string\">nio</span></span><br></pre></td></tr></table></figure>\n\n\n\n","site":{"data":{}},"excerpt":"","more":"<h2 id=\"Java-NIO\"><a href=\"#Java-NIO\" class=\"headerlink\" title=\"Java NIO\"></a>Java NIO</h2><h3 id=\"NIO\"><a href=\"#NIO\" class=\"headerlink\" title=\"NIO\"></a>NIO</h3><blockquote>\n<p>1.4Java IOIO1.4IOIOJava New IOJAVA NIOJava NIO IO</p>\n</blockquote>\n<p><strong>NIOOIOold IO</strong></p>\n<ul>\n<li>OIOStream OrientedNIOBufferOriented</li>\n<li>OIONIO</li>\n<li>OIOSelectorNIO</li>\n</ul>\n<p>Java NIO Channel Buffer Selector</p>\n<h4 id=\"1-Channel\"><a href=\"#1-Channel\" class=\"headerlink\" title=\"1. Channel\"></a>1. Channel</h4><p>        OIOInput StreamOutput StreamNIONIOIOOIO</p>\n<h4 id=\"2-Selector\"><a href=\"#2-Selector\" class=\"headerlink\" title=\"2. Selector\"></a>2. Selector</h4><blockquote>\n<p>IO//</p>\n</blockquote>\n<p>        IOselectIO/</p>\n<h4 id=\"3-Buffer\"><a href=\"#3-Buffer\" class=\"headerlink\" title=\"3. Buffer\"></a>3. Buffer</h4><p>        Channelreadwrite</p>\n<h3 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h3><blockquote>\n<p>Buffer</p>\n</blockquote>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p>        Bufferjava.nioNIO8ByteBufferCharBufferDoubleBufferFloatBufferIntBufferLongBufferShortBufferMappedByteBufferMappedByteBufferByteBufferByteBuffer</p>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><p>        Buffercapacitypositionlimitmark</p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gp33iz38e4j30kk05pt9v.jpg\" alt=\"image\"></p>\n<h4 id=\"Buffer\"><a href=\"#Buffer\" class=\"headerlink\" title=\"Buffer\"></a>Buffer</h4><ol>\n<li><p><strong>allocate()</strong></p>\n<p>         Buffernewallocate()capacity</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntBuffer intBuffer = intBuffer.allocate(<span class=\"number\">10</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>put()</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">intBuffer.put(<span class=\"number\">1</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>flip()</strong></p>\n<p>         flip()flip()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">flip</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    limit = position;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>;</span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> 10intBuffer1position=1limit=10capacity=10position=0limit=1capacity=10</p>\n<blockquote>\n<p>Buffer.clear()Buffer.compact()</p>\n</blockquote>\n<p> </p>\n<p> <img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gp34tey3npj30g1071aay.jpg\" alt=\"image\"></p>\n</li>\n<li><p><strong>clear()</strong></p>\n<p>         </p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">clear</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>;</span><br><span class=\"line\">    limit = capacity;</span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>;</span><br><span class=\"line\">\t<span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>compact()</strong></p>\n<p>         Bufferpositionlimitcapacity</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> ByteBuffer <span class=\"title\">compact</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    System.arraycopy(hb, ix(position()), hb, ix(<span class=\"number\">0</span>), remaining()); <span class=\"comment\">// </span></span><br><span class=\"line\">    position(remaining()); <span class=\"comment\">// remaining()limit - position</span></span><br><span class=\"line\">    limit(capacity()); <span class=\"comment\">// limitcapacity</span></span><br><span class=\"line\">    discardMark(); <span class=\"comment\">// mark = -1</span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>get()</strong></p>\n<p>         positionlimitposition==limitpositionBufferUnderflowException</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">byteBuffer.get();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>rewind()</strong></p>\n<p>         rewind()rewind()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">final</span> Buffer <span class=\"title\">rewind</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">    position = <span class=\"number\">0</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    mark = -<span class=\"number\">1</span>; <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">return</span> <span class=\"keyword\">this</span>;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<blockquote>\n<p>rewind()flip()rewind()limitflip()limit</p>\n</blockquote>\n</li>\n<li><p><strong>mark( )reset( )</strong></p>\n<p>        Buffer.mark()Buffer.reset()3i= =2mark()positionmarkmark2resetmarkposition2</p>\n</li>\n</ol>\n<p><strong>Buffer</strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">IntBuffer intBuffer = intBuffer.allocate(<span class=\"number\">10</span>);</span><br><span class=\"line\">intBuffer.put(<span class=\"number\">1</span>);</span><br><span class=\"line\">intBuffer.flip();</span><br><span class=\"line\">intBuffer.get();</span><br><span class=\"line\">intBuffer.clear();||intBuffer.compact();</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h3><blockquote>\n<p>NIOChannelJavaNIO Channel</p>\n</blockquote>\n<h4 id=\"Channel\"><a href=\"#Channel\" class=\"headerlink\" title=\"Channel\"></a>Channel</h4><ol>\n<li><p>FileChannel</p>\n</li>\n<li><p>SocketChannelSocketTCP</p>\n</li>\n<li><p>ServerSocketChannelTCPSocketChannel</p>\n</li>\n<li><p>DatagramChannelUDP</p>\n</li>\n</ol>\n<h4 id=\"FileChannel\"><a href=\"#FileChannel\" class=\"headerlink\" title=\"FileChannel\"></a>FileChannel</h4><blockquote>\n<p>FileChannelFileChannel<strong></strong></p>\n</blockquote>\n<ol>\n<li><strong>FileChannel</strong></li>\n</ol>\n<ul>\n<li><p></p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileInputStream fis = <span class=\"keyword\">new</span> FileInputStream(srcFile);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel inChannel = fis.getChannel();</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileOutputStream fos = <span class=\"keyword\">new</span> FileOutputStream(destFile);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel outChannel = fis.getChannel();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p>RandomAccessFile</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// RandomAccessFile</span></span><br><span class=\"line\">RandomAccessFile rafile = <span class=\"keyword\">new</span> RandomAccessFile(srcFile, <span class=\"string\">\"rw\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">FileChannel raFileChannel = rafile.getChannel();</span><br></pre></td></tr></table></figure>\n</li>\n</ul>\n<ol start=\"2\">\n<li><p><strong>FileChannel</strong></p>\n<p>         <code>public abstract int read(ByteBuffer src) throws IOException</code>ByteBuffer<strong>ByteBufferByteBuffer</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\"><span class=\"keyword\">int</span> length = -<span class=\"number\">1</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (-<span class=\"number\">1</span> != (length = raFileChannel.read(byteBuffer))) &#123;</span><br><span class=\"line\"><span class=\"comment\">// TODO</span></span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>FileChannel</strong></p>\n<p>         <code>public abstract int write(ByteBuffer src) throws IOException</code><strong>ByteBuffer</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">byteBuffer.flip();</span><br><span class=\"line\"><span class=\"keyword\">int</span> outlength = <span class=\"number\">0</span>;</span><br><span class=\"line\"><span class=\"keyword\">while</span> (<span class=\"number\">0</span> != (outlength = raFileChannel.write(byteBuffer))) &#123;</span><br><span class=\"line\">\tSystem.out.println(<span class=\"string\">\"\"</span> + outlength);</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong></strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">inChannel.close();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong></strong></p>\n<p>         FileChannelforce()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">inChannel.force(<span class=\"keyword\">true</span>);</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"SocketChannelServerSocketChannel\"><a href=\"#SocketChannelServerSocketChannel\" class=\"headerlink\" title=\"SocketChannelServerSocketChannel\"></a>SocketChannelServerSocketChannel</h4><blockquote>\n<p>NIOSocketChannelServerSocketChannel<strong></strong>ServerSocketChannelSocketChannelSocketChannelSocketChannelOIOSocketServerSocketChannelOIOServerSocket</p>\n</blockquote>\n<ol>\n<li><p><strong>SocketChannel</strong></p>\n<p>         <strong></strong>SocketChannelopen()socketconnect()IP</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">SocketChannel socketChannel = SocketChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// IP</span></span><br><span class=\"line\">socketChannel.connect(<span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br></pre></td></tr></table></figure>\n\n<p>         socketChannel.connect</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (!socketChannel.finishConnect()) &#123;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p>         <strong></strong>ServerSocketChannelaccept()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// ,key</span></span><br><span class=\"line\">ServerSocketChannel serverSocketChannel = ServerSocketChannelkey.channel();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         FileChannel</p>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         FileChannel</p>\n</li>\n<li><p><strong>SocketChannel</strong></p>\n<p>         SocketChannelshutdownOutput()-1socketChannel.close()</p>\n <figure class=\"highlight less\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"selector-tag\">socketChannel</span><span class=\"selector-class\">.shutdownOutput</span>();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"selector-tag\">socketChannel</span><span class=\"selector-class\">.close</span>();</span><br></pre></td></tr></table></figure>\n\n</li>\n</ol>\n<h4 id=\"DatagramChannel\"><a href=\"#DatagramChannel\" class=\"headerlink\" title=\"DatagramChannel\"></a>DatagramChannel</h4><blockquote>\n<p>DatagramChannelUDPSocketTCPUDPUDPIP</p>\n</blockquote>\n<ol>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         DatagramChannelopen()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">DatagramChannel datagramChannel = DatagramChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">datagramChannel.configureBlocking(<span class=\"keyword\">false</span>);\t\t</span><br><span class=\"line\"><span class=\"comment\">// IP</span></span><br><span class=\"line\">datagramChannel.socket().bind(<span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         readreceive</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">SocketAddress clientAddr = datagramChannel.receive(byteBuffer);</span><br></pre></td></tr></table></figure>\n\n<p>         receiveByteBuffer bufSocketAddressIP</p>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         writesendUDP</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">byteBuffer.flip();</span><br><span class=\"line\">datagramChannel.send(byteBuffer, <span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>));</span><br><span class=\"line\">byteBuffer.clear();</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>DatagramChannel</strong></p>\n<p>         FileChannelclose()</p>\n</li>\n</ol>\n<h3 id=\"Select\"><a href=\"#Select\" class=\"headerlink\" title=\"Select\"></a>Select</h3><blockquote>\n<p>SocketChannelDatagramChannelNIOSelector</p>\n<p><strong>IO</strong>IO</p>\n</blockquote>\n<h4 id=\"Selector-\"><a href=\"#Selector-\" class=\"headerlink\" title=\"Selector \"></a>Selector </h4><p>        <code>Channel.registerSelector sel, int ops</code></p>\n<p><strong>IO</strong></p>\n<ol>\n<li>SelectionKey.OP_READ</li>\n<li>SelectionKey.OP_WRITE</li>\n<li>SelectionKey.OP_CONNECT</li>\n<li>SelectionKey.OP_ACCEPT</li>\n</ol>\n<p>SelectionKeyIO</p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">int</span> key = SelectionKey.OP_READ | SelectionKey.OP_WRITE;</span><br></pre></td></tr></table></figure>\n\n<h4 id=\"SelectableChannel-\"><a href=\"#SelectableChannel-\" class=\"headerlink\" title=\"SelectableChannel()\"></a>SelectableChannel()</h4><p>        SelectableChannelSocketSelectableChannelFileChannelSelectableChannel</p>\n<h4 id=\"SelectionKey-\"><a href=\"#SelectionKey-\" class=\"headerlink\" title=\"SelectionKey()\"></a>SelectionKey()</h4><p>        IOSelectionKeySelectionKeyIOSelectionKey.OP_READIO</p>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><ol>\n<li><p><strong></strong></p>\n<p>         open()</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">Selector selector = Selector.open();</span><br></pre></td></tr></table></figure>\n\n<p> <em>open()SPISelectorProviderSPISPIService Provider InterfaceJDKJavaSPISPI</em></p>\n</li>\n<li><p><strong></strong></p>\n<p>         IllegalBlockingModeExceptionIOServerSocketChannelAcceptIOSocketChannelAcceptIOvalidOps()IO</p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\">serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\"><span class=\"comment\">// IO</span></span><br><span class=\"line\">serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br></pre></td></tr></table></figure>\n</li>\n<li><p><strong>IO</strong></p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// IO</span></span><br><span class=\"line\"><span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">    <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">     \t\t<span class=\"comment\">// </span></span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isConnectalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;  <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isWritalbe()) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        selectedKeys.remove();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p> SelectionKeySelectionKeyjava.lang.UnsupportedOperationException</p>\n<p> select()</p>\n<ol>\n<li><p>select()IO</p>\n</li>\n<li><p>select(long timeout)select()timeout</p>\n</li>\n<li><p>selectNow()IO</p>\n<p>select()selectselect<strong></strong>IOselect()IO</p>\n</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h4><p>NIODiscardDiscard</p>\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * NIODiscard</span></span><br><span class=\"line\"><span class=\"comment\"> *      </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioDiscardServer</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startServer</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Selector selector = Selector.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ServerSocketChannel serverSocketChannel = ServerSocketChannel.open();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.bind(<span class=\"keyword\">new</span> InetSocketAddress(<span class=\"number\">5252</span>));</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        serverSocketChannel.register(selector, SelectionKey.OP_ACCEPT);</span><br><span class=\"line\"></span><br><span class=\"line\">        <span class=\"comment\">// IO</span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (selector.select() &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            Iterator&lt;SelectionKey&gt; selectedKeys = selector.selectedKeys().iterator();</span><br><span class=\"line\">            <span class=\"keyword\">while</span> (selectedKeys.hasNext()) &#123;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                SelectionKey selectedKey = selectedKeys.next();</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (selectedKey.isAcceptable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = serverSocketChannel.accept();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    socketChannel.register(selector, SelectionKey.OP_READ);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">else</span> <span class=\"keyword\">if</span> (selectedKey.isReadable()) &#123;</span><br><span class=\"line\">                    <span class=\"comment\">// IO</span></span><br><span class=\"line\">                    SocketChannel socketChannel = (SocketChannel) selectedKey.channel();</span><br><span class=\"line\">                    <span class=\"comment\">// </span></span><br><span class=\"line\">                    ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">                    <span class=\"keyword\">int</span> length = <span class=\"number\">0</span>;</span><br><span class=\"line\">                    <span class=\"comment\">// read</span></span><br><span class=\"line\">                    <span class=\"keyword\">while</span> ((length = socketChannel.read(byteBuffer)) &gt; <span class=\"number\">0</span>) &#123;</span><br><span class=\"line\">                        byteBuffer.flip();</span><br><span class=\"line\">                        System.out.println(<span class=\"keyword\">new</span> String(byteBuffer.array(), <span class=\"number\">0</span>, length));</span><br><span class=\"line\">                        byteBuffer.clear();</span><br><span class=\"line\">                    &#125;</span><br><span class=\"line\">                    socketChannel.close();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"comment\">// </span></span><br><span class=\"line\">                selectedKeys.remove();</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        serverSocketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/**</span></span><br><span class=\"line\"><span class=\"comment\"> * NIODiscard</span></span><br><span class=\"line\"><span class=\"comment\"> *      </span></span><br><span class=\"line\"><span class=\"comment\"> */</span></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">NioDiscardClient</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">startClient</span><span class=\"params\">()</span> <span class=\"keyword\">throws</span> IOException </span>&#123;</span><br><span class=\"line\">        InetSocketAddress address = <span class=\"keyword\">new</span> InetSocketAddress(InetAddress.getLocalHost(),<span class=\"number\">5252</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        SocketChannel socketChannel = SocketChannel.open(address);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.configureBlocking(<span class=\"keyword\">false</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        <span class=\"keyword\">while</span> (!socketChannel.finishConnect()) &#123;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        ByteBuffer byteBuffer = ByteBuffer.allocate(<span class=\"number\">1024</span>);</span><br><span class=\"line\">        byteBuffer.put(<span class=\"string\">\"hello nio\"</span>.getBytes());</span><br><span class=\"line\">        byteBuffer.flip();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.write(byteBuffer);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.shutdownOutput();</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        socketChannel.close();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<p><strong></strong></p>\n<p>        hello nio</p>\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight plain\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"></span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight properties\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attr\"></span></span><br><span class=\"line\"><span class=\"attr\">hello</span> <span class=\"string\">nio</span></span><br></pre></td></tr></table></figure>\n\n\n\n"},{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"c15d","date":"2020-12-19T16:00:00.000Z","subtitle":null,"_content":"\n### ","source":"_posts/read-test2.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - finance\ncategories:\n  - life\nabbrlink: c15d\ndate: 2020-12-20 00:00:00\nsubtitle:\n---\n\n### ","slug":"read-test2","published":1,"updated":"2021-11-10T13:43:16.138Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweew001gkh6z8jw4bi6t","content":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>","site":{"data":{}},"excerpt":"","more":"<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3>"},{"title":"JAVA","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":1,"abbrlink":"2de3","date":"2020-10-15T12:50:34.000Z","subtitle":null,"_content":"\n## JVM\n\n### \n\n> (cpu)\n\n- \n- OutOfMemory\n\n### Java\n\n> Java\n>\n> \n>\n> \n\n- \n    1.  \n    2. \n    3. \n    4. \n- \n    1. StackOverflowError\n    2. OutOfMemory\n\n### \n\n- ,Java()nativecc++\n\n### \n\n> \n>\n> 1javareference\n>\n> 2\n>\n> 3\n\n-  JIT()\n- OOM(OutOfMemoryError)\n\n### \n\n- static\n\n## \n\n### \n\n- \n    - +1-10\n    - ---1\n- \n    - GCroot\n    - GCrootGCJavaGC,GC roots,GC rootsGC\n        1. ---\n        2. \n        3. \n        4. JNInative\n\n### ---\n\n- 1. -\n\n      - \n        1. mutatorNEW()READ()WRITE()\n        2. collectormutatorNEW\n      - \n        - collectormutatormutatorheader\n        - collector(heap memory)-header\n        - TipsCollector(mutator)Stop-The-World\n      - 13MutatorCollectorOut of Memory\n\n- 2.\n\n    -  \n    - \n    - \n    - \n\n- 3.-\n\n    -  \n\n        - \n        - \n\n    - \n\n    - \n\n    - \n\n        >  > \n\n- \n\n    - \n    - \n        - \n            1. Eden \n            2. Survivor \n            3. Tenured Gen \n        - ****EdenSurvivorEdenSurvivorEdenSurvivorSurvivorEdenSurvivor\n    - \n        - ****\n\n### ---\n\n- Serial/Serial Old\n\n    - \n        1. \n        2. \n        3. SerialSerial Old\n    - \n    - \n\n- ParNew\n\n    - \n\n        \tSerial\n\n- Parallel Scavenge\n\n    - \n        1. \n        2. \n\n- Parallel Old\n\n    - \n        1. Parallel Scavenge\n        2. \n\n- CMSConcurrent Mark Sweep\n\n    - \n        1. \n        2. -\n    - \n    - \n        1. CPU\n        2. \n        3. ConcurrentMode Failure\n        4. \n\n- G1\n\n    - \n        1. \n        2. \n\n\n\n- \n    - SerialParNewParallel Scavenge\n- \n    - Serial OldParallel OldCMS\n- \n    - G1[]\n\n## \n\n### \n\n- \n\n    1. \n    2. \n    3.  Class ,\n    4. Tips loadClass()  Java \n\n- \n\n    - class \n\n        ![image20210918170036312](https://i.loli.net/2021/09/18/F1BQWefNcAYUEDy.png)\n\n- \n\n    - staticstatic int i = 5  i 0 i 5)finalstatic finalJava\n\n- \n\n    - \n\n- \n\n    - static \n\n        ![image20210918170449021](https://i.loli.net/2021/09/18/RLuVIpE7OWAx4Mz.png)\n\n### \n\n- JVM\n- JVMpgPersonClassLoaderklPersonClassJVM(Person.pg.kl)\n- JVM\n    - 1.\n        -  Java $JAVA_HOMEjre/lib/rt.jarclassC++ClassLoader\n    - 2.\n        - JRElib/extjava.ext.dirsJARJavanull\n    - 3.\n        - JVMCLASSPATHJARClassLoadergetSystemClassLoader()JavaExtClassLoader\n\n### \n\n- 1.\n\n    - ClassClassClass\n\n- 2.\n\n    - \n\n        ![image20210918170625728](https://i.loli.net/2021/09/18/tJyd5oZ3aBS1pm9.png)\n\n    - \n\n        - 1.ClassLoader\n        - 2.APIjava.lang.IntegerJava APIInteger.class\n\n- 3.\n\n    - ClassClassClassClassClassClassJVM\n\n### forNameloaderClass\n\n- Class.forName()class\n- Classloader.loaderClassclass\n\n### \n\n- ObjectObject\n\n### \n\n- markword\n\n    - 3286416\n\n    - \n\n        ![image20210918171629651](https://i.loli.net/2021/09/18/5UlmYsTDcFwKuX9.png)\n\n- \n\n    - \n    - :doublelong\n\n- \n\n    - JVM\n    - HotSpot8\n\n## synchronized\n\n### \n\n### JMMsynchronized\n\n- \n- \n\n### \n\n1. \n2. \n3. \n4. \n5. \n6. \n\n### \n\n1. Mark WordID\n2. CASIDMard Word1\n3. \n4. CASMark Word\n5. \n6. \n7. \n\n### synchronized \n\n- synchronizedvolatilesynchronizedvolatile\n\n### \n\n- \n\n- \n\n    ```java\n    // \n    class Zhangsan {\n        public void say() {\n            System.out.println(\"\");\n        }\n    \n        public void get() {\n            System.out.println(\"\");\n        }\n    }\n    \n    // \n    class Lisi {\n        public void say() {\n            System.out.println(\"\");\n        }\n    \n        public void get() {\n            System.out.println(\"\");\n        }\n    \n    }\n    \n    public class ThreadDeadLock implements Runnable {\n    \n        private static Zhangsan zs = new Zhangsan();    // static\n    \n        private static Lisi ls = new Lisi();    // static\n    \n        private boolean flag = false; // \n    \n        public void run() { // run()\n            if (flag) {\n                synchronized (zs) {  // \n                    zs.say();\n                    try {\n                        Thread.sleep(500);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (ls) {\n                        zs.get();\n                    }\n                }\n            } else {\n                synchronized (ls) {\n                    ls.say();\n                    try {\n                        Thread.sleep(500);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (zs) {\n                        ls.get();\n                    }\n                }\n            }\n        }\n    \n        public static void main(String args[]) {\n            ThreadDeadLock t1 = new ThreadDeadLock();   // \n            ThreadDeadLock t2 = new ThreadDeadLock();   // \n            t1.flag = true;\n            t2.flag = false;\n            Thread thA = new Thread(t1);\n            Thread thB = new Thread(t2);\n            thA.start();\n            thB.start();\n        }\n    }\n    //   \n    ```\n\n- \n\n    - \n    - \n    - \n\n## JUC\n\n### volatile\n\n- JMM\n\n    ![image20210918171727328](https://i.loli.net/2021/09/18/F23tz5UOqCEwJbA.png)\n\n- \n\n    - \n        1. volatilestore\n        2. volatileload\n    - volatile\n        1. volatile\n        2. \n    - volatile\n        1. volatile\n        2. volatile\n\n- \n\n    -  i++ --\n    - \n        1. synchronized\n        2. ReentrantLock\n        3. AtomicInterger\n\n- \n\n    - n = n + 1 n ++\n    - ,  n < m\n\n- synchronizedvolatile\n\n    - volatilesynchronized\n    - volatilevolatile\n    - synchronizedvolatile\n\n- double checkvolatile\n\n    ```java\n    public class SingletonClass {\n    \n        private static SingletonClass instance = null;\n        //private static volatile SingletonClass instance = null;\n    \n        public static SingletonClass getInstance() {\n            if (instance == null) {\n                synchronized (SingletonClass.class) {\n                    if (instance == null) {\n                        instance = new SingletonClass();\n                    }\n                }\n            }\n            return instance;\n        }\n    }\n    ```\n\n    - **new,1.2.3.**1->2->3231->3>2ifvolatilevolatileifvolatilehappen-beforenewSingletonClass()\n\n### AtomicCAS\n\n- \n    1. AtomicBoolean AtomicInteger AtomicLong  AtomicReference \n    2. AtomicIntegerArray AtomicLongArray 3.AtomicStampedReferenceABA\n- \n    - boolean compareAndSet(expectedValue, updateValue) CASUnsafeCPU\n\n### LocksAQS\n\n- ReentrantLock\n    - \n    - ReentrantLock/Synchorized \n    - lock\n- ReadWriteLock\n\n### Collections\n\n- Queue\n    - ConcurrentLinkedQueue\n    - BlockingQueue\n    - Deque\n- CopyOnWriteArraySet\n- CopyOnWriteArrayList\n- ConcurrentSkipListSet\n- ConcurrentMap\n    - ConcurrentHashMap\n    - ConcurrentNavigableMap\n        - ConcurrentSkipListMap\n\n### Executor\n\n- Future\n    - RunnableFuture\n        - RunnableScheduledFuture\n        - FutureTask\n    - ScheduledFuture\n- Callable\n- Executor\n    - ExecutorService\n        - ScheduledExecutorService\n            - ScheduledThreadPoolExecutor\n        - ThreadPoolExecutor\n- CompletionService\n    - ExecutorCompletionService\n- RejectedExecutionHandler\n    - ThreadPoolExecutor.DiscardPolicy\n    - ThreadPoolExecutor.DiscardOldestPolicy\n    - ThreadPoolExecutor.CallerRunsPolicy\n    - ThreadPoolExecutor.AbortPolicy\n- TimeUnit\n\n### Tools\n\n- CountDownLatch\n- CyclicBarrier\n- Semaphore\n- Executors\n- Exchanger\n\n## TODO \n\n### Map\n\n- HashMap\n\n    > // EnterykeyvaluenextNode // key-valuehash(key)hashindexFor(hash,length)key-value // hash&0x7FFFFFFF(16)lengthkey-valueHashMap // hashNodenextnull1.8Node1.87 // 6Node\n\n    - +(1.8++)\n    - AbstractMapkeynullvaluenull16\n    - jdk1.71.8 1) 1.7hash+1.8hash++>7 2) hashcode1.7451.811 3)1.71.8+\n    - 2 2n1hash2n1hashreturnh&(length-1)00001100111011entry\n\n- Hashtable\n\n    > // HashTablesynchronizedHashTable // HashTableHashTable // 1put2putget\n\n    - HashtableDictionarykeyvaluenull11\n\n- ConcurrentHashMap\n\n    > // ConcurrentHashMapAbstractMapConcurrentHashMap HashEntry  Segment > // HashEntry  / ;Segment  > //  ConcurrentHashMap  Segment  HashEntry  > // SegmentHashEntry,HashEntrySegment > // putgetsize()containsValue() > // ConcurrentHashMapfinalfinal > // finalfinal\n\n    - ConcurrentHashMapAbstractMap\n\n- LinkedHashMap\n\n    - LinkedHashMapHashMap+/\n    - nullnull\n\n- TreeMap\n\n    - TreeMapSortedMapnullnull\n    - keycomparatorvalue\n    - Red-Black tree containsKeygetput  remove  log(n)\n\n### List\n\n- ArrayList\n    - ArrayList()\n- Vector\n    - Vector(synchronized)\n- LinkedList\n    - LinkedList()\n\n### Set\n\n- HashSet\n    - HashSetHash\n- LinkedHashSet\n    - LinkedHashSet\n    - HashSetLinkedHashMap \n- TreeSet\n    - TreeSet\n\n### \n\n> TreeMapTreeSetjava8HashMap\n\n- \n    1. \n    2. \n    3. \n    4. \n- 34\n    1. \n    2. \n\n## spring\n\n### IoCDI\n\n- IoC \n- DI springIoCDI\n- \n    1. \n    2. \n    3. \n\n### AOP\n\n### spring\n\n- xmlbean\n\n- bean  ->  ->  ->  -> \n\n    - 1.BeanNamenameMapBeanDefinitionbean name\n\n        -  Map beanName  keyBeanFactory.getBean  name\n            1. bean name BeanDefinition\n            2. alias namealias name  bean name  SimpleAliasRegistry  beanName\n            3. factorybean name,  &  BeanDefinition  & \n\n    - 2. BeanDefinition Bean \n\n        -  BeanDefinition  GenericBeanDefinition, Bean  RootBeanDefinition,GenericBeanDefinition     parentName  RootBeanDefinition.overrideFrom  \n\n    - 3. Bean + \n\n        -  RootBeanDefintion  Bean AbstractAutowireCapableBeanFactory.createBeanInstance  Bean  BeanWrapper\n\n            1. instantiateUsingFactoryMethod \n            2. autowireConstructor\n            3. instantiateBean\n\n             getInstantiationStrategy().instantiate()  replace  lookup  \n\n        - ****\n\n            1.  Bean \n            2.  setter   A  B B  C C  A A \n\n            - Spring Spring \n\n            -   Spring  DefaultSingletonBeanRegistry \n\n                1. singletonObjects\n\n                2. singletonFactories\n\n                3. earlySingletonObjects  singletonObjects  singletonFactory  singletonFactories  singletonFactory getEarlyBeanReference  earlySingletonObjects   earlySingletonObjects  earlySingletonObjects  getEarlyBeanReference  C  A A  B A \n\n                    ```java\n                    /** Cache of singleton objects: bean name --> bean instance */\n                    private final Map<String, Object> singletonObjects = new ConcurrentHashMap<String, Object>(256);\n                    \n                    /** Cache of singleton factories: bean name --> ObjectFactory */\n                    private final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<String, ObjectFactory<?>>(16);\n                    \n                    /** Cache of early singleton objects: bean name --> bean instance */\n                    private final Map<String, Object> earlySingletonObjects = new HashMap<String, Object>(16);\n                    ```\n\n    - 4. Bean  getBean \n\n        - \n            1.  InstantiationAwareBeanPostProcessor  @Autowire  AutowiredAnnotationBeanPostProcessor  InstantiationAwareBeanPostProcessor \n            2.  PropertyValues \n            3.  PropertyValues BeanWrapper BeanFactory.getBean \n\n    - 5.\n\n        1. Aware Spring  Bean Aware Bean \n        2.  BeanPostProcessorIOCAOP  Bean AOP\n        3.  init \n            1.  InitializingBean\n            2.  init \n\n    - 6. Bean FactoryBean  getObject  TypeConverter \n\n### Bean\n\n- ![image20210918174436691](https://i.loli.net/2021/09/18/162nF7qvMfN8iKy.png)\n- :\n    1. SpringSpringbeanBean\n    2. BeanBeanBean\n    3. BeanBeanNameAwareSpringBeanIdsetBeanName()\n    4. BeanBeanFactoryAwareSpringsetBeanFactory()BeanFactory\n    5. BeanApplicationContextAwareSpringBeansetApplicationContext()bean\n    6. BeanBeanPostProcessorSpringpostProcessBeforeInitialization()\n    7. Bean InitializingBeanSpringafterPropertiesSet()beaninit-method\n    8. Bean BeanPostProcessorSpringpostProcessAfterInitialization()\n    9. Bean\n    10. beanDisposableBeanSpringdestory()beandestory-method \n\n### \n\n- \n\n    -  commit()rollback()\n    - \n        1. spring\n        2. Transactional\n\n- \n\n    1. \n    2. \n    3. \n    4. \n\n- \n\n    1. ABBA\n    2. ABA\n    3. (mysql)ABA\n    4. readwrite\n\n- \n\n    - \n        - ABBA\n    - \n        - ABA\n    - \n        - ABA\n\n- Propagation\n\n    \t// \n\n    - Propagation.REQUIRED:\n\n    - SUPPORTS:\n\n    - MANDATORY:\n\n        // \n\n    - REQUIRES_NEW:\n\n    - NOT_SUPPORTED:\n\n    - NEVER:\n\n    - NESTED:PROPAGATION_REQUIRED\n\n## mysql\n\n### MyISAMInnoDB\n\n1. InnoDBMyISAM\n2. InnoDBMyISAM\n3. InnoDBMyISAM  InnoDB  MyISAM \n4. InnoDB  select count(*) from table MyISAM \n5. InnoDB MyISAM  MySQL  MyISAM  InnoDB \n\n### \n\n:\n\n1. \n2. \n3. \n\n### B-\n\n- \n\n- \n\n    1. MM>2\n    2. 2 M\n    3. M/2M\n    4. M/2-1M-12\n    5. =-1\n    6. K[1], K[2], , K[M-1]K[i] < K[i+1]\n    7. P[1], P[2], , P[M]P[1]K[1]P[M]K[M-1]P[i](K[i-1], K[i])\n    8. \n\n    ![image-20210918191232742](https://i.loli.net/2021/09/18/GU86gywBaA7cIiQ.png)\n\n- \n\n    1. \n    2. \n    3. \n    4. \n    5. \n\n### B+\n\n- B+B-\n\n    ![image-20210918191302660](https://i.loli.net/2021/09/18/mV5WLp2BusgXeqr.png)\n\n- \n\n    1. \n    2. P[i][K[i], K[i+1])B-\n    3. \n    4. \n\n### \n\n- B\n- B-M/2M\n- B+B-B+\n\n## HTTP\n\n### \n\n### \n\n### HTTP1.0HTTP1.1\n\n- 1.(Persistent Connection)\n    - HTTP1.0keep-alive\n    - HTTP1.1TCPHTTPHTTP1.1keep-aliveHTTP1.0\n- 2.\n    - HTTP1.0\n    - HTTP1.1headerbody100100body401body\n- 3.HOST\n    - HTTP1.0IPURLhostnameHTTP1.0hostMulti-homed Web ServersIP\n    - HTTP1.1hosthost400 Bad Request\n- 4.\n    - HTTP1.0headerIf-Modified-Since,Expires\n    - HTTP1.1Entity tagIf-Unmodified-Since, If-Match, If-None-Match\n- 5.\n    - HTTP1.124409Conflict410Gone\n\n### HTTP1.1HTTP2.0\n\n- 1.\n    - HTTP2.0HTTP1.1\n    - HTTP1.1TCPTCP\n- 2.\n    - HTTP1.1headerHTTP/gzipWebUserAgentCookie\n    - HTTP2.0HPACKheader\n- 3.\n    - HTMLHTTP1.1HTML\n    - HTTP2.0server push\n\n### TIME_WAITCLOSE_WAIT\n\n- TIME_WAIT/etc/sysctl.confTIME_WAIT\n- CLOSE_WAITack  ESTABLISHED\n\n### Https\n\n- HTTPS\n- :\n- publickeyprivatekey\n\n### sessioncookie\n\n- 1.\n    - cookie\n    - session\n- 2.\n    - cookie<=4KB20Cookie\n    - sessionsessionsession\n- 3.\n    - cookieASCIIUnicode\n    - sessionstringintegerlistmap\n- 4.\n    - cookiecookiecookie\n    - session\n- 5.\n    - cookiecookie\n    - sessionJSESSIONIDcookiecookie JSESSIONID-1sessionsession\n- 6.\n    - cookiecookie\n    - sessionsessionsession\n- 7.\n    - cookie\n        - cookiecookiecookieWAPcookie\n        - sessionURLsessionURLURLsession\n    - cookie\n        - cookie\n        - session\n- 8.\n    - cookie\n    - session\n\n## \n\n## ","source":"_posts/java-outline.md","raw":"---\ntitle: JAVA\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop: 1\ntags:\n  - java\n  - spring\n  - mysql\n  - http\ncategories:\n  - work\nabbrlink: 2de3\ndate: 2020-10-15 20:50:34\nsubtitle:\n---\n\n## JVM\n\n### \n\n> (cpu)\n\n- \n- OutOfMemory\n\n### Java\n\n> Java\n>\n> \n>\n> \n\n- \n    1.  \n    2. \n    3. \n    4. \n- \n    1. StackOverflowError\n    2. OutOfMemory\n\n### \n\n- ,Java()nativecc++\n\n### \n\n> \n>\n> 1javareference\n>\n> 2\n>\n> 3\n\n-  JIT()\n- OOM(OutOfMemoryError)\n\n### \n\n- static\n\n## \n\n### \n\n- \n    - +1-10\n    - ---1\n- \n    - GCroot\n    - GCrootGCJavaGC,GC roots,GC rootsGC\n        1. ---\n        2. \n        3. \n        4. JNInative\n\n### ---\n\n- 1. -\n\n      - \n        1. mutatorNEW()READ()WRITE()\n        2. collectormutatorNEW\n      - \n        - collectormutatormutatorheader\n        - collector(heap memory)-header\n        - TipsCollector(mutator)Stop-The-World\n      - 13MutatorCollectorOut of Memory\n\n- 2.\n\n    -  \n    - \n    - \n    - \n\n- 3.-\n\n    -  \n\n        - \n        - \n\n    - \n\n    - \n\n    - \n\n        >  > \n\n- \n\n    - \n    - \n        - \n            1. Eden \n            2. Survivor \n            3. Tenured Gen \n        - ****EdenSurvivorEdenSurvivorEdenSurvivorSurvivorEdenSurvivor\n    - \n        - ****\n\n### ---\n\n- Serial/Serial Old\n\n    - \n        1. \n        2. \n        3. SerialSerial Old\n    - \n    - \n\n- ParNew\n\n    - \n\n        \tSerial\n\n- Parallel Scavenge\n\n    - \n        1. \n        2. \n\n- Parallel Old\n\n    - \n        1. Parallel Scavenge\n        2. \n\n- CMSConcurrent Mark Sweep\n\n    - \n        1. \n        2. -\n    - \n    - \n        1. CPU\n        2. \n        3. ConcurrentMode Failure\n        4. \n\n- G1\n\n    - \n        1. \n        2. \n\n\n\n- \n    - SerialParNewParallel Scavenge\n- \n    - Serial OldParallel OldCMS\n- \n    - G1[]\n\n## \n\n### \n\n- \n\n    1. \n    2. \n    3.  Class ,\n    4. Tips loadClass()  Java \n\n- \n\n    - class \n\n        ![image20210918170036312](https://i.loli.net/2021/09/18/F1BQWefNcAYUEDy.png)\n\n- \n\n    - staticstatic int i = 5  i 0 i 5)finalstatic finalJava\n\n- \n\n    - \n\n- \n\n    - static \n\n        ![image20210918170449021](https://i.loli.net/2021/09/18/RLuVIpE7OWAx4Mz.png)\n\n### \n\n- JVM\n- JVMpgPersonClassLoaderklPersonClassJVM(Person.pg.kl)\n- JVM\n    - 1.\n        -  Java $JAVA_HOMEjre/lib/rt.jarclassC++ClassLoader\n    - 2.\n        - JRElib/extjava.ext.dirsJARJavanull\n    - 3.\n        - JVMCLASSPATHJARClassLoadergetSystemClassLoader()JavaExtClassLoader\n\n### \n\n- 1.\n\n    - ClassClassClass\n\n- 2.\n\n    - \n\n        ![image20210918170625728](https://i.loli.net/2021/09/18/tJyd5oZ3aBS1pm9.png)\n\n    - \n\n        - 1.ClassLoader\n        - 2.APIjava.lang.IntegerJava APIInteger.class\n\n- 3.\n\n    - ClassClassClassClassClassClassJVM\n\n### forNameloaderClass\n\n- Class.forName()class\n- Classloader.loaderClassclass\n\n### \n\n- ObjectObject\n\n### \n\n- markword\n\n    - 3286416\n\n    - \n\n        ![image20210918171629651](https://i.loli.net/2021/09/18/5UlmYsTDcFwKuX9.png)\n\n- \n\n    - \n    - :doublelong\n\n- \n\n    - JVM\n    - HotSpot8\n\n## synchronized\n\n### \n\n### JMMsynchronized\n\n- \n- \n\n### \n\n1. \n2. \n3. \n4. \n5. \n6. \n\n### \n\n1. Mark WordID\n2. CASIDMard Word1\n3. \n4. CASMark Word\n5. \n6. \n7. \n\n### synchronized \n\n- synchronizedvolatilesynchronizedvolatile\n\n### \n\n- \n\n- \n\n    ```java\n    // \n    class Zhangsan {\n        public void say() {\n            System.out.println(\"\");\n        }\n    \n        public void get() {\n            System.out.println(\"\");\n        }\n    }\n    \n    // \n    class Lisi {\n        public void say() {\n            System.out.println(\"\");\n        }\n    \n        public void get() {\n            System.out.println(\"\");\n        }\n    \n    }\n    \n    public class ThreadDeadLock implements Runnable {\n    \n        private static Zhangsan zs = new Zhangsan();    // static\n    \n        private static Lisi ls = new Lisi();    // static\n    \n        private boolean flag = false; // \n    \n        public void run() { // run()\n            if (flag) {\n                synchronized (zs) {  // \n                    zs.say();\n                    try {\n                        Thread.sleep(500);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (ls) {\n                        zs.get();\n                    }\n                }\n            } else {\n                synchronized (ls) {\n                    ls.say();\n                    try {\n                        Thread.sleep(500);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                    synchronized (zs) {\n                        ls.get();\n                    }\n                }\n            }\n        }\n    \n        public static void main(String args[]) {\n            ThreadDeadLock t1 = new ThreadDeadLock();   // \n            ThreadDeadLock t2 = new ThreadDeadLock();   // \n            t1.flag = true;\n            t2.flag = false;\n            Thread thA = new Thread(t1);\n            Thread thB = new Thread(t2);\n            thA.start();\n            thB.start();\n        }\n    }\n    //   \n    ```\n\n- \n\n    - \n    - \n    - \n\n## JUC\n\n### volatile\n\n- JMM\n\n    ![image20210918171727328](https://i.loli.net/2021/09/18/F23tz5UOqCEwJbA.png)\n\n- \n\n    - \n        1. volatilestore\n        2. volatileload\n    - volatile\n        1. volatile\n        2. \n    - volatile\n        1. volatile\n        2. volatile\n\n- \n\n    -  i++ --\n    - \n        1. synchronized\n        2. ReentrantLock\n        3. AtomicInterger\n\n- \n\n    - n = n + 1 n ++\n    - ,  n < m\n\n- synchronizedvolatile\n\n    - volatilesynchronized\n    - volatilevolatile\n    - synchronizedvolatile\n\n- double checkvolatile\n\n    ```java\n    public class SingletonClass {\n    \n        private static SingletonClass instance = null;\n        //private static volatile SingletonClass instance = null;\n    \n        public static SingletonClass getInstance() {\n            if (instance == null) {\n                synchronized (SingletonClass.class) {\n                    if (instance == null) {\n                        instance = new SingletonClass();\n                    }\n                }\n            }\n            return instance;\n        }\n    }\n    ```\n\n    - **new,1.2.3.**1->2->3231->3>2ifvolatilevolatileifvolatilehappen-beforenewSingletonClass()\n\n### AtomicCAS\n\n- \n    1. AtomicBoolean AtomicInteger AtomicLong  AtomicReference \n    2. AtomicIntegerArray AtomicLongArray 3.AtomicStampedReferenceABA\n- \n    - boolean compareAndSet(expectedValue, updateValue) CASUnsafeCPU\n\n### LocksAQS\n\n- ReentrantLock\n    - \n    - ReentrantLock/Synchorized \n    - lock\n- ReadWriteLock\n\n### Collections\n\n- Queue\n    - ConcurrentLinkedQueue\n    - BlockingQueue\n    - Deque\n- CopyOnWriteArraySet\n- CopyOnWriteArrayList\n- ConcurrentSkipListSet\n- ConcurrentMap\n    - ConcurrentHashMap\n    - ConcurrentNavigableMap\n        - ConcurrentSkipListMap\n\n### Executor\n\n- Future\n    - RunnableFuture\n        - RunnableScheduledFuture\n        - FutureTask\n    - ScheduledFuture\n- Callable\n- Executor\n    - ExecutorService\n        - ScheduledExecutorService\n            - ScheduledThreadPoolExecutor\n        - ThreadPoolExecutor\n- CompletionService\n    - ExecutorCompletionService\n- RejectedExecutionHandler\n    - ThreadPoolExecutor.DiscardPolicy\n    - ThreadPoolExecutor.DiscardOldestPolicy\n    - ThreadPoolExecutor.CallerRunsPolicy\n    - ThreadPoolExecutor.AbortPolicy\n- TimeUnit\n\n### Tools\n\n- CountDownLatch\n- CyclicBarrier\n- Semaphore\n- Executors\n- Exchanger\n\n## TODO \n\n### Map\n\n- HashMap\n\n    > // EnterykeyvaluenextNode // key-valuehash(key)hashindexFor(hash,length)key-value // hash&0x7FFFFFFF(16)lengthkey-valueHashMap // hashNodenextnull1.8Node1.87 // 6Node\n\n    - +(1.8++)\n    - AbstractMapkeynullvaluenull16\n    - jdk1.71.8 1) 1.7hash+1.8hash++>7 2) hashcode1.7451.811 3)1.71.8+\n    - 2 2n1hash2n1hashreturnh&(length-1)00001100111011entry\n\n- Hashtable\n\n    > // HashTablesynchronizedHashTable // HashTableHashTable // 1put2putget\n\n    - HashtableDictionarykeyvaluenull11\n\n- ConcurrentHashMap\n\n    > // ConcurrentHashMapAbstractMapConcurrentHashMap HashEntry  Segment > // HashEntry  / ;Segment  > //  ConcurrentHashMap  Segment  HashEntry  > // SegmentHashEntry,HashEntrySegment > // putgetsize()containsValue() > // ConcurrentHashMapfinalfinal > // finalfinal\n\n    - ConcurrentHashMapAbstractMap\n\n- LinkedHashMap\n\n    - LinkedHashMapHashMap+/\n    - nullnull\n\n- TreeMap\n\n    - TreeMapSortedMapnullnull\n    - keycomparatorvalue\n    - Red-Black tree containsKeygetput  remove  log(n)\n\n### List\n\n- ArrayList\n    - ArrayList()\n- Vector\n    - Vector(synchronized)\n- LinkedList\n    - LinkedList()\n\n### Set\n\n- HashSet\n    - HashSetHash\n- LinkedHashSet\n    - LinkedHashSet\n    - HashSetLinkedHashMap \n- TreeSet\n    - TreeSet\n\n### \n\n> TreeMapTreeSetjava8HashMap\n\n- \n    1. \n    2. \n    3. \n    4. \n- 34\n    1. \n    2. \n\n## spring\n\n### IoCDI\n\n- IoC \n- DI springIoCDI\n- \n    1. \n    2. \n    3. \n\n### AOP\n\n### spring\n\n- xmlbean\n\n- bean  ->  ->  ->  -> \n\n    - 1.BeanNamenameMapBeanDefinitionbean name\n\n        -  Map beanName  keyBeanFactory.getBean  name\n            1. bean name BeanDefinition\n            2. alias namealias name  bean name  SimpleAliasRegistry  beanName\n            3. factorybean name,  &  BeanDefinition  & \n\n    - 2. BeanDefinition Bean \n\n        -  BeanDefinition  GenericBeanDefinition, Bean  RootBeanDefinition,GenericBeanDefinition     parentName  RootBeanDefinition.overrideFrom  \n\n    - 3. Bean + \n\n        -  RootBeanDefintion  Bean AbstractAutowireCapableBeanFactory.createBeanInstance  Bean  BeanWrapper\n\n            1. instantiateUsingFactoryMethod \n            2. autowireConstructor\n            3. instantiateBean\n\n             getInstantiationStrategy().instantiate()  replace  lookup  \n\n        - ****\n\n            1.  Bean \n            2.  setter   A  B B  C C  A A \n\n            - Spring Spring \n\n            -   Spring  DefaultSingletonBeanRegistry \n\n                1. singletonObjects\n\n                2. singletonFactories\n\n                3. earlySingletonObjects  singletonObjects  singletonFactory  singletonFactories  singletonFactory getEarlyBeanReference  earlySingletonObjects   earlySingletonObjects  earlySingletonObjects  getEarlyBeanReference  C  A A  B A \n\n                    ```java\n                    /** Cache of singleton objects: bean name --> bean instance */\n                    private final Map<String, Object> singletonObjects = new ConcurrentHashMap<String, Object>(256);\n                    \n                    /** Cache of singleton factories: bean name --> ObjectFactory */\n                    private final Map<String, ObjectFactory<?>> singletonFactories = new HashMap<String, ObjectFactory<?>>(16);\n                    \n                    /** Cache of early singleton objects: bean name --> bean instance */\n                    private final Map<String, Object> earlySingletonObjects = new HashMap<String, Object>(16);\n                    ```\n\n    - 4. Bean  getBean \n\n        - \n            1.  InstantiationAwareBeanPostProcessor  @Autowire  AutowiredAnnotationBeanPostProcessor  InstantiationAwareBeanPostProcessor \n            2.  PropertyValues \n            3.  PropertyValues BeanWrapper BeanFactory.getBean \n\n    - 5.\n\n        1. Aware Spring  Bean Aware Bean \n        2.  BeanPostProcessorIOCAOP  Bean AOP\n        3.  init \n            1.  InitializingBean\n            2.  init \n\n    - 6. Bean FactoryBean  getObject  TypeConverter \n\n### Bean\n\n- ![image20210918174436691](https://i.loli.net/2021/09/18/162nF7qvMfN8iKy.png)\n- :\n    1. SpringSpringbeanBean\n    2. BeanBeanBean\n    3. BeanBeanNameAwareSpringBeanIdsetBeanName()\n    4. BeanBeanFactoryAwareSpringsetBeanFactory()BeanFactory\n    5. BeanApplicationContextAwareSpringBeansetApplicationContext()bean\n    6. BeanBeanPostProcessorSpringpostProcessBeforeInitialization()\n    7. Bean InitializingBeanSpringafterPropertiesSet()beaninit-method\n    8. Bean BeanPostProcessorSpringpostProcessAfterInitialization()\n    9. Bean\n    10. beanDisposableBeanSpringdestory()beandestory-method \n\n### \n\n- \n\n    -  commit()rollback()\n    - \n        1. spring\n        2. Transactional\n\n- \n\n    1. \n    2. \n    3. \n    4. \n\n- \n\n    1. ABBA\n    2. ABA\n    3. (mysql)ABA\n    4. readwrite\n\n- \n\n    - \n        - ABBA\n    - \n        - ABA\n    - \n        - ABA\n\n- Propagation\n\n    \t// \n\n    - Propagation.REQUIRED:\n\n    - SUPPORTS:\n\n    - MANDATORY:\n\n        // \n\n    - REQUIRES_NEW:\n\n    - NOT_SUPPORTED:\n\n    - NEVER:\n\n    - NESTED:PROPAGATION_REQUIRED\n\n## mysql\n\n### MyISAMInnoDB\n\n1. InnoDBMyISAM\n2. InnoDBMyISAM\n3. InnoDBMyISAM  InnoDB  MyISAM \n4. InnoDB  select count(*) from table MyISAM \n5. InnoDB MyISAM  MySQL  MyISAM  InnoDB \n\n### \n\n:\n\n1. \n2. \n3. \n\n### B-\n\n- \n\n- \n\n    1. MM>2\n    2. 2 M\n    3. M/2M\n    4. M/2-1M-12\n    5. =-1\n    6. K[1], K[2], , K[M-1]K[i] < K[i+1]\n    7. P[1], P[2], , P[M]P[1]K[1]P[M]K[M-1]P[i](K[i-1], K[i])\n    8. \n\n    ![image-20210918191232742](https://i.loli.net/2021/09/18/GU86gywBaA7cIiQ.png)\n\n- \n\n    1. \n    2. \n    3. \n    4. \n    5. \n\n### B+\n\n- B+B-\n\n    ![image-20210918191302660](https://i.loli.net/2021/09/18/mV5WLp2BusgXeqr.png)\n\n- \n\n    1. \n    2. P[i][K[i], K[i+1])B-\n    3. \n    4. \n\n### \n\n- B\n- B-M/2M\n- B+B-B+\n\n## HTTP\n\n### \n\n### \n\n### HTTP1.0HTTP1.1\n\n- 1.(Persistent Connection)\n    - HTTP1.0keep-alive\n    - HTTP1.1TCPHTTPHTTP1.1keep-aliveHTTP1.0\n- 2.\n    - HTTP1.0\n    - HTTP1.1headerbody100100body401body\n- 3.HOST\n    - HTTP1.0IPURLhostnameHTTP1.0hostMulti-homed Web ServersIP\n    - HTTP1.1hosthost400 Bad Request\n- 4.\n    - HTTP1.0headerIf-Modified-Since,Expires\n    - HTTP1.1Entity tagIf-Unmodified-Since, If-Match, If-None-Match\n- 5.\n    - HTTP1.124409Conflict410Gone\n\n### HTTP1.1HTTP2.0\n\n- 1.\n    - HTTP2.0HTTP1.1\n    - HTTP1.1TCPTCP\n- 2.\n    - HTTP1.1headerHTTP/gzipWebUserAgentCookie\n    - HTTP2.0HPACKheader\n- 3.\n    - HTMLHTTP1.1HTML\n    - HTTP2.0server push\n\n### TIME_WAITCLOSE_WAIT\n\n- TIME_WAIT/etc/sysctl.confTIME_WAIT\n- CLOSE_WAITack  ESTABLISHED\n\n### Https\n\n- HTTPS\n- :\n- publickeyprivatekey\n\n### sessioncookie\n\n- 1.\n    - cookie\n    - session\n- 2.\n    - cookie<=4KB20Cookie\n    - sessionsessionsession\n- 3.\n    - cookieASCIIUnicode\n    - sessionstringintegerlistmap\n- 4.\n    - cookiecookiecookie\n    - session\n- 5.\n    - cookiecookie\n    - sessionJSESSIONIDcookiecookie JSESSIONID-1sessionsession\n- 6.\n    - cookiecookie\n    - sessionsessionsession\n- 7.\n    - cookie\n        - cookiecookiecookieWAPcookie\n        - sessionURLsessionURLURLsession\n    - cookie\n        - cookie\n        - session\n- 8.\n    - cookie\n    - session\n\n## \n\n## ","slug":"java-outline","published":1,"updated":"2021-11-10T13:43:16.137Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweex001kkh6zaywq4uv2","content":"<h2 id=\"JVM\"><a href=\"#JVM\" class=\"headerlink\" title=\"JVM\"></a>JVM</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>(cpu)</p>\n</blockquote>\n<ul>\n<li></li>\n<li>OutOfMemory</li>\n</ul>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><blockquote>\n<p>Java</p>\n<p></p>\n<p></p>\n</blockquote>\n<ul>\n<li><ol>\n<li> </li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li><ol>\n<li>StackOverflowError</li>\n<li>OutOfMemory</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>,Java()nativecc++</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n<p>1javareference</p>\n<p>2</p>\n<p>3</p>\n</blockquote>\n<ul>\n<li> JIT()</li>\n<li>OOM(OutOfMemoryError)</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>static</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><ul>\n<li>+1-10</li>\n<li>1</li>\n</ul>\n</li>\n<li><ul>\n<li>GCroot</li>\n<li>GCrootGCJavaGC,GC roots,GC rootsGC<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>JNInative</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><ol>\n<li><p>-</p>\n<ul>\n<li><ol>\n<li>mutatorNEW()READ()WRITE()</li>\n<li>collectormutatorNEW</li>\n</ol>\n</li>\n<li><ul>\n<li>collectormutatormutatorheader</li>\n<li>collector(heap memory)-header</li>\n<li>TipsCollector(mutator)Stop-The-World</li>\n</ul>\n</li>\n<li>13MutatorCollectorOut of Memory</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><p>2.</p>\n<ul>\n<li> </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p>3.-</p>\n<ul>\n<li><p> </p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<blockquote>\n<p> &gt; </p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li><ul>\n<li><ol>\n<li>Eden </li>\n<li>Survivor </li>\n<li>Tenured Gen </li>\n</ol>\n</li>\n<li><strong></strong>EdenSurvivorEdenSurvivorEdenSurvivorSurvivorEdenSurvivor</li>\n</ul>\n</li>\n<li><ul>\n<li><strong></strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>Serial/Serial Old</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n<li>SerialSerial Old</li>\n</ol>\n</li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p>ParNew</p>\n<ul>\n<li><p></p>\n<p>      Serial</p>\n</li>\n</ul>\n</li>\n<li><p>Parallel Scavenge</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>Parallel Old</p>\n<ul>\n<li><ol>\n<li>Parallel Scavenge</li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>CMSConcurrent Mark Sweep</p>\n<ul>\n<li><ol>\n<li></li>\n<li>-</li>\n</ol>\n</li>\n<li></li>\n<li><ol>\n<li>CPU</li>\n<li></li>\n<li>ConcurrentMode Failure</li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>G1</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<p></p>\n<ul>\n<li><ul>\n<li>SerialParNewParallel Scavenge</li>\n</ul>\n</li>\n<li><ul>\n<li>Serial OldParallel OldCMS</li>\n</ul>\n</li>\n<li><ul>\n<li>G1[]</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li> Class ,</li>\n<li>Tips loadClass()  Java </li>\n</ol>\n</li>\n<li><p></p>\n<ul>\n<li><p>class </p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/F1BQWefNcAYUEDy.png\" alt=\"image20210918170036312\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>staticstatic int i = 5  i 0 i 5)finalstatic finalJava</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p>static </p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/RLuVIpE7OWAx4Mz.png\" alt=\"image20210918170449021\"></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>JVM</li>\n<li>JVMpgPersonClassLoaderklPersonClassJVM(Person.pg.kl)</li>\n<li>JVM<ul>\n<li>1.<ul>\n<li> Java $JAVA_HOMEjre/lib/rt.jarclassC++ClassLoader</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>JRElib/extjava.ext.dirsJARJavanull</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>JVMCLASSPATHJARClassLoadergetSystemClassLoader()JavaExtClassLoader</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>1.</p>\n<ul>\n<li>ClassClassClass</li>\n</ul>\n</li>\n<li><p>2.</p>\n<ul>\n<li><p></p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/tJyd5oZ3aBS1pm9.png\" alt=\"image20210918170625728\"></p>\n</li>\n<li><p></p>\n<ul>\n<li>1.ClassLoader</li>\n<li>2.APIjava.lang.IntegerJava APIInteger.class</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>3.</p>\n<ul>\n<li>ClassClassClassClassClassClassJVM</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"forNameloaderClass\"><a href=\"#forNameloaderClass\" class=\"headerlink\" title=\"forNameloaderClass\"></a>forNameloaderClass</h3><ul>\n<li>Class.forName()class</li>\n<li>Classloader.loaderClassclass</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>ObjectObject</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>markword</p>\n<ul>\n<li><p>3286416</p>\n</li>\n<li><p></p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/5UlmYsTDcFwKuX9.png\" alt=\"image20210918171629651\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li>:doublelong</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>JVM</li>\n<li>HotSpot8</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"JMMsynchronized\"><a href=\"#JMMsynchronized\" class=\"headerlink\" title=\"JMMsynchronized\"></a>JMMsynchronized</h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>Mark WordID</li>\n<li>CASIDMard Word1</li>\n<li></li>\n<li>CASMark Word</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h3><ul>\n<li>synchronizedvolatilesynchronizedvolatile</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Zhangsan</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Lisi</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadDeadLock</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Zhangsan zs = <span class=\"keyword\">new</span> Zhangsan();    <span class=\"comment\">// static</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Lisi ls = <span class=\"keyword\">new</span> Lisi();    <span class=\"comment\">// static</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> flag = <span class=\"keyword\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123; <span class=\"comment\">// run()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (zs) &#123;  <span class=\"comment\">// </span></span><br><span class=\"line\">                zs.say();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (ls) &#123;</span><br><span class=\"line\">                    zs.get();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ls) &#123;</span><br><span class=\"line\">                ls.say();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (zs) &#123;</span><br><span class=\"line\">                    ls.get();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span> </span>&#123;</span><br><span class=\"line\">        ThreadDeadLock t1 = <span class=\"keyword\">new</span> ThreadDeadLock();   <span class=\"comment\">// </span></span><br><span class=\"line\">        ThreadDeadLock t2 = <span class=\"keyword\">new</span> ThreadDeadLock();   <span class=\"comment\">// </span></span><br><span class=\"line\">        t1.flag = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        t2.flag = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        Thread thA = <span class=\"keyword\">new</span> Thread(t1);</span><br><span class=\"line\">        Thread thB = <span class=\"keyword\">new</span> Thread(t2);</span><br><span class=\"line\">        thA.start();</span><br><span class=\"line\">        thB.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//   </span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"JUC\"><a href=\"#JUC\" class=\"headerlink\" title=\"JUC\"></a>JUC</h2><h3 id=\"volatile\"><a href=\"#volatile\" class=\"headerlink\" title=\"volatile\"></a>volatile</h3><ul>\n<li><p>JMM</p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/F23tz5UOqCEwJbA.png\" alt=\"image20210918171727328\"></p>\n</li>\n<li><p></p>\n<ul>\n<li><ol>\n<li>volatilestore</li>\n<li>volatileload</li>\n</ol>\n</li>\n<li>volatile<ol>\n<li>volatile</li>\n<li></li>\n</ol>\n</li>\n<li>volatile<ol>\n<li>volatile</li>\n<li>volatile</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> i++ --</li>\n<li><ol>\n<li>synchronized</li>\n<li>ReentrantLock</li>\n<li>AtomicInterger</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>n = n + 1 n ++</li>\n<li>,  n &lt; m</li>\n</ul>\n</li>\n<li><p>synchronizedvolatile</p>\n<ul>\n<li>volatilesynchronized</li>\n<li>volatilevolatile</li>\n<li>synchronizedvolatile</li>\n</ul>\n</li>\n<li><p>double checkvolatile</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SingletonClass</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SingletonClass instance = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">//private static volatile SingletonClass instance = null;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> SingletonClass <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (SingletonClass<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    instance = <span class=\"keyword\">new</span> SingletonClass();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>new,1.2.3.</strong>1-&gt;2-&gt;3231-&gt;3&gt;2ifvolatilevolatileifvolatilehappen-beforenewSingletonClass()</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"AtomicCAS\"><a href=\"#AtomicCAS\" class=\"headerlink\" title=\"AtomicCAS\"></a>AtomicCAS</h3><ul>\n<li><ol>\n<li>AtomicBoolean AtomicInteger AtomicLong  AtomicReference </li>\n<li>AtomicIntegerArray AtomicLongArray 3.AtomicStampedReferenceABA</li>\n</ol>\n</li>\n<li><ul>\n<li>boolean compareAndSet(expectedValue, updateValue) CASUnsafeCPU</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"LocksAQS\"><a href=\"#LocksAQS\" class=\"headerlink\" title=\"LocksAQS\"></a>LocksAQS</h3><ul>\n<li>ReentrantLock<ul>\n<li></li>\n<li>ReentrantLock/Synchorized </li>\n<li>lock</li>\n</ul>\n</li>\n<li>ReadWriteLock</li>\n</ul>\n<h3 id=\"Collections\"><a href=\"#Collections\" class=\"headerlink\" title=\"Collections\"></a>Collections</h3><ul>\n<li>Queue<ul>\n<li>ConcurrentLinkedQueue</li>\n<li>BlockingQueue</li>\n<li>Deque</li>\n</ul>\n</li>\n<li>CopyOnWriteArraySet</li>\n<li>CopyOnWriteArrayList</li>\n<li>ConcurrentSkipListSet</li>\n<li>ConcurrentMap<ul>\n<li>ConcurrentHashMap</li>\n<li>ConcurrentNavigableMap<ul>\n<li>ConcurrentSkipListMap</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Executor\"><a href=\"#Executor\" class=\"headerlink\" title=\"Executor\"></a>Executor</h3><ul>\n<li>Future<ul>\n<li>RunnableFuture<ul>\n<li>RunnableScheduledFuture</li>\n<li>FutureTask</li>\n</ul>\n</li>\n<li>ScheduledFuture</li>\n</ul>\n</li>\n<li>Callable</li>\n<li>Executor<ul>\n<li>ExecutorService<ul>\n<li>ScheduledExecutorService<ul>\n<li>ScheduledThreadPoolExecutor</li>\n</ul>\n</li>\n<li>ThreadPoolExecutor</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CompletionService<ul>\n<li>ExecutorCompletionService</li>\n</ul>\n</li>\n<li>RejectedExecutionHandler<ul>\n<li>ThreadPoolExecutor.DiscardPolicy</li>\n<li>ThreadPoolExecutor.DiscardOldestPolicy</li>\n<li>ThreadPoolExecutor.CallerRunsPolicy</li>\n<li>ThreadPoolExecutor.AbortPolicy</li>\n</ul>\n</li>\n<li>TimeUnit</li>\n</ul>\n<h3 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><ul>\n<li>CountDownLatch</li>\n<li>CyclicBarrier</li>\n<li>Semaphore</li>\n<li>Executors</li>\n<li>Exchanger</li>\n</ul>\n<h2 id=\"TODO-\"><a href=\"#TODO-\" class=\"headerlink\" title=\"TODO \"></a>TODO </h2><h3 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h3><ul>\n<li><p>HashMap</p>\n<blockquote>\n<p>// EnterykeyvaluenextNode // key-valuehash(key)hashindexFor(hash,length)key-value // hash&amp;0x7FFFFFFF(16)lengthkey-valueHashMap // hashNodenextnull1.8Node1.87 // 6Node</p>\n</blockquote>\n<ul>\n<li>+(1.8++)</li>\n<li>AbstractMapkeynullvaluenull16</li>\n<li>jdk1.71.8 1) 1.7hash+1.8hash++&gt;7 2) hashcode1.7451.811 3)1.71.8+</li>\n<li>2 2n1hash2n1hashreturnh&amp;(length-1)00001100111011entry</li>\n</ul>\n</li>\n<li><p>Hashtable</p>\n<blockquote>\n<p>// HashTablesynchronizedHashTable // HashTableHashTable // 1put2putget</p>\n</blockquote>\n<ul>\n<li>HashtableDictionarykeyvaluenull11</li>\n</ul>\n</li>\n<li><p>ConcurrentHashMap</p>\n<blockquote>\n<p>// ConcurrentHashMapAbstractMapConcurrentHashMap HashEntry  Segment &gt; // HashEntry  / ;Segment  &gt; //  ConcurrentHashMap  Segment  HashEntry  &gt; // SegmentHashEntry,HashEntrySegment &gt; // putgetsize()containsValue() &gt; // ConcurrentHashMapfinalfinal &gt; // finalfinal</p>\n</blockquote>\n<ul>\n<li>ConcurrentHashMapAbstractMap</li>\n</ul>\n</li>\n<li><p>LinkedHashMap</p>\n<ul>\n<li>LinkedHashMapHashMap+/</li>\n<li>nullnull</li>\n</ul>\n</li>\n<li><p>TreeMap</p>\n<ul>\n<li>TreeMapSortedMapnullnull</li>\n<li>keycomparatorvalue</li>\n<li>Red-Black tree containsKeygetput  remove  log(n)</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3><ul>\n<li>ArrayList<ul>\n<li>ArrayList()</li>\n</ul>\n</li>\n<li>Vector<ul>\n<li>Vector(synchronized)</li>\n</ul>\n</li>\n<li>LinkedList<ul>\n<li>LinkedList()</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Set\"><a href=\"#Set\" class=\"headerlink\" title=\"Set\"></a>Set</h3><ul>\n<li>HashSet<ul>\n<li>HashSetHash</li>\n</ul>\n</li>\n<li>LinkedHashSet<ul>\n<li>LinkedHashSet</li>\n<li>HashSetLinkedHashMap </li>\n</ul>\n</li>\n<li>TreeSet<ul>\n<li>TreeSet</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>TreeMapTreeSetjava8HashMap</p>\n</blockquote>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li>34<ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h2 id=\"spring\"><a href=\"#spring\" class=\"headerlink\" title=\"spring\"></a>spring</h2><h3 id=\"IoCDI\"><a href=\"#IoCDI\" class=\"headerlink\" title=\"IoCDI\"></a>IoCDI</h3><ul>\n<li>IoC </li>\n<li>DI springIoCDI</li>\n<li><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"AOP\"><a href=\"#AOP\" class=\"headerlink\" title=\"AOP\"></a>AOP</h3><h3 id=\"spring\"><a href=\"#spring\" class=\"headerlink\" title=\"spring\"></a>spring</h3><ul>\n<li><p>xmlbean</p>\n</li>\n<li><p>bean  -&gt;  -&gt;  -&gt;  -&gt; </p>\n<ul>\n<li><p>1.BeanNamenameMapBeanDefinitionbean name</p>\n<ul>\n<li> Map beanName  keyBeanFactory.getBean  name<ol>\n<li>bean name BeanDefinition</li>\n<li>alias namealias name  bean name  SimpleAliasRegistry  beanName</li>\n<li>factorybean name,  &amp;  BeanDefinition  &amp; </li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>2. BeanDefinition Bean </p>\n<ul>\n<li> BeanDefinition  GenericBeanDefinition, Bean  RootBeanDefinition,GenericBeanDefinition     parentName  RootBeanDefinition.overrideFrom  </li>\n</ul>\n</li>\n<li><p>3. Bean + </p>\n<ul>\n<li><p> RootBeanDefintion  Bean AbstractAutowireCapableBeanFactory.createBeanInstance  Bean  BeanWrapper</p>\n<ol>\n<li><p>instantiateUsingFactoryMethod </p>\n</li>\n<li><p>autowireConstructor</p>\n</li>\n<li><p>instantiateBean</p>\n<p> getInstantiationStrategy().instantiate()  replace  lookup  </p>\n</li>\n</ol>\n</li>\n<li><p><strong></strong></p>\n<ol>\n<li> Bean </li>\n<li> setter   A  B B  C C  A A </li>\n</ol>\n<ul>\n<li><p>Spring Spring </p>\n</li>\n<li><p>  Spring  DefaultSingletonBeanRegistry </p>\n<ol>\n<li><p>singletonObjects</p>\n</li>\n<li><p>singletonFactories</p>\n</li>\n<li><p>earlySingletonObjects  singletonObjects  singletonFactory  singletonFactories  singletonFactory getEarlyBeanReference  earlySingletonObjects   earlySingletonObjects  earlySingletonObjects  getEarlyBeanReference  C  A A  B A </p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** Cache of singleton objects: bean name --&gt; bean instance */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; singletonObjects = <span class=\"keyword\">new</span> ConcurrentHashMap&lt;String, Object&gt;(<span class=\"number\">256</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** Cache of singleton factories: bean name --&gt; ObjectFactory */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class=\"keyword\">new</span> HashMap&lt;String, ObjectFactory&lt;?&gt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** Cache of early singleton objects: bean name --&gt; bean instance */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class=\"keyword\">new</span> HashMap&lt;String, Object&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>4. Bean  getBean </p>\n<ul>\n<li><ol>\n<li> InstantiationAwareBeanPostProcessor  @Autowire  AutowiredAnnotationBeanPostProcessor  InstantiationAwareBeanPostProcessor </li>\n<li> PropertyValues </li>\n<li> PropertyValues BeanWrapper BeanFactory.getBean </li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>5.</p>\n<ol>\n<li>Aware Spring  Bean Aware Bean </li>\n<li> BeanPostProcessorIOCAOP  Bean AOP</li>\n<li> init <ol>\n<li> InitializingBean</li>\n<li> init </li>\n</ol>\n</li>\n</ol>\n</li>\n<li><p>6. Bean FactoryBean  getObject  TypeConverter </p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Bean\"><a href=\"#Bean\" class=\"headerlink\" title=\"Bean\"></a>Bean</h3><ul>\n<li><img src=\"https://i.loli.net/2021/09/18/162nF7qvMfN8iKy.png\" alt=\"image20210918174436691\"></li>\n<li>:<ol>\n<li>SpringSpringbeanBean</li>\n<li>BeanBeanBean</li>\n<li>BeanBeanNameAwareSpringBeanIdsetBeanName()</li>\n<li>BeanBeanFactoryAwareSpringsetBeanFactory()BeanFactory</li>\n<li>BeanApplicationContextAwareSpringBeansetApplicationContext()bean</li>\n<li>BeanBeanPostProcessorSpringpostProcessBeforeInitialization()</li>\n<li>Bean InitializingBeanSpringafterPropertiesSet()beaninit-method</li>\n<li>Bean BeanPostProcessorSpringpostProcessAfterInitialization()</li>\n<li>Bean</li>\n<li>beanDisposableBeanSpringdestory()beandestory-method </li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ul>\n<li> commit()rollback()</li>\n<li><ol>\n<li>spring</li>\n<li>Transactional</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li>ABBA</li>\n<li>ABA</li>\n<li>(mysql)ABA</li>\n<li>readwrite</li>\n</ol>\n</li>\n<li><p></p>\n<ul>\n<li><ul>\n<li>ABBA</li>\n</ul>\n</li>\n<li><ul>\n<li>ABA</li>\n</ul>\n</li>\n<li><ul>\n<li>ABA</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>Propagation</p>\n<p>      // </p>\n<ul>\n<li><p>Propagation.REQUIRED:</p>\n</li>\n<li><p>SUPPORTS:</p>\n</li>\n<li><p>MANDATORY:</p>\n<p>  // </p>\n</li>\n<li><p>REQUIRES_NEW:</p>\n</li>\n<li><p>NOT_SUPPORTED:</p>\n</li>\n<li><p>NEVER:</p>\n</li>\n<li><p>NESTED:PROPAGATION_REQUIRED</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h2><h3 id=\"MyISAMInnoDB\"><a href=\"#MyISAMInnoDB\" class=\"headerlink\" title=\"MyISAMInnoDB\"></a>MyISAMInnoDB</h3><ol>\n<li>InnoDBMyISAM</li>\n<li>InnoDBMyISAM</li>\n<li>InnoDBMyISAM  InnoDB  MyISAM </li>\n<li>InnoDB  select count(*) from table MyISAM </li>\n<li>InnoDB MyISAM  MySQL  MyISAM  InnoDB </li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>:</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B-\"></a>B-</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ol>\n<li><p>MM&gt;2</p>\n</li>\n<li><p>2 M</p>\n</li>\n<li><p>M/2M</p>\n</li>\n<li><p>M/2-1M-12</p>\n</li>\n<li><p>=-1</p>\n</li>\n<li><p>K[1], K[2], , K[M-1]K[i] &lt; K[i+1]</p>\n</li>\n<li><p>P[1], P[2], , P[M]P[1]K[1]P[M]K[M-1]P[i](K[i-1], K[i])</p>\n</li>\n<li><p></p>\n<p><img src=\"https://i.loli.net/2021/09/18/GU86gywBaA7cIiQ.png\" alt=\"image-20210918191232742\"></p>\n</li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"B--1\"><a href=\"#B--1\" class=\"headerlink\" title=\"B+\"></a>B+</h3><ul>\n<li><p>B+B-</p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/mV5WLp2BusgXeqr.png\" alt=\"image-20210918191302660\"></p>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li>P[i][K[i], K[i+1])B-</li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>B</li>\n<li>B-M/2M</li>\n<li>B+B-B+</li>\n</ul>\n<h2 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"HTTP1-0HTTP1-1\"><a href=\"#HTTP1-0HTTP1-1\" class=\"headerlink\" title=\"HTTP1.0HTTP1.1\"></a>HTTP1.0HTTP1.1</h3><ul>\n<li>1.(Persistent Connection)<ul>\n<li>HTTP1.0keep-alive</li>\n<li>HTTP1.1TCPHTTPHTTP1.1keep-aliveHTTP1.0</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>HTTP1.0</li>\n<li>HTTP1.1headerbody100100body401body</li>\n</ul>\n</li>\n<li>3.HOST<ul>\n<li>HTTP1.0IPURLhostnameHTTP1.0hostMulti-homed Web ServersIP</li>\n<li>HTTP1.1hosthost400 Bad Request</li>\n</ul>\n</li>\n<li>4.<ul>\n<li>HTTP1.0headerIf-Modified-Since,Expires</li>\n<li>HTTP1.1Entity tagIf-Unmodified-Since, If-Match, If-None-Match</li>\n</ul>\n</li>\n<li>5.<ul>\n<li>HTTP1.124409Conflict410Gone</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"HTTP1-1HTTP2-0\"><a href=\"#HTTP1-1HTTP2-0\" class=\"headerlink\" title=\"HTTP1.1HTTP2.0\"></a>HTTP1.1HTTP2.0</h3><ul>\n<li>1.<ul>\n<li>HTTP2.0HTTP1.1</li>\n<li>HTTP1.1TCPTCP</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>HTTP1.1headerHTTP/gzipWebUserAgentCookie</li>\n<li>HTTP2.0HPACKheader</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>HTMLHTTP1.1HTML</li>\n<li>HTTP2.0server push</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"TIME-WAITCLOSE-WAIT\"><a href=\"#TIME-WAITCLOSE-WAIT\" class=\"headerlink\" title=\"TIME_WAITCLOSE_WAIT\"></a>TIME_WAITCLOSE_WAIT</h3><ul>\n<li>TIME_WAIT/etc/sysctl.confTIME_WAIT</li>\n<li>CLOSE_WAITack  ESTABLISHED</li>\n</ul>\n<h3 id=\"Https\"><a href=\"#Https\" class=\"headerlink\" title=\"Https\"></a>Https</h3><ul>\n<li>HTTPS</li>\n<li>:</li>\n<li>publickeyprivatekey</li>\n</ul>\n<h3 id=\"sessioncookie\"><a href=\"#sessioncookie\" class=\"headerlink\" title=\"sessioncookie\"></a>sessioncookie</h3><ul>\n<li>1.<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>cookie&lt;=4KB20Cookie</li>\n<li>sessionsessionsession</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>cookieASCIIUnicode</li>\n<li>sessionstringintegerlistmap</li>\n</ul>\n</li>\n<li>4.<ul>\n<li>cookiecookiecookie</li>\n<li>session</li>\n</ul>\n</li>\n<li>5.<ul>\n<li>cookiecookie</li>\n<li>sessionJSESSIONIDcookiecookie JSESSIONID-1sessionsession</li>\n</ul>\n</li>\n<li>6.<ul>\n<li>cookiecookie</li>\n<li>sessionsessionsession</li>\n</ul>\n</li>\n<li>7.<ul>\n<li>cookie<ul>\n<li>cookiecookiecookieWAPcookie</li>\n<li>sessionURLsessionURLURLsession</li>\n</ul>\n</li>\n<li>cookie<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>8.<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"JVM\"><a href=\"#JVM\" class=\"headerlink\" title=\"JVM\"></a>JVM</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>(cpu)</p>\n</blockquote>\n<ul>\n<li></li>\n<li>OutOfMemory</li>\n</ul>\n<h3 id=\"Java\"><a href=\"#Java\" class=\"headerlink\" title=\"Java\"></a>Java</h3><blockquote>\n<p>Java</p>\n<p></p>\n<p></p>\n</blockquote>\n<ul>\n<li><ol>\n<li> </li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li><ol>\n<li>StackOverflowError</li>\n<li>OutOfMemory</li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>,Java()nativecc++</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p></p>\n<p>1javareference</p>\n<p>2</p>\n<p>3</p>\n</blockquote>\n<ul>\n<li> JIT()</li>\n<li>OOM(OutOfMemoryError)</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>static</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><ul>\n<li>+1-10</li>\n<li>1</li>\n</ul>\n</li>\n<li><ul>\n<li>GCroot</li>\n<li>GCrootGCJavaGC,GC roots,GC rootsGC<ol>\n<li></li>\n<li></li>\n<li></li>\n<li>JNInative</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><ol>\n<li><p>-</p>\n<ul>\n<li><ol>\n<li>mutatorNEW()READ()WRITE()</li>\n<li>collectormutatorNEW</li>\n</ol>\n</li>\n<li><ul>\n<li>collectormutatormutatorheader</li>\n<li>collector(heap memory)-header</li>\n<li>TipsCollector(mutator)Stop-The-World</li>\n</ul>\n</li>\n<li>13MutatorCollectorOut of Memory</li>\n</ul>\n</li>\n</ol>\n</li>\n<li><p>2.</p>\n<ul>\n<li> </li>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p>3.-</p>\n<ul>\n<li><p> </p>\n<ul>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<blockquote>\n<p> &gt; </p>\n</blockquote>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li><ul>\n<li><ol>\n<li>Eden </li>\n<li>Survivor </li>\n<li>Tenured Gen </li>\n</ol>\n</li>\n<li><strong></strong>EdenSurvivorEdenSurvivorEdenSurvivorSurvivorEdenSurvivor</li>\n</ul>\n</li>\n<li><ul>\n<li><strong></strong></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>Serial/Serial Old</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n<li>SerialSerial Old</li>\n</ol>\n</li>\n<li></li>\n<li></li>\n</ul>\n</li>\n<li><p>ParNew</p>\n<ul>\n<li><p></p>\n<p>      Serial</p>\n</li>\n</ul>\n</li>\n<li><p>Parallel Scavenge</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>Parallel Old</p>\n<ul>\n<li><ol>\n<li>Parallel Scavenge</li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>CMSConcurrent Mark Sweep</p>\n<ul>\n<li><ol>\n<li></li>\n<li>-</li>\n</ol>\n</li>\n<li></li>\n<li><ol>\n<li>CPU</li>\n<li></li>\n<li>ConcurrentMode Failure</li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>G1</p>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<p></p>\n<ul>\n<li><ul>\n<li>SerialParNewParallel Scavenge</li>\n</ul>\n</li>\n<li><ul>\n<li>Serial OldParallel OldCMS</li>\n</ul>\n</li>\n<li><ul>\n<li>G1[]</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li> Class ,</li>\n<li>Tips loadClass()  Java </li>\n</ol>\n</li>\n<li><p></p>\n<ul>\n<li><p>class </p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/F1BQWefNcAYUEDy.png\" alt=\"image20210918170036312\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>staticstatic int i = 5  i 0 i 5)finalstatic finalJava</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li><p>static </p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/RLuVIpE7OWAx4Mz.png\" alt=\"image20210918170449021\"></p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>JVM</li>\n<li>JVMpgPersonClassLoaderklPersonClassJVM(Person.pg.kl)</li>\n<li>JVM<ul>\n<li>1.<ul>\n<li> Java $JAVA_HOMEjre/lib/rt.jarclassC++ClassLoader</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>JRElib/extjava.ext.dirsJARJavanull</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>JVMCLASSPATHJARClassLoadergetSystemClassLoader()JavaExtClassLoader</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>1.</p>\n<ul>\n<li>ClassClassClass</li>\n</ul>\n</li>\n<li><p>2.</p>\n<ul>\n<li><p></p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/tJyd5oZ3aBS1pm9.png\" alt=\"image20210918170625728\"></p>\n</li>\n<li><p></p>\n<ul>\n<li>1.ClassLoader</li>\n<li>2.APIjava.lang.IntegerJava APIInteger.class</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>3.</p>\n<ul>\n<li>ClassClassClassClassClassClassJVM</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"forNameloaderClass\"><a href=\"#forNameloaderClass\" class=\"headerlink\" title=\"forNameloaderClass\"></a>forNameloaderClass</h3><ul>\n<li>Class.forName()class</li>\n<li>Classloader.loaderClassclass</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>ObjectObject</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p>markword</p>\n<ul>\n<li><p>3286416</p>\n</li>\n<li><p></p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/5UlmYsTDcFwKuX9.png\" alt=\"image20210918171629651\"></p>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li>:doublelong</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>JVM</li>\n<li>HotSpot8</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"synchronized\"><a href=\"#synchronized\" class=\"headerlink\" title=\"synchronized\"></a>synchronized</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"JMMsynchronized\"><a href=\"#JMMsynchronized\" class=\"headerlink\" title=\"JMMsynchronized\"></a>JMMsynchronized</h3><ul>\n<li></li>\n<li></li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ol>\n<li>Mark WordID</li>\n<li>CASIDMard Word1</li>\n<li></li>\n<li>CASMark Word</li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"synchronized-\"><a href=\"#synchronized-\" class=\"headerlink\" title=\"synchronized \"></a>synchronized </h3><ul>\n<li>synchronizedvolatilesynchronizedvolatile</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br><span class=\"line\">39</span><br><span class=\"line\">40</span><br><span class=\"line\">41</span><br><span class=\"line\">42</span><br><span class=\"line\">43</span><br><span class=\"line\">44</span><br><span class=\"line\">45</span><br><span class=\"line\">46</span><br><span class=\"line\">47</span><br><span class=\"line\">48</span><br><span class=\"line\">49</span><br><span class=\"line\">50</span><br><span class=\"line\">51</span><br><span class=\"line\">52</span><br><span class=\"line\">53</span><br><span class=\"line\">54</span><br><span class=\"line\">55</span><br><span class=\"line\">56</span><br><span class=\"line\">57</span><br><span class=\"line\">58</span><br><span class=\"line\">59</span><br><span class=\"line\">60</span><br><span class=\"line\">61</span><br><span class=\"line\">62</span><br><span class=\"line\">63</span><br><span class=\"line\">64</span><br><span class=\"line\">65</span><br><span class=\"line\">66</span><br><span class=\"line\">67</span><br><span class=\"line\">68</span><br><span class=\"line\">69</span><br><span class=\"line\">70</span><br><span class=\"line\">71</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Zhangsan</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">// </span></span><br><span class=\"line\"><span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">Lisi</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">say</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">get</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        System.out.println(<span class=\"string\">\"\"</span>);</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">&#125;</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">ThreadDeadLock</span> <span class=\"keyword\">implements</span> <span class=\"title\">Runnable</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Zhangsan zs = <span class=\"keyword\">new</span> Zhangsan();    <span class=\"comment\">// static</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> Lisi ls = <span class=\"keyword\">new</span> Lisi();    <span class=\"comment\">// static</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">boolean</span> flag = <span class=\"keyword\">false</span>; <span class=\"comment\">// </span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">void</span> <span class=\"title\">run</span><span class=\"params\">()</span> </span>&#123; <span class=\"comment\">// run()</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (flag) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (zs) &#123;  <span class=\"comment\">// </span></span><br><span class=\"line\">                zs.say();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (ls) &#123;</span><br><span class=\"line\">                    zs.get();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125; <span class=\"keyword\">else</span> &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (ls) &#123;</span><br><span class=\"line\">                ls.say();</span><br><span class=\"line\">                <span class=\"keyword\">try</span> &#123;</span><br><span class=\"line\">                    Thread.sleep(<span class=\"number\">500</span>);</span><br><span class=\"line\">                &#125; <span class=\"keyword\">catch</span> (InterruptedException e) &#123;</span><br><span class=\"line\">                    e.printStackTrace();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">                <span class=\"keyword\">synchronized</span> (zs) &#123;</span><br><span class=\"line\">                    ls.get();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> <span class=\"keyword\">void</span> <span class=\"title\">main</span><span class=\"params\">(String args[])</span> </span>&#123;</span><br><span class=\"line\">        ThreadDeadLock t1 = <span class=\"keyword\">new</span> ThreadDeadLock();   <span class=\"comment\">// </span></span><br><span class=\"line\">        ThreadDeadLock t2 = <span class=\"keyword\">new</span> ThreadDeadLock();   <span class=\"comment\">// </span></span><br><span class=\"line\">        t1.flag = <span class=\"keyword\">true</span>;</span><br><span class=\"line\">        t2.flag = <span class=\"keyword\">false</span>;</span><br><span class=\"line\">        Thread thA = <span class=\"keyword\">new</span> Thread(t1);</span><br><span class=\"line\">        Thread thB = <span class=\"keyword\">new</span> Thread(t2);</span><br><span class=\"line\">        thA.start();</span><br><span class=\"line\">        thB.start();</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br><span class=\"line\"><span class=\"comment\">//   </span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p></p>\n<ul>\n<li></li>\n<li></li>\n<li></li>\n</ul>\n</li>\n</ul>\n<h2 id=\"JUC\"><a href=\"#JUC\" class=\"headerlink\" title=\"JUC\"></a>JUC</h2><h3 id=\"volatile\"><a href=\"#volatile\" class=\"headerlink\" title=\"volatile\"></a>volatile</h3><ul>\n<li><p>JMM</p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/F23tz5UOqCEwJbA.png\" alt=\"image20210918171727328\"></p>\n</li>\n<li><p></p>\n<ul>\n<li><ol>\n<li>volatilestore</li>\n<li>volatileload</li>\n</ol>\n</li>\n<li>volatile<ol>\n<li>volatile</li>\n<li></li>\n</ol>\n</li>\n<li>volatile<ol>\n<li>volatile</li>\n<li>volatile</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li> i++ --</li>\n<li><ol>\n<li>synchronized</li>\n<li>ReentrantLock</li>\n<li>AtomicInterger</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ul>\n<li>n = n + 1 n ++</li>\n<li>,  n &lt; m</li>\n</ul>\n</li>\n<li><p>synchronizedvolatile</p>\n<ul>\n<li>volatilesynchronized</li>\n<li>volatilevolatile</li>\n<li>synchronizedvolatile</li>\n</ul>\n</li>\n<li><p>double checkvolatile</p>\n  <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"keyword\">public</span> <span class=\"class\"><span class=\"keyword\">class</span> <span class=\"title\">SingletonClass</span> </span>&#123;</span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"keyword\">private</span> <span class=\"keyword\">static</span> SingletonClass instance = <span class=\"keyword\">null</span>;</span><br><span class=\"line\">    <span class=\"comment\">//private static volatile SingletonClass instance = null;</span></span><br><span class=\"line\"></span><br><span class=\"line\">    <span class=\"function\"><span class=\"keyword\">public</span> <span class=\"keyword\">static</span> SingletonClass <span class=\"title\">getInstance</span><span class=\"params\">()</span> </span>&#123;</span><br><span class=\"line\">        <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"keyword\">synchronized</span> (SingletonClass<span class=\"class\">.<span class=\"keyword\">class</span>) </span>&#123;</span><br><span class=\"line\">                <span class=\"keyword\">if</span> (instance == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">                    instance = <span class=\"keyword\">new</span> SingletonClass();</span><br><span class=\"line\">                &#125;</span><br><span class=\"line\">            &#125;</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> instance;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong>new,1.2.3.</strong>1-&gt;2-&gt;3231-&gt;3&gt;2ifvolatilevolatileifvolatilehappen-beforenewSingletonClass()</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"AtomicCAS\"><a href=\"#AtomicCAS\" class=\"headerlink\" title=\"AtomicCAS\"></a>AtomicCAS</h3><ul>\n<li><ol>\n<li>AtomicBoolean AtomicInteger AtomicLong  AtomicReference </li>\n<li>AtomicIntegerArray AtomicLongArray 3.AtomicStampedReferenceABA</li>\n</ol>\n</li>\n<li><ul>\n<li>boolean compareAndSet(expectedValue, updateValue) CASUnsafeCPU</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"LocksAQS\"><a href=\"#LocksAQS\" class=\"headerlink\" title=\"LocksAQS\"></a>LocksAQS</h3><ul>\n<li>ReentrantLock<ul>\n<li></li>\n<li>ReentrantLock/Synchorized </li>\n<li>lock</li>\n</ul>\n</li>\n<li>ReadWriteLock</li>\n</ul>\n<h3 id=\"Collections\"><a href=\"#Collections\" class=\"headerlink\" title=\"Collections\"></a>Collections</h3><ul>\n<li>Queue<ul>\n<li>ConcurrentLinkedQueue</li>\n<li>BlockingQueue</li>\n<li>Deque</li>\n</ul>\n</li>\n<li>CopyOnWriteArraySet</li>\n<li>CopyOnWriteArrayList</li>\n<li>ConcurrentSkipListSet</li>\n<li>ConcurrentMap<ul>\n<li>ConcurrentHashMap</li>\n<li>ConcurrentNavigableMap<ul>\n<li>ConcurrentSkipListMap</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Executor\"><a href=\"#Executor\" class=\"headerlink\" title=\"Executor\"></a>Executor</h3><ul>\n<li>Future<ul>\n<li>RunnableFuture<ul>\n<li>RunnableScheduledFuture</li>\n<li>FutureTask</li>\n</ul>\n</li>\n<li>ScheduledFuture</li>\n</ul>\n</li>\n<li>Callable</li>\n<li>Executor<ul>\n<li>ExecutorService<ul>\n<li>ScheduledExecutorService<ul>\n<li>ScheduledThreadPoolExecutor</li>\n</ul>\n</li>\n<li>ThreadPoolExecutor</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CompletionService<ul>\n<li>ExecutorCompletionService</li>\n</ul>\n</li>\n<li>RejectedExecutionHandler<ul>\n<li>ThreadPoolExecutor.DiscardPolicy</li>\n<li>ThreadPoolExecutor.DiscardOldestPolicy</li>\n<li>ThreadPoolExecutor.CallerRunsPolicy</li>\n<li>ThreadPoolExecutor.AbortPolicy</li>\n</ul>\n</li>\n<li>TimeUnit</li>\n</ul>\n<h3 id=\"Tools\"><a href=\"#Tools\" class=\"headerlink\" title=\"Tools\"></a>Tools</h3><ul>\n<li>CountDownLatch</li>\n<li>CyclicBarrier</li>\n<li>Semaphore</li>\n<li>Executors</li>\n<li>Exchanger</li>\n</ul>\n<h2 id=\"TODO-\"><a href=\"#TODO-\" class=\"headerlink\" title=\"TODO \"></a>TODO </h2><h3 id=\"Map\"><a href=\"#Map\" class=\"headerlink\" title=\"Map\"></a>Map</h3><ul>\n<li><p>HashMap</p>\n<blockquote>\n<p>// EnterykeyvaluenextNode // key-valuehash(key)hashindexFor(hash,length)key-value // hash&amp;0x7FFFFFFF(16)lengthkey-valueHashMap // hashNodenextnull1.8Node1.87 // 6Node</p>\n</blockquote>\n<ul>\n<li>+(1.8++)</li>\n<li>AbstractMapkeynullvaluenull16</li>\n<li>jdk1.71.8 1) 1.7hash+1.8hash++&gt;7 2) hashcode1.7451.811 3)1.71.8+</li>\n<li>2 2n1hash2n1hashreturnh&amp;(length-1)00001100111011entry</li>\n</ul>\n</li>\n<li><p>Hashtable</p>\n<blockquote>\n<p>// HashTablesynchronizedHashTable // HashTableHashTable // 1put2putget</p>\n</blockquote>\n<ul>\n<li>HashtableDictionarykeyvaluenull11</li>\n</ul>\n</li>\n<li><p>ConcurrentHashMap</p>\n<blockquote>\n<p>// ConcurrentHashMapAbstractMapConcurrentHashMap HashEntry  Segment &gt; // HashEntry  / ;Segment  &gt; //  ConcurrentHashMap  Segment  HashEntry  &gt; // SegmentHashEntry,HashEntrySegment &gt; // putgetsize()containsValue() &gt; // ConcurrentHashMapfinalfinal &gt; // finalfinal</p>\n</blockquote>\n<ul>\n<li>ConcurrentHashMapAbstractMap</li>\n</ul>\n</li>\n<li><p>LinkedHashMap</p>\n<ul>\n<li>LinkedHashMapHashMap+/</li>\n<li>nullnull</li>\n</ul>\n</li>\n<li><p>TreeMap</p>\n<ul>\n<li>TreeMapSortedMapnullnull</li>\n<li>keycomparatorvalue</li>\n<li>Red-Black tree containsKeygetput  remove  log(n)</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"List\"><a href=\"#List\" class=\"headerlink\" title=\"List\"></a>List</h3><ul>\n<li>ArrayList<ul>\n<li>ArrayList()</li>\n</ul>\n</li>\n<li>Vector<ul>\n<li>Vector(synchronized)</li>\n</ul>\n</li>\n<li>LinkedList<ul>\n<li>LinkedList()</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Set\"><a href=\"#Set\" class=\"headerlink\" title=\"Set\"></a>Set</h3><ul>\n<li>HashSet<ul>\n<li>HashSetHash</li>\n</ul>\n</li>\n<li>LinkedHashSet<ul>\n<li>LinkedHashSet</li>\n<li>HashSetLinkedHashMap </li>\n</ul>\n</li>\n<li>TreeSet<ul>\n<li>TreeSet</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><blockquote>\n<p>TreeMapTreeSetjava8HashMap</p>\n</blockquote>\n<ul>\n<li><ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li>34<ol>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h2 id=\"spring\"><a href=\"#spring\" class=\"headerlink\" title=\"spring\"></a>spring</h2><h3 id=\"IoCDI\"><a href=\"#IoCDI\" class=\"headerlink\" title=\"IoCDI\"></a>IoCDI</h3><ul>\n<li>IoC </li>\n<li>DI springIoCDI</li>\n<li><ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"AOP\"><a href=\"#AOP\" class=\"headerlink\" title=\"AOP\"></a>AOP</h3><h3 id=\"spring\"><a href=\"#spring\" class=\"headerlink\" title=\"spring\"></a>spring</h3><ul>\n<li><p>xmlbean</p>\n</li>\n<li><p>bean  -&gt;  -&gt;  -&gt;  -&gt; </p>\n<ul>\n<li><p>1.BeanNamenameMapBeanDefinitionbean name</p>\n<ul>\n<li> Map beanName  keyBeanFactory.getBean  name<ol>\n<li>bean name BeanDefinition</li>\n<li>alias namealias name  bean name  SimpleAliasRegistry  beanName</li>\n<li>factorybean name,  &amp;  BeanDefinition  &amp; </li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>2. BeanDefinition Bean </p>\n<ul>\n<li> BeanDefinition  GenericBeanDefinition, Bean  RootBeanDefinition,GenericBeanDefinition     parentName  RootBeanDefinition.overrideFrom  </li>\n</ul>\n</li>\n<li><p>3. Bean + </p>\n<ul>\n<li><p> RootBeanDefintion  Bean AbstractAutowireCapableBeanFactory.createBeanInstance  Bean  BeanWrapper</p>\n<ol>\n<li><p>instantiateUsingFactoryMethod </p>\n</li>\n<li><p>autowireConstructor</p>\n</li>\n<li><p>instantiateBean</p>\n<p> getInstantiationStrategy().instantiate()  replace  lookup  </p>\n</li>\n</ol>\n</li>\n<li><p><strong></strong></p>\n<ol>\n<li> Bean </li>\n<li> setter   A  B B  C C  A A </li>\n</ol>\n<ul>\n<li><p>Spring Spring </p>\n</li>\n<li><p>  Spring  DefaultSingletonBeanRegistry </p>\n<ol>\n<li><p>singletonObjects</p>\n</li>\n<li><p>singletonFactories</p>\n</li>\n<li><p>earlySingletonObjects  singletonObjects  singletonFactory  singletonFactories  singletonFactory getEarlyBeanReference  earlySingletonObjects   earlySingletonObjects  earlySingletonObjects  getEarlyBeanReference  C  A A  B A </p>\n <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\">/** Cache of singleton objects: bean name --&gt; bean instance */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; singletonObjects = <span class=\"keyword\">new</span> ConcurrentHashMap&lt;String, Object&gt;(<span class=\"number\">256</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** Cache of singleton factories: bean name --&gt; ObjectFactory */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = <span class=\"keyword\">new</span> HashMap&lt;String, ObjectFactory&lt;?&gt;&gt;(<span class=\"number\">16</span>);</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"comment\">/** Cache of early singleton objects: bean name --&gt; bean instance */</span></span><br><span class=\"line\"><span class=\"keyword\">private</span> <span class=\"keyword\">final</span> Map&lt;String, Object&gt; earlySingletonObjects = <span class=\"keyword\">new</span> HashMap&lt;String, Object&gt;(<span class=\"number\">16</span>);</span><br></pre></td></tr></table></figure>\n</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>4. Bean  getBean </p>\n<ul>\n<li><ol>\n<li> InstantiationAwareBeanPostProcessor  @Autowire  AutowiredAnnotationBeanPostProcessor  InstantiationAwareBeanPostProcessor </li>\n<li> PropertyValues </li>\n<li> PropertyValues BeanWrapper BeanFactory.getBean </li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p>5.</p>\n<ol>\n<li>Aware Spring  Bean Aware Bean </li>\n<li> BeanPostProcessorIOCAOP  Bean AOP</li>\n<li> init <ol>\n<li> InitializingBean</li>\n<li> init </li>\n</ol>\n</li>\n</ol>\n</li>\n<li><p>6. Bean FactoryBean  getObject  TypeConverter </p>\n</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"Bean\"><a href=\"#Bean\" class=\"headerlink\" title=\"Bean\"></a>Bean</h3><ul>\n<li><img src=\"https://i.loli.net/2021/09/18/162nF7qvMfN8iKy.png\" alt=\"image20210918174436691\"></li>\n<li>:<ol>\n<li>SpringSpringbeanBean</li>\n<li>BeanBeanBean</li>\n<li>BeanBeanNameAwareSpringBeanIdsetBeanName()</li>\n<li>BeanBeanFactoryAwareSpringsetBeanFactory()BeanFactory</li>\n<li>BeanApplicationContextAwareSpringBeansetApplicationContext()bean</li>\n<li>BeanBeanPostProcessorSpringpostProcessBeforeInitialization()</li>\n<li>Bean InitializingBeanSpringafterPropertiesSet()beaninit-method</li>\n<li>Bean BeanPostProcessorSpringpostProcessAfterInitialization()</li>\n<li>Bean</li>\n<li>beanDisposableBeanSpringdestory()beandestory-method </li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li><p></p>\n<ul>\n<li> commit()rollback()</li>\n<li><ol>\n<li>spring</li>\n<li>Transactional</li>\n</ol>\n</li>\n</ul>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li>ABBA</li>\n<li>ABA</li>\n<li>(mysql)ABA</li>\n<li>readwrite</li>\n</ol>\n</li>\n<li><p></p>\n<ul>\n<li><ul>\n<li>ABBA</li>\n</ul>\n</li>\n<li><ul>\n<li>ABA</li>\n</ul>\n</li>\n<li><ul>\n<li>ABA</li>\n</ul>\n</li>\n</ul>\n</li>\n<li><p>Propagation</p>\n<p>      // </p>\n<ul>\n<li><p>Propagation.REQUIRED:</p>\n</li>\n<li><p>SUPPORTS:</p>\n</li>\n<li><p>MANDATORY:</p>\n<p>  // </p>\n</li>\n<li><p>REQUIRES_NEW:</p>\n</li>\n<li><p>NOT_SUPPORTED:</p>\n</li>\n<li><p>NEVER:</p>\n</li>\n<li><p>NESTED:PROPAGATION_REQUIRED</p>\n</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"mysql\"><a href=\"#mysql\" class=\"headerlink\" title=\"mysql\"></a>mysql</h2><h3 id=\"MyISAMInnoDB\"><a href=\"#MyISAMInnoDB\" class=\"headerlink\" title=\"MyISAMInnoDB\"></a>MyISAMInnoDB</h3><ol>\n<li>InnoDBMyISAM</li>\n<li>InnoDBMyISAM</li>\n<li>InnoDBMyISAM  InnoDB  MyISAM </li>\n<li>InnoDB  select count(*) from table MyISAM </li>\n<li>InnoDB MyISAM  MySQL  MyISAM  InnoDB </li>\n</ol>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><p>:</p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<h3 id=\"B-\"><a href=\"#B-\" class=\"headerlink\" title=\"B-\"></a>B-</h3><ul>\n<li><p></p>\n</li>\n<li><p></p>\n<ol>\n<li><p>MM&gt;2</p>\n</li>\n<li><p>2 M</p>\n</li>\n<li><p>M/2M</p>\n</li>\n<li><p>M/2-1M-12</p>\n</li>\n<li><p>=-1</p>\n</li>\n<li><p>K[1], K[2], , K[M-1]K[i] &lt; K[i+1]</p>\n</li>\n<li><p>P[1], P[2], , P[M]P[1]K[1]P[M]K[M-1]P[i](K[i-1], K[i])</p>\n</li>\n<li><p></p>\n<p><img src=\"https://i.loli.net/2021/09/18/GU86gywBaA7cIiQ.png\" alt=\"image-20210918191232742\"></p>\n</li>\n</ol>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"B--1\"><a href=\"#B--1\" class=\"headerlink\" title=\"B+\"></a>B+</h3><ul>\n<li><p>B+B-</p>\n<p>  <img src=\"https://i.loli.net/2021/09/18/mV5WLp2BusgXeqr.png\" alt=\"image-20210918191302660\"></p>\n</li>\n<li><p></p>\n<ol>\n<li></li>\n<li>P[i][K[i], K[i+1])B-</li>\n<li></li>\n<li></li>\n</ol>\n</li>\n</ul>\n<h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><ul>\n<li>B</li>\n<li>B-M/2M</li>\n<li>B+B-B+</li>\n</ul>\n<h2 id=\"HTTP\"><a href=\"#HTTP\" class=\"headerlink\" title=\"HTTP\"></a>HTTP</h2><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h3><h3 id=\"HTTP1-0HTTP1-1\"><a href=\"#HTTP1-0HTTP1-1\" class=\"headerlink\" title=\"HTTP1.0HTTP1.1\"></a>HTTP1.0HTTP1.1</h3><ul>\n<li>1.(Persistent Connection)<ul>\n<li>HTTP1.0keep-alive</li>\n<li>HTTP1.1TCPHTTPHTTP1.1keep-aliveHTTP1.0</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>HTTP1.0</li>\n<li>HTTP1.1headerbody100100body401body</li>\n</ul>\n</li>\n<li>3.HOST<ul>\n<li>HTTP1.0IPURLhostnameHTTP1.0hostMulti-homed Web ServersIP</li>\n<li>HTTP1.1hosthost400 Bad Request</li>\n</ul>\n</li>\n<li>4.<ul>\n<li>HTTP1.0headerIf-Modified-Since,Expires</li>\n<li>HTTP1.1Entity tagIf-Unmodified-Since, If-Match, If-None-Match</li>\n</ul>\n</li>\n<li>5.<ul>\n<li>HTTP1.124409Conflict410Gone</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"HTTP1-1HTTP2-0\"><a href=\"#HTTP1-1HTTP2-0\" class=\"headerlink\" title=\"HTTP1.1HTTP2.0\"></a>HTTP1.1HTTP2.0</h3><ul>\n<li>1.<ul>\n<li>HTTP2.0HTTP1.1</li>\n<li>HTTP1.1TCPTCP</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>HTTP1.1headerHTTP/gzipWebUserAgentCookie</li>\n<li>HTTP2.0HPACKheader</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>HTMLHTTP1.1HTML</li>\n<li>HTTP2.0server push</li>\n</ul>\n</li>\n</ul>\n<h3 id=\"TIME-WAITCLOSE-WAIT\"><a href=\"#TIME-WAITCLOSE-WAIT\" class=\"headerlink\" title=\"TIME_WAITCLOSE_WAIT\"></a>TIME_WAITCLOSE_WAIT</h3><ul>\n<li>TIME_WAIT/etc/sysctl.confTIME_WAIT</li>\n<li>CLOSE_WAITack  ESTABLISHED</li>\n</ul>\n<h3 id=\"Https\"><a href=\"#Https\" class=\"headerlink\" title=\"Https\"></a>Https</h3><ul>\n<li>HTTPS</li>\n<li>:</li>\n<li>publickeyprivatekey</li>\n</ul>\n<h3 id=\"sessioncookie\"><a href=\"#sessioncookie\" class=\"headerlink\" title=\"sessioncookie\"></a>sessioncookie</h3><ul>\n<li>1.<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n<li>2.<ul>\n<li>cookie&lt;=4KB20Cookie</li>\n<li>sessionsessionsession</li>\n</ul>\n</li>\n<li>3.<ul>\n<li>cookieASCIIUnicode</li>\n<li>sessionstringintegerlistmap</li>\n</ul>\n</li>\n<li>4.<ul>\n<li>cookiecookiecookie</li>\n<li>session</li>\n</ul>\n</li>\n<li>5.<ul>\n<li>cookiecookie</li>\n<li>sessionJSESSIONIDcookiecookie JSESSIONID-1sessionsession</li>\n</ul>\n</li>\n<li>6.<ul>\n<li>cookiecookie</li>\n<li>sessionsessionsession</li>\n</ul>\n</li>\n<li>7.<ul>\n<li>cookie<ul>\n<li>cookiecookiecookieWAPcookie</li>\n<li>sessionURLsessionURLURLsession</li>\n</ul>\n</li>\n<li>cookie<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>8.<ul>\n<li>cookie</li>\n<li>session</li>\n</ul>\n</li>\n</ul>\n<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2>"},{"title":"","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"abbrlink":"6fff","date":"2021-11-09T16:00:00.000Z","top":null,"subtitle":null,"_content":"\n## \n\n### 1. Java native\n\n   JavanativeOpenJDK`_`\n\n   eg`ByteBuffer.allocateDirect(1024)`Unsafe.class\n\n   ```java\nprivate native long allocateMemory0(long var1);\n   ```\n\n    Unsafe::allocateMemory0(long var1)OpenJDKUnsafe_AllocateMemory0\n\n   ```c\nUNSAFE_ENTRY(jlong, Unsafe_AllocateMemory0(JNIEnv *env, jobject unsafe, jlong size)) {\n  size_t sz = (size_t)size;\n\n  assert(is_aligned(sz, HeapWordSize), \"sz not aligned\");\n\n  void* x = os::malloc(sz, mtOther);\n\n  return addr_to_java(x);\n} UNSAFE_END\n   ```\n\n### 2. \n\n   `Unsafe_AllocateMemory0``os::malloc(sz, mtOther)``malloc`Linux`man $ `\n\n   ```\n  ~  man malloc\n   ```\n\n   ```\nMALLOC(3)                BSD Library Functions Manual                MALLOC(3)\n\nNAME\n     calloc, free, malloc, realloc, reallocf, valloc, aligned_alloc -- memory allocation\n\nSYNOPSIS\n     #include <stdlib.h>\n\n     void *\n     calloc(size_t count, size_t size);\n\n     void\n     free(void *ptr);\n\n     void *\n     malloc(size_t size);\n        \n        ...\n\nDESCRIPTION\n     The malloc(), calloc(), valloc(), realloc(), and reallocf() functions\n     allocate memory.  The allocated memory is aligned such that it can be\n     used for any data type, including AltiVec- and SSE-related types.  The\n     aligned_alloc() function allocates memory with the requested alignment.\n     The free() function frees allocations that were created via the preceding\n     allocation functions.\n\n     The malloc() function allocates size bytes of memory and returns a\n     pointer to the allocated memory.\n     ......\n   ```\n### 3. TODO \n\n   ","source":"_posts/source-code.md","raw":"---\ntitle: \nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntags:\n  - source code\ncategories:\n  - work\nabbrlink: 6fff\ndate: 2021-11-10 00:00:00\ntop:\nsubtitle:\n---\n\n## \n\n### 1. Java native\n\n   JavanativeOpenJDK`_`\n\n   eg`ByteBuffer.allocateDirect(1024)`Unsafe.class\n\n   ```java\nprivate native long allocateMemory0(long var1);\n   ```\n\n    Unsafe::allocateMemory0(long var1)OpenJDKUnsafe_AllocateMemory0\n\n   ```c\nUNSAFE_ENTRY(jlong, Unsafe_AllocateMemory0(JNIEnv *env, jobject unsafe, jlong size)) {\n  size_t sz = (size_t)size;\n\n  assert(is_aligned(sz, HeapWordSize), \"sz not aligned\");\n\n  void* x = os::malloc(sz, mtOther);\n\n  return addr_to_java(x);\n} UNSAFE_END\n   ```\n\n### 2. \n\n   `Unsafe_AllocateMemory0``os::malloc(sz, mtOther)``malloc`Linux`man $ `\n\n   ```\n  ~  man malloc\n   ```\n\n   ```\nMALLOC(3)                BSD Library Functions Manual                MALLOC(3)\n\nNAME\n     calloc, free, malloc, realloc, reallocf, valloc, aligned_alloc -- memory allocation\n\nSYNOPSIS\n     #include <stdlib.h>\n\n     void *\n     calloc(size_t count, size_t size);\n\n     void\n     free(void *ptr);\n\n     void *\n     malloc(size_t size);\n        \n        ...\n\nDESCRIPTION\n     The malloc(), calloc(), valloc(), realloc(), and reallocf() functions\n     allocate memory.  The allocated memory is aligned such that it can be\n     used for any data type, including AltiVec- and SSE-related types.  The\n     aligned_alloc() function allocates memory with the requested alignment.\n     The free() function frees allocations that were created via the preceding\n     allocation functions.\n\n     The malloc() function allocates size bytes of memory and returns a\n     pointer to the allocated memory.\n     ......\n   ```\n### 3. TODO \n\n   ","slug":"source-code","published":1,"updated":"2022-04-23T08:52:41.839Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmweez001nkh6z0ci5gmnx","content":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-Java-native\"><a href=\"#1-Java-native\" class=\"headerlink\" title=\"1. Java native\"></a>1. Java native</h3><p>   JavanativeOpenJDK<code>_</code></p>\n<p>   eg<code>ByteBuffer.allocateDirect(1024)</code>Unsafe.class</p>\n   <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">long</span> <span class=\"title\">allocateMemory0</span><span class=\"params\">(<span class=\"keyword\">long</span> var1)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>    Unsafe::allocateMemory0(long var1)OpenJDKUnsafe_AllocateMemory0</p>\n   <figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UNSAFE_ENTRY(jlong, Unsafe_AllocateMemory0(JNIEnv *env, jobject unsafe, jlong <span class=\"built_in\">size</span>)) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">size_t</span> sz = (<span class=\"keyword\">size_t</span>)<span class=\"built_in\">size</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  assert(is_aligned(sz, HeapWordSize), <span class=\"string\">\"sz not aligned\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">void</span>* x = os::<span class=\"built_in\">malloc</span>(sz, mtOther);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> addr_to_java(x);</span><br><span class=\"line\">&#125; UNSAFE_END</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p>   <code>Unsafe_AllocateMemory0</code><code>os::malloc(sz, mtOther)</code><code>malloc</code>Linux<code>man $</code></p>\n   <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ~  man <span class=\"built_in\">malloc</span></span><br></pre></td></tr></table></figure>\n\n   <figure class=\"highlight irpf90\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MALLOC(<span class=\"number\">3</span>)                BSD Library Functions Manual                MALLOC(<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">NAME</span></span><br><span class=\"line\">     calloc, <span class=\"keyword\">free</span>, malloc, realloc, reallocf, valloc, aligned_alloc -- memory allocation</span><br><span class=\"line\"></span><br><span class=\"line\">SYNOPSIS</span><br><span class=\"line\">     #<span class=\"keyword\">include</span> &lt;stdlib.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">     void *</span><br><span class=\"line\">     calloc(size_t <span class=\"built_in\">count</span>, size_t <span class=\"built_in\">size</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     void</span><br><span class=\"line\">     <span class=\"keyword\">free</span>(void *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">     void *</span><br><span class=\"line\">     malloc(size_t <span class=\"built_in\">size</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        ...</span><br><span class=\"line\"></span><br><span class=\"line\">DESCRIPTION</span><br><span class=\"line\">     The malloc(), calloc(), valloc(), realloc(), and reallocf() functions</span><br><span class=\"line\">     <span class=\"built_in\">allocate</span> memory.  The <span class=\"built_in\">allocated</span> memory is aligned such that it can be</span><br><span class=\"line\">     used for <span class=\"built_in\">any</span> <span class=\"keyword\">data</span> <span class=\"keyword\">type</span>, including AltiVec- and SSE-related types.  The</span><br><span class=\"line\">     aligned_alloc() <span class=\"function\"><span class=\"keyword\">function</span></span> allocates memory with the requested alignment.</span><br><span class=\"line\">     The <span class=\"keyword\">free</span>() <span class=\"function\"><span class=\"keyword\">function</span></span> frees allocations that were created via the preceding</span><br><span class=\"line\">     allocation functions.</span><br><span class=\"line\"></span><br><span class=\"line\">     The malloc() <span class=\"function\"><span class=\"keyword\">function</span></span> allocates <span class=\"built_in\">size</span> bytes of memory and returns a</span><br><span class=\"line\">     <span class=\"keyword\">pointer</span> to the <span class=\"built_in\">allocated</span> memory.</span><br><span class=\"line\">     ......</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-TODO-\"><a href=\"#3-TODO-\" class=\"headerlink\" title=\"3. TODO \"></a>3. TODO </h3>","site":{"data":{}},"excerpt":"","more":"<h2 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h2><h3 id=\"1-Java-native\"><a href=\"#1-Java-native\" class=\"headerlink\" title=\"1. Java native\"></a>1. Java native</h3><p>   JavanativeOpenJDK<code>_</code></p>\n<p>   eg<code>ByteBuffer.allocateDirect(1024)</code>Unsafe.class</p>\n   <figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">private</span> <span class=\"keyword\">native</span> <span class=\"keyword\">long</span> <span class=\"title\">allocateMemory0</span><span class=\"params\">(<span class=\"keyword\">long</span> var1)</span></span>;</span><br></pre></td></tr></table></figure>\n\n<p>    Unsafe::allocateMemory0(long var1)OpenJDKUnsafe_AllocateMemory0</p>\n   <figure class=\"highlight c\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">UNSAFE_ENTRY(jlong, Unsafe_AllocateMemory0(JNIEnv *env, jobject unsafe, jlong <span class=\"built_in\">size</span>)) &#123;</span><br><span class=\"line\">  <span class=\"keyword\">size_t</span> sz = (<span class=\"keyword\">size_t</span>)<span class=\"built_in\">size</span>;</span><br><span class=\"line\"></span><br><span class=\"line\">  assert(is_aligned(sz, HeapWordSize), <span class=\"string\">\"sz not aligned\"</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">void</span>* x = os::<span class=\"built_in\">malloc</span>(sz, mtOther);</span><br><span class=\"line\"></span><br><span class=\"line\">  <span class=\"keyword\">return</span> addr_to_java(x);</span><br><span class=\"line\">&#125; UNSAFE_END</span><br></pre></td></tr></table></figure>\n\n<h3 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h3><p>   <code>Unsafe_AllocateMemory0</code><code>os::malloc(sz, mtOther)</code><code>malloc</code>Linux<code>man $</code></p>\n   <figure class=\"highlight cpp\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">  ~  man <span class=\"built_in\">malloc</span></span><br></pre></td></tr></table></figure>\n\n   <figure class=\"highlight irpf90\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">MALLOC(<span class=\"number\">3</span>)                BSD Library Functions Manual                MALLOC(<span class=\"number\">3</span>)</span><br><span class=\"line\"></span><br><span class=\"line\"><span class=\"keyword\">NAME</span></span><br><span class=\"line\">     calloc, <span class=\"keyword\">free</span>, malloc, realloc, reallocf, valloc, aligned_alloc -- memory allocation</span><br><span class=\"line\"></span><br><span class=\"line\">SYNOPSIS</span><br><span class=\"line\">     #<span class=\"keyword\">include</span> &lt;stdlib.h&gt;</span><br><span class=\"line\"></span><br><span class=\"line\">     void *</span><br><span class=\"line\">     calloc(size_t <span class=\"built_in\">count</span>, size_t <span class=\"built_in\">size</span>);</span><br><span class=\"line\"></span><br><span class=\"line\">     void</span><br><span class=\"line\">     <span class=\"keyword\">free</span>(void *ptr);</span><br><span class=\"line\"></span><br><span class=\"line\">     void *</span><br><span class=\"line\">     malloc(size_t <span class=\"built_in\">size</span>);</span><br><span class=\"line\">        </span><br><span class=\"line\">        ...</span><br><span class=\"line\"></span><br><span class=\"line\">DESCRIPTION</span><br><span class=\"line\">     The malloc(), calloc(), valloc(), realloc(), and reallocf() functions</span><br><span class=\"line\">     <span class=\"built_in\">allocate</span> memory.  The <span class=\"built_in\">allocated</span> memory is aligned such that it can be</span><br><span class=\"line\">     used for <span class=\"built_in\">any</span> <span class=\"keyword\">data</span> <span class=\"keyword\">type</span>, including AltiVec- and SSE-related types.  The</span><br><span class=\"line\">     aligned_alloc() <span class=\"function\"><span class=\"keyword\">function</span></span> allocates memory with the requested alignment.</span><br><span class=\"line\">     The <span class=\"keyword\">free</span>() <span class=\"function\"><span class=\"keyword\">function</span></span> frees allocations that were created via the preceding</span><br><span class=\"line\">     allocation functions.</span><br><span class=\"line\"></span><br><span class=\"line\">     The malloc() <span class=\"function\"><span class=\"keyword\">function</span></span> allocates <span class=\"built_in\">size</span> bytes of memory and returns a</span><br><span class=\"line\">     <span class=\"keyword\">pointer</span> to the <span class=\"built_in\">allocated</span> memory.</span><br><span class=\"line\">     ......</span><br></pre></td></tr></table></figure>\n<h3 id=\"3-TODO-\"><a href=\"#3-TODO-\" class=\"headerlink\" title=\"3. TODO \"></a>3. TODO </h3>"},{"title":"Redis","header-img":"/img/header_img/post-bg-desk.jpg","catalog":true,"top":null,"abbrlink":"a10a","date":"2021-04-14T16:00:00.000Z","subtitle":null,"_content":"\n\n\n### . Redis\n\n\t\tRedisBSD******************stringslistshashessetssorted sets**bitmapshyperloglogsgeospatial indexesstreams******luaLRU******redis sentinel****redis cluster******/******\n\n\n\n### . Redis\n\n> **API2**\n\n\t\t**HTTP**\n\n\t\tAPI **cache-control**:max-age=600 1010API\n\n\t\t****\n\n\t\tAPISQL2SQLAPIJDK**HashMap**ConcurrentHashMap**Guava Cache**Spring Cache10102SQL\n\n\t\tAPIAPI...\n\n\t\t**Redis**\n\n\t\tAPI Redis Memcached\n\n#### Redis\n\n\t\tSession12306\n\n### . Redis  Memcached \n\n- **** \n\n1. \n2. \n3. \n\n- **** \n\n1. **Redis **Redis  k/v  listsetzsethash Memcached  k/v \n2. **Redis  Memecache **\n3. **Redis ** \n4. **Redis Memcached **\n5. **Memcached  Redis  cluster **\n6. **Memcached  IO Redis  IO ** Redis 6.0  IO \n7. **Redis LuaMemcachedRedis**\n\n\n\n### . \n\n#### 1. \n\n#### 2. \n\n\tLinuxredis.confWindowsredis.windows.conf\n\n- \n\n    ```\n    appendonly yes\n    ```\n\n- portRedis6379\n- bind127.0.0.1\n\n- timeout00\n\n- dbfilenamedump.rdb\n\n- dir\n\n- rdbcompressionyes,RedisLZFCPU\n\n- saveKey-Valuesavesave<seconds><changes>:secondschanges900151\n\n    ```\n    127.0.0.1:6379> config set save \"900 1\"\n    OK\n    127.0.0.1:6379> config get save\n    1) \"save\"\n    2) \"900 1\"\n    ```\n\n- requirepassRedisRedisAUTH <password>\n\n- slaveofslavemasterIPRedismasterslavemaster\n\n    ```\n    slaveof<masterip><masterport>\n    ```\n\n- masterauthmasterslavemaster:\n\n    ```\n    masterauth<master-password>\n    ```\n\n- databases1616id0-150SELECT <dbid>id\n\n#### 3. Redis\n\n```\n#redis-cli -h host -p port -a password\n```\n\n\n\n```\nroot@0912b31c4171# redis-cli\n```\n\n\n\n### . Redis\n\n#### 1.  \n\n\t\t IO IO 110000 (SET) 81000 /(GET) `redis-benchmark -n 100000 -q`  10 \n\n```\nroot@0912b31c4171:/data# redis-benchmark -n 100000 -q\nPING_INLINE: 31172.07 requests per second\nPING_BULK: 31615.55 requests per second\nSET: 30432.14 requests per second\nGET: 31289.11 requests per second\nINCR: 30441.40 requests per second\nLPUSH: 29550.83 requests per second\nRPUSH: 30184.12 requests per second\n```\n\n#### 2.  \n\n\t\tstringlisthashsetsortedsetbitmapshyperloglogsgeospatial indexesstream**string()****list()****hash()****set()**  **zset()** 5  Redis \n\n#### 3. \n\n\t\tRedis  `file event handler` Redis  IO  socket socket \n\n 4 \n\n-  socket\n\n- IO \n\n- \n\n- \n\n    \t\t socket  IO  socket socket \n\n    *** I/O ***\n\n     ***I/O  I/O  I/O ***\n\n#### 4.  \n\n\t\tRDBAOF\n\n\t\t**RDB**(Redis DataBase) Redis ****2 *100*  Redis  `.rdb` \n\n\t\t**AOF** (Append Only File - ) ****  ****  AOF  Redis  **** Redis  **** **** Redis \n\n\t\t**RDB**\n\n- RDB\n\n- RDBredisfork()IO\n\n- RDB  AOF \n\n\t\t**RDB**\n\n- RDB\n\n\t\t**AOF**\n\n- AOFAOF1fsync12AOF\n\n- AOF\n\n- AOFflushallrewriteAOFflushallAOF\n\n\t\t**AOF**\n\n- AOFRDB\n\n- AOFQPSRDBQPSAOFfsyncfsync\n\n- AOFbugAOF\n\n#### 5. \n\n\t\t**/ **  Web  ****/ redis `list`  `lpush`  `rpop`  **** \n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdit62wmj30yg0ccgmp.jpg)\n\n\t\t**Redis**`Publisher`  `Consumer` **** *(channel)*\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gopdjtvehij30yg0cbmy0.jpg)\n\n `Publisher`  `channel`  `channel`  `Consumer`  ****  ****  ****  **** \n\n**Redis**  ****  **Pattern Subscribe** **** \n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdkll7gtj30yg0cb0ul.jpg)\n\n****  **`Consumer` **\n\n`Publisher`  `wmyskxz.chat`  `channel`  `Consumer 1`  `Consumer 2`  `channel`  `wmyskxz.*`  **Redis**  `wmyskxz.*`  `Consumer 3`  `wmyskxz.log`  `Consumer 4`  `Consumer 5`\n\n `wmyskxz.chat` `Consumer 3`   \n\n##### **\n\n **Redis** **PubSub** \n\n```bash\n# \nSUBSCRIBE channel [channel ....]   # \nPSUBSCRIBE pattern [pattern ....]  # \n# \nPUBLISH channel message  # \n# \nUNSUBSCRIBE [channel [channel ....]]   # \nPUNSUBSCRIBE [pattern [pattern ....]]  #\n```\n\n **PubSub**\n\n![](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdlahl8sg30qq0cenpg.gif)\n\n\n\n1.  Redis \n2.  `SUBSCRIBE wmyskxz.chat`  `wmyskxz.chat`  ****\n3.  `PUBLISH wmyskxz.chat 'message'`  **** \n\n#### 6.  \n\n\t\tJava\n\n#### 7.\n\n\t\tRedis\n\n#### 8.-Master-SlaveRedis Sentinel\n\n\t\t3.0\n\n\n\n### .\n\n* key  `:::`*\n\n#### 1. string\n\n>  `.jpeg`  512 MB \n\n- ****\n\n```\n> SET key value\nOK\n> GET key\n\"value\"\n```\n\n key `SET` \n\n```\n> SET key newValue\nOK\n> GET key\n\"newValue\"\n```\n\n `EXISTS`  `DEL` \n\n```\n> EXISTS key\n(integer) 1\n> DEL key\n(integer) 1\n> GET key\n(nil)\n```\n\n- ****\n\n```\n> SET key1 value1\nOK\n> SET key2 value2\nOK\n> MGET key1 key2 key3    # \n1) \"value1\"\n2) \"value2\"\n3) (nil)\n> MSET key1 value1 key2 value2\n> MGET key1 key2\n1) \"value1\"\n2) \"value2\"\n```\n\n- ** SET **\n\n key *()*\n\n```\n> SET key value1\n> GET key\n\"value1\"\n> EXPIRE name 5    # 5s \n...                #  5s\n> GET key\n(nil)\n```\n\n `SET` + `EXPIRE`  `SETEX` \n\n```\n> SETEX key 5 value1\n...                #  5s \n> GET key\n(nil)\n\n> SETNX key value1  #  key  SET \n(integer) 1\n> SETNX key value1  #  key  SET \n(integer) 0\n> GET key\n\"value\"             #  \n```\n\n- ****\n\n value  `INCR`  ****  key \n\n```\n> SET counter 100\n> INCR counter\n(integer) 101\n> INCRBY counter 50\n(integer) 151\n```\n\n#### 2. list\n\n> Redis  Java  **LinkedList** list  O(1) O(n)\n\n****\n\n- `LPUSH`  `RPUSH`  list \n- `LRANGE`  list \n- `LINDEX`  list  Java  `get(int index)` \n\n\n\n```console\n> rpush mylist A\n(integer) 1\n> rpush mylist B\n(integer) 2\n> lpush mylist first\n(integer) 3\n> lrange mylist 0 -1    # -1 , \n1) \"first\"\n2) \"A\"\n3) \"B\"\n```\n\n- list \n\n\n\n```console\n> RPUSH books python java golang\n(integer) 3\n> LPOP books\n\"python\"\n> LPOP books\n\"java\"\n> LPOP books\n\"golang\"\n> LPOP books\n(nil)\n```\n\n- list \n\n\n\n```console\n> RPUSH books python java golang\n> RPOP books\n\"golang\"\n> RPOP books\n\"java\"\n> RPOP books\n\"python\"\n> RPOP books\n(nil)\n```\n\n- lrange \n\n#### 3. hash\n\n> Redis  Java  **HashMap** **\" + \"**  ****\n\n- \n\n```\n> HSET books java \"think in java\"    # \n(integer) 1\n> HSET books python \"python cookbook\"\n(integer) 1\n> HGETALL books    # key  value \n1) \"java\"\n2) \"think in java\"\n3) \"python\"\n4) \"python cookbook\"\n> HGET books java\n\"think in java\"\n> HSET books java \"head first java\"  \n(integer) 0        #  0\n> HMSET books java \"effetive  java\" python \"learning python\"    # \nOK\n```\n\n-  CookieId  Key 30  Session \n\n#### 4. set\n\n> Redis  Java  **HashSet** value  NULL\n\n- \n\n```\n> SADD books java\n(integer) 1\n> SADD books java    # \n(integer) 0\n> SADD books python golang\n(integer) 2\n> SMEMBERS books    # set  \n1) \"java\"\n2) \"python\"\n3) \"golang\"\n> SISMEMBER books java    #  value  contains\n(integer) 1\n> SCARD books    # \n(integer) 3\n> SPOP books     # \n\"java\"\n```\n\n- \n\n#### 5. zset\n\n>  Redis  Java  **SortedSet**  **HashMap**  set value  value  score  **** \n\n- \n\n```\n> ZADD books 9.0 \"think in java\"\n> ZADD books 8.9 \"java concurrency\"\n> ZADD books 8.6 \"java cookbook\"\n\n> ZRANGE books 0 -1     #  score \n1) \"java cookbook\"\n2) \"java concurrency\"\n3) \"think in java\"\n\n> ZREVRANGE books 0 -1  #  score \n1) \"think in java\"\n2) \"java concurrency\"\n3) \"java cookbook\"\n\n> ZCARD books           #  count()\n(integer) 3\n\n> ZSCORE books \"java concurrency\"   #  value  score\n\"8.9000000000000004\"                #  score  double \n\n> ZRANK books \"java concurrency\"    # \n(integer) 1\n\n> ZRANGEBYSCORE books 0 8.91        #  zset\n1) \"java cookbook\"\n2) \"java concurrency\"\n\n> ZRANGEBYSCORE books -inf 8.91 withscores  #  (-, 8.91]  zsetinf  infinite\n1) \"java cookbook\"\n2) \"8.5999999999999996\"\n3) \"java concurrency\"\n4) \"8.9000000000000004\"\n\n> ZREM books \"java concurrency\"             #  value\n(integer) 1\n> ZRANGE books 0 -1\n1) \"java cookbook\"\n2) \"think in java\"\n```\n\n-  TOP N \n\n### . Redis\n\n#### 1. \n\n##### \n\n\t\t\n\n********\n\n##### \n\n- \n\n    ****\n\n    > 1 \n    > 2A\n    > 3B\n    > 4B\n    > 5A\n\n- \n\n    \n\n    > A\n    > B\n    > B\n    > B\n    > A\n\n- \n\n****\n\n#### 2. \n\n##### \n\n\t\t key ID1ID\n\n##### \n\n1.  key\n\n    \t\t key  Redis `SET key value EX 10086` key  key Redis  key  key  1  Java \n\n```java\npublic Object getObjectInclNullById(Integer id) {\n    // \n    Object cacheValue = cache.get(id);\n    // \n    if (cacheValue == null) {\n        // \n        Object storageValue = storage.get(key);\n        // \n        cache.set(key, storageValue);\n        // (300)\n        if (storageValue == null) {\n            // \n            cache.expire(key, 60 * 5);\n        }\n        return storageValue;\n    }\n    return cacheValue;\n}\n```\n\n2. \n\n    \t\t key \n\n    \t\t Key\n\n    \t\t ****\n\n    ****\n\n    ******  \n\n    ****\n\n    1. \n\n    2.  1\n\n    ****\n\n    1. \n\n    2.  1 1 1\n\n    **** \n\n#### 3. \n\n##### \n\n\t\t**** \n\n\t\t\n\n\t\t****\n\n\t\t 12 Redis 12\n\n##### \n\nRedis\n\n1. Redis\n2. \n\n\n\n1. \n2. \n\n","source":"_posts/redis.md","raw":"---\ntitle: Redis\nheader-img: /img/header_img/post-bg-desk.jpg\ncatalog: true\ntop:\ntags:\n  - redis\ncategories:\n  - work\nabbrlink: a10a\ndate: 2021-04-15 00:00:00\nsubtitle:\n---\n\n\n\n### . Redis\n\n\t\tRedisBSD******************stringslistshashessetssorted sets**bitmapshyperloglogsgeospatial indexesstreams******luaLRU******redis sentinel****redis cluster******/******\n\n\n\n### . Redis\n\n> **API2**\n\n\t\t**HTTP**\n\n\t\tAPI **cache-control**:max-age=600 1010API\n\n\t\t****\n\n\t\tAPISQL2SQLAPIJDK**HashMap**ConcurrentHashMap**Guava Cache**Spring Cache10102SQL\n\n\t\tAPIAPI...\n\n\t\t**Redis**\n\n\t\tAPI Redis Memcached\n\n#### Redis\n\n\t\tSession12306\n\n### . Redis  Memcached \n\n- **** \n\n1. \n2. \n3. \n\n- **** \n\n1. **Redis **Redis  k/v  listsetzsethash Memcached  k/v \n2. **Redis  Memecache **\n3. **Redis ** \n4. **Redis Memcached **\n5. **Memcached  Redis  cluster **\n6. **Memcached  IO Redis  IO ** Redis 6.0  IO \n7. **Redis LuaMemcachedRedis**\n\n\n\n### . \n\n#### 1. \n\n#### 2. \n\n\tLinuxredis.confWindowsredis.windows.conf\n\n- \n\n    ```\n    appendonly yes\n    ```\n\n- portRedis6379\n- bind127.0.0.1\n\n- timeout00\n\n- dbfilenamedump.rdb\n\n- dir\n\n- rdbcompressionyes,RedisLZFCPU\n\n- saveKey-Valuesavesave<seconds><changes>:secondschanges900151\n\n    ```\n    127.0.0.1:6379> config set save \"900 1\"\n    OK\n    127.0.0.1:6379> config get save\n    1) \"save\"\n    2) \"900 1\"\n    ```\n\n- requirepassRedisRedisAUTH <password>\n\n- slaveofslavemasterIPRedismasterslavemaster\n\n    ```\n    slaveof<masterip><masterport>\n    ```\n\n- masterauthmasterslavemaster:\n\n    ```\n    masterauth<master-password>\n    ```\n\n- databases1616id0-150SELECT <dbid>id\n\n#### 3. Redis\n\n```\n#redis-cli -h host -p port -a password\n```\n\n\n\n```\nroot@0912b31c4171# redis-cli\n```\n\n\n\n### . Redis\n\n#### 1.  \n\n\t\t IO IO 110000 (SET) 81000 /(GET) `redis-benchmark -n 100000 -q`  10 \n\n```\nroot@0912b31c4171:/data# redis-benchmark -n 100000 -q\nPING_INLINE: 31172.07 requests per second\nPING_BULK: 31615.55 requests per second\nSET: 30432.14 requests per second\nGET: 31289.11 requests per second\nINCR: 30441.40 requests per second\nLPUSH: 29550.83 requests per second\nRPUSH: 30184.12 requests per second\n```\n\n#### 2.  \n\n\t\tstringlisthashsetsortedsetbitmapshyperloglogsgeospatial indexesstream**string()****list()****hash()****set()**  **zset()** 5  Redis \n\n#### 3. \n\n\t\tRedis  `file event handler` Redis  IO  socket socket \n\n 4 \n\n-  socket\n\n- IO \n\n- \n\n- \n\n    \t\t socket  IO  socket socket \n\n    *** I/O ***\n\n     ***I/O  I/O  I/O ***\n\n#### 4.  \n\n\t\tRDBAOF\n\n\t\t**RDB**(Redis DataBase) Redis ****2 *100*  Redis  `.rdb` \n\n\t\t**AOF** (Append Only File - ) ****  ****  AOF  Redis  **** Redis  **** **** Redis \n\n\t\t**RDB**\n\n- RDB\n\n- RDBredisfork()IO\n\n- RDB  AOF \n\n\t\t**RDB**\n\n- RDB\n\n\t\t**AOF**\n\n- AOFAOF1fsync12AOF\n\n- AOF\n\n- AOFflushallrewriteAOFflushallAOF\n\n\t\t**AOF**\n\n- AOFRDB\n\n- AOFQPSRDBQPSAOFfsyncfsync\n\n- AOFbugAOF\n\n#### 5. \n\n\t\t**/ **  Web  ****/ redis `list`  `lpush`  `rpop`  **** \n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdit62wmj30yg0ccgmp.jpg)\n\n\t\t**Redis**`Publisher`  `Consumer` **** *(channel)*\n\n![image](https://tvax1.sinaimg.cn/large/006YzKDNly1gopdjtvehij30yg0cbmy0.jpg)\n\n `Publisher`  `channel`  `channel`  `Consumer`  ****  ****  ****  **** \n\n**Redis**  ****  **Pattern Subscribe** **** \n\n![image](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdkll7gtj30yg0cb0ul.jpg)\n\n****  **`Consumer` **\n\n`Publisher`  `wmyskxz.chat`  `channel`  `Consumer 1`  `Consumer 2`  `channel`  `wmyskxz.*`  **Redis**  `wmyskxz.*`  `Consumer 3`  `wmyskxz.log`  `Consumer 4`  `Consumer 5`\n\n `wmyskxz.chat` `Consumer 3`   \n\n##### **\n\n **Redis** **PubSub** \n\n```bash\n# \nSUBSCRIBE channel [channel ....]   # \nPSUBSCRIBE pattern [pattern ....]  # \n# \nPUBLISH channel message  # \n# \nUNSUBSCRIBE [channel [channel ....]]   # \nPUNSUBSCRIBE [pattern [pattern ....]]  #\n```\n\n **PubSub**\n\n![](https://tvax2.sinaimg.cn/large/006YzKDNly1gopdlahl8sg30qq0cenpg.gif)\n\n\n\n1.  Redis \n2.  `SUBSCRIBE wmyskxz.chat`  `wmyskxz.chat`  ****\n3.  `PUBLISH wmyskxz.chat 'message'`  **** \n\n#### 6.  \n\n\t\tJava\n\n#### 7.\n\n\t\tRedis\n\n#### 8.-Master-SlaveRedis Sentinel\n\n\t\t3.0\n\n\n\n### .\n\n* key  `:::`*\n\n#### 1. string\n\n>  `.jpeg`  512 MB \n\n- ****\n\n```\n> SET key value\nOK\n> GET key\n\"value\"\n```\n\n key `SET` \n\n```\n> SET key newValue\nOK\n> GET key\n\"newValue\"\n```\n\n `EXISTS`  `DEL` \n\n```\n> EXISTS key\n(integer) 1\n> DEL key\n(integer) 1\n> GET key\n(nil)\n```\n\n- ****\n\n```\n> SET key1 value1\nOK\n> SET key2 value2\nOK\n> MGET key1 key2 key3    # \n1) \"value1\"\n2) \"value2\"\n3) (nil)\n> MSET key1 value1 key2 value2\n> MGET key1 key2\n1) \"value1\"\n2) \"value2\"\n```\n\n- ** SET **\n\n key *()*\n\n```\n> SET key value1\n> GET key\n\"value1\"\n> EXPIRE name 5    # 5s \n...                #  5s\n> GET key\n(nil)\n```\n\n `SET` + `EXPIRE`  `SETEX` \n\n```\n> SETEX key 5 value1\n...                #  5s \n> GET key\n(nil)\n\n> SETNX key value1  #  key  SET \n(integer) 1\n> SETNX key value1  #  key  SET \n(integer) 0\n> GET key\n\"value\"             #  \n```\n\n- ****\n\n value  `INCR`  ****  key \n\n```\n> SET counter 100\n> INCR counter\n(integer) 101\n> INCRBY counter 50\n(integer) 151\n```\n\n#### 2. list\n\n> Redis  Java  **LinkedList** list  O(1) O(n)\n\n****\n\n- `LPUSH`  `RPUSH`  list \n- `LRANGE`  list \n- `LINDEX`  list  Java  `get(int index)` \n\n\n\n```console\n> rpush mylist A\n(integer) 1\n> rpush mylist B\n(integer) 2\n> lpush mylist first\n(integer) 3\n> lrange mylist 0 -1    # -1 , \n1) \"first\"\n2) \"A\"\n3) \"B\"\n```\n\n- list \n\n\n\n```console\n> RPUSH books python java golang\n(integer) 3\n> LPOP books\n\"python\"\n> LPOP books\n\"java\"\n> LPOP books\n\"golang\"\n> LPOP books\n(nil)\n```\n\n- list \n\n\n\n```console\n> RPUSH books python java golang\n> RPOP books\n\"golang\"\n> RPOP books\n\"java\"\n> RPOP books\n\"python\"\n> RPOP books\n(nil)\n```\n\n- lrange \n\n#### 3. hash\n\n> Redis  Java  **HashMap** **\" + \"**  ****\n\n- \n\n```\n> HSET books java \"think in java\"    # \n(integer) 1\n> HSET books python \"python cookbook\"\n(integer) 1\n> HGETALL books    # key  value \n1) \"java\"\n2) \"think in java\"\n3) \"python\"\n4) \"python cookbook\"\n> HGET books java\n\"think in java\"\n> HSET books java \"head first java\"  \n(integer) 0        #  0\n> HMSET books java \"effetive  java\" python \"learning python\"    # \nOK\n```\n\n-  CookieId  Key 30  Session \n\n#### 4. set\n\n> Redis  Java  **HashSet** value  NULL\n\n- \n\n```\n> SADD books java\n(integer) 1\n> SADD books java    # \n(integer) 0\n> SADD books python golang\n(integer) 2\n> SMEMBERS books    # set  \n1) \"java\"\n2) \"python\"\n3) \"golang\"\n> SISMEMBER books java    #  value  contains\n(integer) 1\n> SCARD books    # \n(integer) 3\n> SPOP books     # \n\"java\"\n```\n\n- \n\n#### 5. zset\n\n>  Redis  Java  **SortedSet**  **HashMap**  set value  value  score  **** \n\n- \n\n```\n> ZADD books 9.0 \"think in java\"\n> ZADD books 8.9 \"java concurrency\"\n> ZADD books 8.6 \"java cookbook\"\n\n> ZRANGE books 0 -1     #  score \n1) \"java cookbook\"\n2) \"java concurrency\"\n3) \"think in java\"\n\n> ZREVRANGE books 0 -1  #  score \n1) \"think in java\"\n2) \"java concurrency\"\n3) \"java cookbook\"\n\n> ZCARD books           #  count()\n(integer) 3\n\n> ZSCORE books \"java concurrency\"   #  value  score\n\"8.9000000000000004\"                #  score  double \n\n> ZRANK books \"java concurrency\"    # \n(integer) 1\n\n> ZRANGEBYSCORE books 0 8.91        #  zset\n1) \"java cookbook\"\n2) \"java concurrency\"\n\n> ZRANGEBYSCORE books -inf 8.91 withscores  #  (-, 8.91]  zsetinf  infinite\n1) \"java cookbook\"\n2) \"8.5999999999999996\"\n3) \"java concurrency\"\n4) \"8.9000000000000004\"\n\n> ZREM books \"java concurrency\"             #  value\n(integer) 1\n> ZRANGE books 0 -1\n1) \"java cookbook\"\n2) \"think in java\"\n```\n\n-  TOP N \n\n### . Redis\n\n#### 1. \n\n##### \n\n\t\t\n\n********\n\n##### \n\n- \n\n    ****\n\n    > 1 \n    > 2A\n    > 3B\n    > 4B\n    > 5A\n\n- \n\n    \n\n    > A\n    > B\n    > B\n    > B\n    > A\n\n- \n\n****\n\n#### 2. \n\n##### \n\n\t\t key ID1ID\n\n##### \n\n1.  key\n\n    \t\t key  Redis `SET key value EX 10086` key  key Redis  key  key  1  Java \n\n```java\npublic Object getObjectInclNullById(Integer id) {\n    // \n    Object cacheValue = cache.get(id);\n    // \n    if (cacheValue == null) {\n        // \n        Object storageValue = storage.get(key);\n        // \n        cache.set(key, storageValue);\n        // (300)\n        if (storageValue == null) {\n            // \n            cache.expire(key, 60 * 5);\n        }\n        return storageValue;\n    }\n    return cacheValue;\n}\n```\n\n2. \n\n    \t\t key \n\n    \t\t Key\n\n    \t\t ****\n\n    ****\n\n    ******  \n\n    ****\n\n    1. \n\n    2.  1\n\n    ****\n\n    1. \n\n    2.  1 1 1\n\n    **** \n\n#### 3. \n\n##### \n\n\t\t**** \n\n\t\t\n\n\t\t****\n\n\t\t 12 Redis 12\n\n##### \n\nRedis\n\n1. Redis\n2. \n\n\n\n1. \n2. \n\n","slug":"redis","published":1,"updated":"2022-04-23T08:54:26.582Z","comments":1,"layout":"post","photos":[],"link":"","_id":"cl2bmwefh002hkh6zdhkxef79","content":"<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><p>        RedisBSD<strong></strong><strong></strong><strong></strong><strong></strong><strong>stringslistshashessetssorted sets</strong>bitmapshyperloglogsgeospatial indexesstreams<strong></strong><strong>luaLRU</strong><strong></strong>redis sentinel<strong></strong>redis cluster<strong></strong><strong>/</strong><strong></strong></p>\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><blockquote>\n<p><strong>API2</strong></p>\n</blockquote>\n<p>        <strong>HTTP</strong></p>\n<p>        API <strong>cache-control</strong>:max-age=600 1010API</p>\n<p>        <strong></strong></p>\n<p>        APISQL2SQLAPIJDK<strong>HashMap</strong>ConcurrentHashMap<strong>Guava Cache</strong>Spring Cache10102SQL</p>\n<p>        APIAPI</p>\n<p>        <strong>Redis</strong></p>\n<p>        API Redis Memcached</p>\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><p>        Session12306</p>\n<h3 id=\"-Redis--Memcached-\"><a href=\"#-Redis--Memcached-\" class=\"headerlink\" title=\". Redis  Memcached \"></a>. Redis  Memcached </h3><ul>\n<li><strong></strong> </li>\n</ul>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><strong></strong> </li>\n</ul>\n<ol>\n<li><strong>Redis </strong>Redis  k/v  listsetzsethash Memcached  k/v </li>\n<li><strong>Redis  Memecache </strong></li>\n<li><strong>Redis </strong> </li>\n<li><strong>Redis Memcached </strong></li>\n<li><strong>Memcached  Redis  cluster </strong></li>\n<li><strong>Memcached  IO Redis  IO </strong> Redis 6.0  IO </li>\n<li><strong>Redis LuaMemcachedRedis</strong></li>\n</ol>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\". \"></a>. </h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><p>    Linuxredis.confWindowsredis.windows.conf</p>\n<ul>\n<li><p></p>\n  <figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">appendonly</span> <span class=\"literal\">yes</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>portRedis6379</p>\n</li>\n<li><p>bind127.0.0.1</p>\n</li>\n<li><p>timeout00</p>\n</li>\n<li><p>dbfilenamedump.rdb</p>\n</li>\n<li><p>dir</p>\n</li>\n<li><p>rdbcompressionyes,RedisLZFCPU</p>\n</li>\n<li><p>saveKey-Valuesavesave<seconds><changes>:secondschanges900151</p>\n  <figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt;<span class=\"built_in\"> config </span><span class=\"builtin-name\">set</span> save <span class=\"string\">\"900 1\"</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt;<span class=\"built_in\"> config </span><span class=\"builtin-name\">get</span> save</span><br><span class=\"line\">1) <span class=\"string\">\"save\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"900 1\"</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>requirepassRedisRedisAUTH <password></p>\n</li>\n<li><p>slaveofslavemasterIPRedismasterslavemaster</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">slaveof<span class=\"tag\">&lt;<span class=\"name\">masterip</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">masterport</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>masterauthmasterslavemaster:</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">masterauth<span class=\"tag\">&lt;<span class=\"name\">master-password</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>databases1616id0-150SELECT <dbid>id</p>\n</li>\n</ul>\n<h4 id=\"3-Redis\"><a href=\"#3-Redis\" class=\"headerlink\" title=\"3. Redis\"></a>3. Redis</h4><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#redis-cli</span> -h host -<span class=\"selector-tag\">p</span> port -<span class=\"selector-tag\">a</span> password</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">root@</span><span class=\"number\">0912</span>b31c4171# redis-cli</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><p>         IO IO 110000 (SET) 81000 /(GET) <code>redis-benchmark -n 100000 -q</code>  10 </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">root@0912b31c4171:/data#</span> <span class=\"string\">redis-benchmark</span> <span class=\"string\">-n</span> <span class=\"number\">100000</span> <span class=\"string\">-q</span></span><br><span class=\"line\"><span class=\"attr\">PING_INLINE:</span> <span class=\"number\">31172.07</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">PING_BULK:</span> <span class=\"number\">31615.55</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">SET:</span> <span class=\"number\">30432.14</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">GET:</span> <span class=\"number\">31289.11</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">INCR:</span> <span class=\"number\">30441.40</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">LPUSH:</span> <span class=\"number\">29550.83</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">RPUSH:</span> <span class=\"number\">30184.12</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><p>        stringlisthashsetsortedsetbitmapshyperloglogsgeospatial indexesstream<strong>string()</strong><strong>list()</strong><strong>hash()</strong><strong>set()</strong>  <strong>zset()</strong> 5  Redis </p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h4><p>        Redis  <code>file event handler</code> Redis  IO  socket socket </p>\n<p> 4 </p>\n<ul>\n<li><p> socket</p>\n</li>\n<li><p>IO </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<p>           socket  IO  socket socket </p>\n<p>  <strong><em> I/O </em></strong></p>\n<p>   <strong><em>I/O  I/O  I/O </em></strong></p>\n</li>\n</ul>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h4><p>        RDBAOF</p>\n<p>        <strong>RDB</strong>(Redis DataBase) Redis <strong></strong>2 <em>100</em>  Redis  <code>.rdb</code> </p>\n<p>        <strong>AOF</strong> (Append Only File - ) <strong></strong>  <strong></strong>  AOF  Redis  <strong></strong> Redis  <strong></strong> <strong></strong> Redis </p>\n<p>        <strong>RDB</strong></p>\n<ul>\n<li><p>RDB</p>\n</li>\n<li><p>RDBredisfork()IO</p>\n</li>\n<li><p>RDB  AOF </p>\n</li>\n</ul>\n<p>        <strong>RDB</strong></p>\n<ul>\n<li>RDB</li>\n</ul>\n<p>        <strong>AOF</strong></p>\n<ul>\n<li><p>AOFAOF1fsync12AOF</p>\n</li>\n<li><p>AOF</p>\n</li>\n<li><p>AOFflushallrewriteAOFflushallAOF</p>\n</li>\n</ul>\n<p>        <strong>AOF</strong></p>\n<ul>\n<li><p>AOFRDB</p>\n</li>\n<li><p>AOFQPSRDBQPSAOFfsyncfsync</p>\n</li>\n<li><p>AOFbugAOF</p>\n</li>\n</ul>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h4><p>        <strong>/ </strong>  Web  <strong></strong>/ redis <code>list</code>  <code>lpush</code>  <code>rpop</code>  <strong></strong> </p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdit62wmj30yg0ccgmp.jpg\" alt=\"image\"></p>\n<p>        <strong>Redis</strong><code>Publisher</code>  <code>Consumer</code> <strong></strong> <em>(channel)</em></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gopdjtvehij30yg0cbmy0.jpg\" alt=\"image\"></p>\n<p> <code>Publisher</code>  <code>channel</code>  <code>channel</code>  <code>Consumer</code>  <strong></strong>  <strong></strong>  <strong></strong>  <strong></strong> </p>\n<p><strong>Redis</strong>  <strong></strong>  <strong>Pattern Subscribe</strong> <strong></strong> </p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdkll7gtj30yg0cb0ul.jpg\" alt=\"image\"></p>\n<p><strong></strong>  <strong><code>Consumer</code> </strong></p>\n<p><code>Publisher</code>  <code>wmyskxz.chat</code>  <code>channel</code>  <code>Consumer 1</code>  <code>Consumer 2</code>  <code>channel</code>  <code>wmyskxz.*</code>  <strong>Redis</strong>  <code>wmyskxz.*</code>  <code>Consumer 3</code>  <code>wmyskxz.log</code>  <code>Consumer 4</code>  <code>Consumer 5</code></p>\n<p> <code>wmyskxz.chat</code> <code>Consumer 3</code>   </p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><em></em></h5><p> <strong>Redis</strong> <strong>PubSub</strong> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">SUBSCRIBE channel [channel ....]   <span class=\"comment\"># </span></span><br><span class=\"line\">PSUBSCRIBE pattern [pattern ....]  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">PUBLISH channel message  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">UNSUBSCRIBE [channel [channel ....]]   <span class=\"comment\"># </span></span><br><span class=\"line\">PUNSUBSCRIBE [pattern [pattern ....]]  <span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n\n<p> <strong>PubSub</strong></p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdlahl8sg30qq0cenpg.gif\" alt=\"\"></p>\n<p></p>\n<ol>\n<li> Redis </li>\n<li> <code>SUBSCRIBE wmyskxz.chat</code>  <code>wmyskxz.chat</code>  <strong></strong></li>\n<li> <code>PUBLISH wmyskxz.chat &#39;message&#39;</code>  <strong></strong> </li>\n</ol>\n<h4 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h4><p>        Java</p>\n<h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><p>        Redis</p>\n<h4 id=\"8--Master-SlaveRedis-Sentinel\"><a href=\"#8--Master-SlaveRedis-Sentinel\" class=\"headerlink\" title=\"8.-Master-SlaveRedis Sentinel\"></a>8.-Master-SlaveRedis Sentinel</h4><p>        3.0</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h3><p><em> key  <code>:::</code></em></p>\n<h4 id=\"1-string\"><a href=\"#1-string\" class=\"headerlink\" title=\"1. string\"></a>1. string</h4><blockquote>\n<p> <code>.jpeg</code>  512 MB </p>\n</blockquote>\n<ul>\n<li><strong></strong></li>\n</ul>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key value</span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"value\"</span></span><br></pre></td></tr></table></figure>\n\n<p> key <code>SET</code> </p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key newValue</span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"newValue\"</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>EXISTS</code>  <code>DEL</code> </p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; EXISTS <span class=\"type\">key</span></span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; DEL <span class=\"type\">key</span></span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">SET</span> key1 <span class=\"comment\">value1</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"keyword\">SET</span> <span class=\"comment\">key2 value2</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; MGET <span class=\"comment\">key1 key2 key3    #</span> </span><br><span class=\"line\">1) <span class=\"string\">\"value1\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"value2\"</span></span><br><span class=\"line\">3) (nil)</span><br><span class=\"line\">&gt; MSET <span class=\"comment\">key1 value1 key2 value2</span></span><br><span class=\"line\">&gt; MGET <span class=\"comment\">key1 key2</span></span><br><span class=\"line\">1) <span class=\"string\">\"value1\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"value2\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong> SET </strong></li>\n</ul>\n<p> key <em>()</em></p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key value1</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"value1\"</span></span><br><span class=\"line\">&gt; EXPIRE name 5    # 5s </span><br><span class=\"line\"><span class=\"built_in\">..</span>.                #  5s</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\">(<span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n\n<p> <code>SET</code> + <code>EXPIRE</code>  <code>SETEX</code> </p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SETEX <span class=\"type\">key</span> <span class=\"number\">5</span> value1</span><br><span class=\"line\">...                #  <span class=\"number\">5</span>s </span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\">(nil)</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; SETNX <span class=\"type\">key</span> value1  #  <span class=\"type\">key</span>  SET </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; SETNX <span class=\"type\">key</span> value1  #  <span class=\"type\">key</span>  SET </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">0</span></span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\"><span class=\"string\">\"value\"</span>             # </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<p> value  <code>INCR</code>  <strong></strong>  key </p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SET counter <span class=\"number\">100</span></span><br><span class=\"line\">&gt; INCR counter</span><br><span class=\"line\">(<span class=\"built_in\">int</span>eger) <span class=\"number\">101</span></span><br><span class=\"line\">&gt; INCRBY counter <span class=\"number\">50</span></span><br><span class=\"line\">(<span class=\"built_in\">int</span>eger) <span class=\"number\">151</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-list\"><a href=\"#2-list\" class=\"headerlink\" title=\"2. list\"></a>2. list</h4><blockquote>\n<p>Redis  Java  <strong>LinkedList</strong> list  O(1) O(n)</p>\n</blockquote>\n<p><strong></strong></p>\n<ul>\n<li><code>LPUSH</code>  <code>RPUSH</code>  list </li>\n<li><code>LRANGE</code>  list </li>\n<li><code>LINDEX</code>  list  Java  <code>get(int index)</code> </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> rpush mylist A</span></span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> rpush mylist B</span></span><br><span class=\"line\">(integer) 2</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> lpush mylist first</span></span><br><span class=\"line\">(integer) 3</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> lrange mylist 0 -1    <span class=\"comment\"># -1 , </span></span></span><br><span class=\"line\">1) \"first\"</span><br><span class=\"line\">2) \"A\"</span><br><span class=\"line\">3) \"B\"</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>list </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPUSH books python java golang</span></span><br><span class=\"line\">(integer) 3</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"python\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"java\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"golang\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>list </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPUSH books python java golang</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"golang\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"java\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"python\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>lrange </li>\n</ul>\n<h4 id=\"3-hash\"><a href=\"#3-hash\" class=\"headerlink\" title=\"3. hash\"></a>3. hash</h4><blockquote>\n<p>Redis  Java  <strong>HashMap</strong> <strong> + </strong>  <strong></strong></p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; HSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"think in java\"</span>    <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; HSET <span class=\"keyword\">books </span>python <span class=\"string\">\"python cookbook\"</span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; HGETALL <span class=\"keyword\">books </span>   <span class=\"comment\"># key  value </span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"python\"</span></span><br><span class=\"line\"><span class=\"number\">4</span>) <span class=\"string\">\"python cookbook\"</span></span><br><span class=\"line\">&gt; HGET <span class=\"keyword\">books </span><span class=\"keyword\">java</span></span><br><span class=\"line\"><span class=\"keyword\">\"think </span>in <span class=\"keyword\">java\"</span></span><br><span class=\"line\"><span class=\"keyword\">&gt; </span>HSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"head first java\"</span>  </span><br><span class=\"line\">(integer) <span class=\"number\">0</span>        <span class=\"comment\">#  0</span></span><br><span class=\"line\">&gt; HMSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"effetive  java\"</span> python <span class=\"string\">\"learning python\"</span>    <span class=\"comment\"># </span></span><br><span class=\"line\">OK</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> CookieId  Key 30  Session </li>\n</ul>\n<h4 id=\"4-set\"><a href=\"#4-set\" class=\"headerlink\" title=\"4. set\"></a>4. set</h4><blockquote>\n<p>Redis  Java  <strong>HashSet</strong> value  NULL</p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span><span class=\"keyword\">java</span></span><br><span class=\"line\"><span class=\"keyword\">(integer) </span><span class=\"number\">1</span></span><br><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span><span class=\"keyword\">java </span>   <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">0</span></span><br><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span>python golang</span><br><span class=\"line\">(integer) <span class=\"number\">2</span></span><br><span class=\"line\">&gt; SMEMBERS <span class=\"keyword\">books </span>   <span class=\"comment\"># set  </span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"python\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"golang\"</span></span><br><span class=\"line\">&gt; SISMEMBER <span class=\"keyword\">books </span><span class=\"keyword\">java </span>   <span class=\"comment\">#  value  contains</span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; <span class=\"keyword\">SCARD </span><span class=\"keyword\">books </span>   <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">3</span></span><br><span class=\"line\">&gt; SPOP <span class=\"keyword\">books </span>    <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">\"java\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<h4 id=\"5-zset\"><a href=\"#5-zset\" class=\"headerlink\" title=\"5. zset\"></a>5. zset</h4><blockquote>\n<p> Redis  Java  <strong>SortedSet</strong>  <strong>HashMap</strong>  set value  value  score  <strong></strong> </p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; ZADD books <span class=\"number\">9.0</span> <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\">&gt; ZADD books <span class=\"number\">8.9</span> <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\">&gt; ZADD books <span class=\"number\">8.6</span> <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span>     #  score </span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZREVRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span>  #  score </span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZCARD books           #  count()</span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">3</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZSCORE books <span class=\"string\">\"java concurrency\"</span>   #  value  score</span><br><span class=\"line\"><span class=\"string\">\"8.9000000000000004\"</span>                #  score  double </span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANK books <span class=\"string\">\"java concurrency\"</span>    # </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGEBYSCORE books <span class=\"number\">0</span> <span class=\"number\">8.91</span>        #  zset</span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGEBYSCORE books -inf <span class=\"number\">8.91</span> withscores  #  (-, <span class=\"number\">8.91</span>]  zsetinf  infinite</span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"8.5999999999999996\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">4</span>) <span class=\"string\">\"8.9000000000000004\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZREM books <span class=\"string\">\"java concurrency\"</span>             #  value</span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; ZRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"think in java\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> TOP N </li>\n</ul>\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>        </p>\n<p><strong></strong><strong></strong></p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li><p></p>\n<p>  <strong></strong></p>\n<blockquote>\n<p>1 <br>2A<br>3B<br>4B<br>5A</p>\n</blockquote>\n</li>\n<li><p></p>\n<p>  </p>\n<blockquote>\n<p>A<br>B<br>B<br>B<br>A</p>\n</blockquote>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p><strong></strong></p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>         key ID1ID</p>\n<h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ol>\n<li><p> key</p>\n<p>          key  Redis <code>SET key value EX 10086</code> key  key Redis  key  key  1  Java </p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getObjectInclNullById</span><span class=\"params\">(Integer id)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Object cacheValue = cache.get(id);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cacheValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Object storageValue = storage.get(key);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        cache.set(key, storageValue);</span><br><span class=\"line\">        <span class=\"comment\">// (300)</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (storageValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cache.expire(key, <span class=\"number\">60</span> * <span class=\"number\">5</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> storageValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cacheValue;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li><p></p>\n<p>          key </p>\n<p>          Key</p>\n<p>          <strong></strong></p>\n<hr>\n<p> <strong><em></em></strong>  </p>\n<p> <strong></strong></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> 1</p>\n</li>\n</ol>\n<p> <strong></strong></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> 1 1 1</p>\n<p><strong></strong> </p>\n</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>        <strong></strong> </p>\n<p>        </p>\n<p>        <strong></strong></p>\n<p>         12 Redis 12</p>\n<h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><p>Redis</p>\n<ol>\n<li>Redis</li>\n<li></li>\n</ol>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n","site":{"data":{}},"excerpt":"","more":"<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><p>        RedisBSD<strong></strong><strong></strong><strong></strong><strong></strong><strong>stringslistshashessetssorted sets</strong>bitmapshyperloglogsgeospatial indexesstreams<strong></strong><strong>luaLRU</strong><strong></strong>redis sentinel<strong></strong>redis cluster<strong></strong><strong>/</strong><strong></strong></p>\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><blockquote>\n<p><strong>API2</strong></p>\n</blockquote>\n<p>        <strong>HTTP</strong></p>\n<p>        API <strong>cache-control</strong>:max-age=600 1010API</p>\n<p>        <strong></strong></p>\n<p>        APISQL2SQLAPIJDK<strong>HashMap</strong>ConcurrentHashMap<strong>Guava Cache</strong>Spring Cache10102SQL</p>\n<p>        APIAPI</p>\n<p>        <strong>Redis</strong></p>\n<p>        API Redis Memcached</p>\n<h4 id=\"Redis\"><a href=\"#Redis\" class=\"headerlink\" title=\"Redis\"></a>Redis</h4><p>        Session12306</p>\n<h3 id=\"-Redis--Memcached-\"><a href=\"#-Redis--Memcached-\" class=\"headerlink\" title=\". Redis  Memcached \"></a>. Redis  Memcached </h3><ul>\n<li><strong></strong> </li>\n</ul>\n<ol>\n<li></li>\n<li></li>\n<li></li>\n</ol>\n<ul>\n<li><strong></strong> </li>\n</ul>\n<ol>\n<li><strong>Redis </strong>Redis  k/v  listsetzsethash Memcached  k/v </li>\n<li><strong>Redis  Memecache </strong></li>\n<li><strong>Redis </strong> </li>\n<li><strong>Redis Memcached </strong></li>\n<li><strong>Memcached  Redis  cluster </strong></li>\n<li><strong>Memcached  IO Redis  IO </strong> Redis 6.0  IO </li>\n<li><strong>Redis LuaMemcachedRedis</strong></li>\n</ol>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\". \"></a>. </h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><p>    Linuxredis.confWindowsredis.windows.conf</p>\n<ul>\n<li><p></p>\n  <figure class=\"highlight nginx\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"attribute\">appendonly</span> <span class=\"literal\">yes</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>portRedis6379</p>\n</li>\n<li><p>bind127.0.0.1</p>\n</li>\n<li><p>timeout00</p>\n</li>\n<li><p>dbfilenamedump.rdb</p>\n</li>\n<li><p>dir</p>\n</li>\n<li><p>rdbcompressionyes,RedisLZFCPU</p>\n</li>\n<li><p>saveKey-Valuesavesave<seconds><changes>:secondschanges900151</p>\n  <figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">127.0.0.1:6379&gt;<span class=\"built_in\"> config </span><span class=\"builtin-name\">set</span> save <span class=\"string\">\"900 1\"</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">127.0.0.1:6379&gt;<span class=\"built_in\"> config </span><span class=\"builtin-name\">get</span> save</span><br><span class=\"line\">1) <span class=\"string\">\"save\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"900 1\"</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>requirepassRedisRedisAUTH <password></p>\n</li>\n<li><p>slaveofslavemasterIPRedismasterslavemaster</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">slaveof<span class=\"tag\">&lt;<span class=\"name\">masterip</span>&gt;</span><span class=\"tag\">&lt;<span class=\"name\">masterport</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>masterauthmasterslavemaster:</p>\n  <figure class=\"highlight xml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">masterauth<span class=\"tag\">&lt;<span class=\"name\">master-password</span>&gt;</span></span><br></pre></td></tr></table></figure>\n</li>\n<li><p>databases1616id0-150SELECT <dbid>id</p>\n</li>\n</ul>\n<h4 id=\"3-Redis\"><a href=\"#3-Redis\" class=\"headerlink\" title=\"3. Redis\"></a>3. Redis</h4><figure class=\"highlight stylus\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"selector-id\">#redis-cli</span> -h host -<span class=\"selector-tag\">p</span> port -<span class=\"selector-tag\">a</span> password</span><br></pre></td></tr></table></figure>\n\n<p></p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"symbol\">root@</span><span class=\"number\">0912</span>b31c4171# redis-cli</span><br></pre></td></tr></table></figure>\n\n\n\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><p>         IO IO 110000 (SET) 81000 /(GET) <code>redis-benchmark -n 100000 -q</code>  10 </p>\n<figure class=\"highlight yaml\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"string\">root@0912b31c4171:/data#</span> <span class=\"string\">redis-benchmark</span> <span class=\"string\">-n</span> <span class=\"number\">100000</span> <span class=\"string\">-q</span></span><br><span class=\"line\"><span class=\"attr\">PING_INLINE:</span> <span class=\"number\">31172.07</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">PING_BULK:</span> <span class=\"number\">31615.55</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">SET:</span> <span class=\"number\">30432.14</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">GET:</span> <span class=\"number\">31289.11</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">INCR:</span> <span class=\"number\">30441.40</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">LPUSH:</span> <span class=\"number\">29550.83</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br><span class=\"line\"><span class=\"attr\">RPUSH:</span> <span class=\"number\">30184.12</span> <span class=\"string\">requests</span> <span class=\"string\">per</span> <span class=\"string\">second</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><p>        stringlisthashsetsortedsetbitmapshyperloglogsgeospatial indexesstream<strong>string()</strong><strong>list()</strong><strong>hash()</strong><strong>set()</strong>  <strong>zset()</strong> 5  Redis </p>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h4><p>        Redis  <code>file event handler</code> Redis  IO  socket socket </p>\n<p> 4 </p>\n<ul>\n<li><p> socket</p>\n</li>\n<li><p>IO </p>\n</li>\n<li><p></p>\n</li>\n<li><p></p>\n<p>           socket  IO  socket socket </p>\n<p>  <strong><em> I/O </em></strong></p>\n<p>   <strong><em>I/O  I/O  I/O </em></strong></p>\n</li>\n</ul>\n<h4 id=\"4-\"><a href=\"#4-\" class=\"headerlink\" title=\"4. \"></a>4. </h4><p>        RDBAOF</p>\n<p>        <strong>RDB</strong>(Redis DataBase) Redis <strong></strong>2 <em>100</em>  Redis  <code>.rdb</code> </p>\n<p>        <strong>AOF</strong> (Append Only File - ) <strong></strong>  <strong></strong>  AOF  Redis  <strong></strong> Redis  <strong></strong> <strong></strong> Redis </p>\n<p>        <strong>RDB</strong></p>\n<ul>\n<li><p>RDB</p>\n</li>\n<li><p>RDBredisfork()IO</p>\n</li>\n<li><p>RDB  AOF </p>\n</li>\n</ul>\n<p>        <strong>RDB</strong></p>\n<ul>\n<li>RDB</li>\n</ul>\n<p>        <strong>AOF</strong></p>\n<ul>\n<li><p>AOFAOF1fsync12AOF</p>\n</li>\n<li><p>AOF</p>\n</li>\n<li><p>AOFflushallrewriteAOFflushallAOF</p>\n</li>\n</ul>\n<p>        <strong>AOF</strong></p>\n<ul>\n<li><p>AOFRDB</p>\n</li>\n<li><p>AOFQPSRDBQPSAOFfsyncfsync</p>\n</li>\n<li><p>AOFbugAOF</p>\n</li>\n</ul>\n<h4 id=\"5-\"><a href=\"#5-\" class=\"headerlink\" title=\"5. \"></a>5. </h4><p>        <strong>/ </strong>  Web  <strong></strong>/ redis <code>list</code>  <code>lpush</code>  <code>rpop</code>  <strong></strong> </p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdit62wmj30yg0ccgmp.jpg\" alt=\"image\"></p>\n<p>        <strong>Redis</strong><code>Publisher</code>  <code>Consumer</code> <strong></strong> <em>(channel)</em></p>\n<p><img src=\"https://tvax1.sinaimg.cn/large/006YzKDNly1gopdjtvehij30yg0cbmy0.jpg\" alt=\"image\"></p>\n<p> <code>Publisher</code>  <code>channel</code>  <code>channel</code>  <code>Consumer</code>  <strong></strong>  <strong></strong>  <strong></strong>  <strong></strong> </p>\n<p><strong>Redis</strong>  <strong></strong>  <strong>Pattern Subscribe</strong> <strong></strong> </p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdkll7gtj30yg0cb0ul.jpg\" alt=\"image\"></p>\n<p><strong></strong>  <strong><code>Consumer</code> </strong></p>\n<p><code>Publisher</code>  <code>wmyskxz.chat</code>  <code>channel</code>  <code>Consumer 1</code>  <code>Consumer 2</code>  <code>channel</code>  <code>wmyskxz.*</code>  <strong>Redis</strong>  <code>wmyskxz.*</code>  <code>Consumer 3</code>  <code>wmyskxz.log</code>  <code>Consumer 4</code>  <code>Consumer 5</code></p>\n<p> <code>wmyskxz.chat</code> <code>Consumer 3</code>   </p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a><em></em></h5><p> <strong>Redis</strong> <strong>PubSub</strong> </p>\n<figure class=\"highlight bash\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">SUBSCRIBE channel [channel ....]   <span class=\"comment\"># </span></span><br><span class=\"line\">PSUBSCRIBE pattern [pattern ....]  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">PUBLISH channel message  <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"comment\"># </span></span><br><span class=\"line\">UNSUBSCRIBE [channel [channel ....]]   <span class=\"comment\"># </span></span><br><span class=\"line\">PUNSUBSCRIBE [pattern [pattern ....]]  <span class=\"comment\">#</span></span><br></pre></td></tr></table></figure>\n\n<p> <strong>PubSub</strong></p>\n<p><img src=\"https://tvax2.sinaimg.cn/large/006YzKDNly1gopdlahl8sg30qq0cenpg.gif\" alt=\"\"></p>\n<p></p>\n<ol>\n<li> Redis </li>\n<li> <code>SUBSCRIBE wmyskxz.chat</code>  <code>wmyskxz.chat</code>  <strong></strong></li>\n<li> <code>PUBLISH wmyskxz.chat &#39;message&#39;</code>  <strong></strong> </li>\n</ol>\n<h4 id=\"6-\"><a href=\"#6-\" class=\"headerlink\" title=\"6. \"></a>6. </h4><p>        Java</p>\n<h4 id=\"7-\"><a href=\"#7-\" class=\"headerlink\" title=\"7.\"></a>7.</h4><p>        Redis</p>\n<h4 id=\"8--Master-SlaveRedis-Sentinel\"><a href=\"#8--Master-SlaveRedis-Sentinel\" class=\"headerlink\" title=\"8.-Master-SlaveRedis Sentinel\"></a>8.-Master-SlaveRedis Sentinel</h4><p>        3.0</p>\n<h3 id=\"-\"><a href=\"#-\" class=\"headerlink\" title=\".\"></a>.</h3><p><em> key  <code>:::</code></em></p>\n<h4 id=\"1-string\"><a href=\"#1-string\" class=\"headerlink\" title=\"1. string\"></a>1. string</h4><blockquote>\n<p> <code>.jpeg</code>  512 MB </p>\n</blockquote>\n<ul>\n<li><strong></strong></li>\n</ul>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key value</span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"value\"</span></span><br></pre></td></tr></table></figure>\n\n<p> key <code>SET</code> </p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key newValue</span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"newValue\"</span></span><br></pre></td></tr></table></figure>\n\n<p> <code>EXISTS</code>  <code>DEL</code> </p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; EXISTS <span class=\"type\">key</span></span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; DEL <span class=\"type\">key</span></span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<figure class=\"highlight gams\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"keyword\">SET</span> key1 <span class=\"comment\">value1</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; <span class=\"keyword\">SET</span> <span class=\"comment\">key2 value2</span></span><br><span class=\"line\">OK</span><br><span class=\"line\">&gt; MGET <span class=\"comment\">key1 key2 key3    #</span> </span><br><span class=\"line\">1) <span class=\"string\">\"value1\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"value2\"</span></span><br><span class=\"line\">3) (nil)</span><br><span class=\"line\">&gt; MSET <span class=\"comment\">key1 value1 key2 value2</span></span><br><span class=\"line\">&gt; MGET <span class=\"comment\">key1 key2</span></span><br><span class=\"line\">1) <span class=\"string\">\"value1\"</span></span><br><span class=\"line\">2) <span class=\"string\">\"value2\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong> SET </strong></li>\n</ul>\n<p> key <em>()</em></p>\n<figure class=\"highlight routeros\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; <span class=\"builtin-name\">SET</span> key value1</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\"><span class=\"string\">\"value1\"</span></span><br><span class=\"line\">&gt; EXPIRE name 5    # 5s </span><br><span class=\"line\"><span class=\"built_in\">..</span>.                #  5s</span><br><span class=\"line\">&gt; <span class=\"builtin-name\">GET</span> key</span><br><span class=\"line\">(<span class=\"literal\">nil</span>)</span><br></pre></td></tr></table></figure>\n\n<p> <code>SET</code> + <code>EXPIRE</code>  <code>SETEX</code> </p>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SETEX <span class=\"type\">key</span> <span class=\"number\">5</span> value1</span><br><span class=\"line\">...                #  <span class=\"number\">5</span>s </span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\">(nil)</span><br><span class=\"line\"></span><br><span class=\"line\">&gt; SETNX <span class=\"type\">key</span> value1  #  <span class=\"type\">key</span>  SET </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; SETNX <span class=\"type\">key</span> value1  #  <span class=\"type\">key</span>  SET </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">0</span></span><br><span class=\"line\">&gt; GET <span class=\"type\">key</span></span><br><span class=\"line\"><span class=\"string\">\"value\"</span>             # </span><br></pre></td></tr></table></figure>\n\n<ul>\n<li><strong></strong></li>\n</ul>\n<p> value  <code>INCR</code>  <strong></strong>  key </p>\n<figure class=\"highlight angelscript\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SET counter <span class=\"number\">100</span></span><br><span class=\"line\">&gt; INCR counter</span><br><span class=\"line\">(<span class=\"built_in\">int</span>eger) <span class=\"number\">101</span></span><br><span class=\"line\">&gt; INCRBY counter <span class=\"number\">50</span></span><br><span class=\"line\">(<span class=\"built_in\">int</span>eger) <span class=\"number\">151</span></span><br></pre></td></tr></table></figure>\n\n<h4 id=\"2-list\"><a href=\"#2-list\" class=\"headerlink\" title=\"2. list\"></a>2. list</h4><blockquote>\n<p>Redis  Java  <strong>LinkedList</strong> list  O(1) O(n)</p>\n</blockquote>\n<p><strong></strong></p>\n<ul>\n<li><code>LPUSH</code>  <code>RPUSH</code>  list </li>\n<li><code>LRANGE</code>  list </li>\n<li><code>LINDEX</code>  list  Java  <code>get(int index)</code> </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> rpush mylist A</span></span><br><span class=\"line\">(integer) 1</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> rpush mylist B</span></span><br><span class=\"line\">(integer) 2</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> lpush mylist first</span></span><br><span class=\"line\">(integer) 3</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> lrange mylist 0 -1    <span class=\"comment\"># -1 , </span></span></span><br><span class=\"line\">1) \"first\"</span><br><span class=\"line\">2) \"A\"</span><br><span class=\"line\">3) \"B\"</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>list </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPUSH books python java golang</span></span><br><span class=\"line\">(integer) 3</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"python\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"java\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">\"golang\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> LPOP books</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>list </li>\n</ul>\n<p></p>\n<figure class=\"highlight console\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPUSH books python java golang</span></span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"golang\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"java\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">\"python\"</span><br><span class=\"line\"><span class=\"meta\">&gt;</span><span class=\"bash\"> RPOP books</span></span><br><span class=\"line\">(nil)</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li>lrange </li>\n</ul>\n<h4 id=\"3-hash\"><a href=\"#3-hash\" class=\"headerlink\" title=\"3. hash\"></a>3. hash</h4><blockquote>\n<p>Redis  Java  <strong>HashMap</strong> <strong> + </strong>  <strong></strong></p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; HSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"think in java\"</span>    <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; HSET <span class=\"keyword\">books </span>python <span class=\"string\">\"python cookbook\"</span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; HGETALL <span class=\"keyword\">books </span>   <span class=\"comment\"># key  value </span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"python\"</span></span><br><span class=\"line\"><span class=\"number\">4</span>) <span class=\"string\">\"python cookbook\"</span></span><br><span class=\"line\">&gt; HGET <span class=\"keyword\">books </span><span class=\"keyword\">java</span></span><br><span class=\"line\"><span class=\"keyword\">\"think </span>in <span class=\"keyword\">java\"</span></span><br><span class=\"line\"><span class=\"keyword\">&gt; </span>HSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"head first java\"</span>  </span><br><span class=\"line\">(integer) <span class=\"number\">0</span>        <span class=\"comment\">#  0</span></span><br><span class=\"line\">&gt; HMSET <span class=\"keyword\">books </span><span class=\"keyword\">java </span><span class=\"string\">\"effetive  java\"</span> python <span class=\"string\">\"learning python\"</span>    <span class=\"comment\"># </span></span><br><span class=\"line\">OK</span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> CookieId  Key 30  Session </li>\n</ul>\n<h4 id=\"4-set\"><a href=\"#4-set\" class=\"headerlink\" title=\"4. set\"></a>4. set</h4><blockquote>\n<p>Redis  Java  <strong>HashSet</strong> value  NULL</p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight mipsasm\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span><span class=\"keyword\">java</span></span><br><span class=\"line\"><span class=\"keyword\">(integer) </span><span class=\"number\">1</span></span><br><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span><span class=\"keyword\">java </span>   <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">0</span></span><br><span class=\"line\">&gt; SADD <span class=\"keyword\">books </span>python golang</span><br><span class=\"line\">(integer) <span class=\"number\">2</span></span><br><span class=\"line\">&gt; SMEMBERS <span class=\"keyword\">books </span>   <span class=\"comment\"># set  </span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"python\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"golang\"</span></span><br><span class=\"line\">&gt; SISMEMBER <span class=\"keyword\">books </span><span class=\"keyword\">java </span>   <span class=\"comment\">#  value  contains</span></span><br><span class=\"line\">(integer) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; <span class=\"keyword\">SCARD </span><span class=\"keyword\">books </span>   <span class=\"comment\"># </span></span><br><span class=\"line\">(integer) <span class=\"number\">3</span></span><br><span class=\"line\">&gt; SPOP <span class=\"keyword\">books </span>    <span class=\"comment\"># </span></span><br><span class=\"line\"><span class=\"string\">\"java\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li></li>\n</ul>\n<h4 id=\"5-zset\"><a href=\"#5-zset\" class=\"headerlink\" title=\"5. zset\"></a>5. zset</h4><blockquote>\n<p> Redis  Java  <strong>SortedSet</strong>  <strong>HashMap</strong>  set value  value  score  <strong></strong> </p>\n</blockquote>\n<ul>\n<li></li>\n</ul>\n<figure class=\"highlight lsl\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br><span class=\"line\">19</span><br><span class=\"line\">20</span><br><span class=\"line\">21</span><br><span class=\"line\">22</span><br><span class=\"line\">23</span><br><span class=\"line\">24</span><br><span class=\"line\">25</span><br><span class=\"line\">26</span><br><span class=\"line\">27</span><br><span class=\"line\">28</span><br><span class=\"line\">29</span><br><span class=\"line\">30</span><br><span class=\"line\">31</span><br><span class=\"line\">32</span><br><span class=\"line\">33</span><br><span class=\"line\">34</span><br><span class=\"line\">35</span><br><span class=\"line\">36</span><br><span class=\"line\">37</span><br><span class=\"line\">38</span><br></pre></td><td class=\"code\"><pre><span class=\"line\">&gt; ZADD books <span class=\"number\">9.0</span> <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\">&gt; ZADD books <span class=\"number\">8.9</span> <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\">&gt; ZADD books <span class=\"number\">8.6</span> <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span>     #  score </span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZREVRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span>  #  score </span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"think in java\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZCARD books           #  count()</span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">3</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZSCORE books <span class=\"string\">\"java concurrency\"</span>   #  value  score</span><br><span class=\"line\"><span class=\"string\">\"8.9000000000000004\"</span>                #  score  double </span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANK books <span class=\"string\">\"java concurrency\"</span>    # </span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGEBYSCORE books <span class=\"number\">0</span> <span class=\"number\">8.91</span>        #  zset</span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZRANGEBYSCORE books -inf <span class=\"number\">8.91</span> withscores  #  (-, <span class=\"number\">8.91</span>]  zsetinf  infinite</span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"8.5999999999999996\"</span></span><br><span class=\"line\"><span class=\"number\">3</span>) <span class=\"string\">\"java concurrency\"</span></span><br><span class=\"line\"><span class=\"number\">4</span>) <span class=\"string\">\"8.9000000000000004\"</span></span><br><span class=\"line\"></span><br><span class=\"line\">&gt; ZREM books <span class=\"string\">\"java concurrency\"</span>             #  value</span><br><span class=\"line\">(<span class=\"type\">integer</span>) <span class=\"number\">1</span></span><br><span class=\"line\">&gt; ZRANGE books <span class=\"number\">0</span> <span class=\"number\">-1</span></span><br><span class=\"line\"><span class=\"number\">1</span>) <span class=\"string\">\"java cookbook\"</span></span><br><span class=\"line\"><span class=\"number\">2</span>) <span class=\"string\">\"think in java\"</span></span><br></pre></td></tr></table></figure>\n\n<ul>\n<li> TOP N </li>\n</ul>\n<h3 id=\"-Redis\"><a href=\"#-Redis\" class=\"headerlink\" title=\". Redis\"></a>. Redis</h3><h4 id=\"1-\"><a href=\"#1-\" class=\"headerlink\" title=\"1. \"></a>1. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>        </p>\n<p><strong></strong><strong></strong></p>\n<h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><ul>\n<li><p></p>\n<p>  <strong></strong></p>\n<blockquote>\n<p>1 <br>2A<br>3B<br>4B<br>5A</p>\n</blockquote>\n</li>\n<li><p></p>\n<p>  </p>\n<blockquote>\n<p>A<br>B<br>B<br>B<br>A</p>\n</blockquote>\n</li>\n<li><p></p>\n</li>\n</ul>\n<p><strong></strong></p>\n<h4 id=\"2-\"><a href=\"#2-\" class=\"headerlink\" title=\"2. \"></a>2. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>         key ID1ID</p>\n<h5 id=\"-1\"><a href=\"#-1\" class=\"headerlink\" title=\"\"></a></h5><ol>\n<li><p> key</p>\n<p>          key  Redis <code>SET key value EX 10086</code> key  key Redis  key  key  1  Java </p>\n</li>\n</ol>\n<figure class=\"highlight java\"><table><tr><td class=\"gutter\"><pre><span class=\"line\">1</span><br><span class=\"line\">2</span><br><span class=\"line\">3</span><br><span class=\"line\">4</span><br><span class=\"line\">5</span><br><span class=\"line\">6</span><br><span class=\"line\">7</span><br><span class=\"line\">8</span><br><span class=\"line\">9</span><br><span class=\"line\">10</span><br><span class=\"line\">11</span><br><span class=\"line\">12</span><br><span class=\"line\">13</span><br><span class=\"line\">14</span><br><span class=\"line\">15</span><br><span class=\"line\">16</span><br><span class=\"line\">17</span><br><span class=\"line\">18</span><br></pre></td><td class=\"code\"><pre><span class=\"line\"><span class=\"function\"><span class=\"keyword\">public</span> Object <span class=\"title\">getObjectInclNullById</span><span class=\"params\">(Integer id)</span> </span>&#123;</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    Object cacheValue = cache.get(id);</span><br><span class=\"line\">    <span class=\"comment\">// </span></span><br><span class=\"line\">    <span class=\"keyword\">if</span> (cacheValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        Object storageValue = storage.get(key);</span><br><span class=\"line\">        <span class=\"comment\">// </span></span><br><span class=\"line\">        cache.set(key, storageValue);</span><br><span class=\"line\">        <span class=\"comment\">// (300)</span></span><br><span class=\"line\">        <span class=\"keyword\">if</span> (storageValue == <span class=\"keyword\">null</span>) &#123;</span><br><span class=\"line\">            <span class=\"comment\">// </span></span><br><span class=\"line\">            cache.expire(key, <span class=\"number\">60</span> * <span class=\"number\">5</span>);</span><br><span class=\"line\">        &#125;</span><br><span class=\"line\">        <span class=\"keyword\">return</span> storageValue;</span><br><span class=\"line\">    &#125;</span><br><span class=\"line\">    <span class=\"keyword\">return</span> cacheValue;</span><br><span class=\"line\">&#125;</span><br></pre></td></tr></table></figure>\n\n<ol start=\"2\">\n<li><p></p>\n<p>          key </p>\n<p>          Key</p>\n<p>          <strong></strong></p>\n<hr>\n<p> <strong><em></em></strong>  </p>\n<p> <strong></strong></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> 1</p>\n</li>\n</ol>\n<p> <strong></strong></p>\n<ol>\n<li><p></p>\n</li>\n<li><p> 1 1 1</p>\n<p><strong></strong> </p>\n</li>\n</ol>\n</li>\n</ol>\n<h4 id=\"3-\"><a href=\"#3-\" class=\"headerlink\" title=\"3. \"></a>3. </h4><h5 id=\"\"><a href=\"#\" class=\"headerlink\" title=\"\"></a></h5><p>        <strong></strong> </p>\n<p>        </p>\n<p>        <strong></strong></p>\n<p>         12 Redis 12</p>\n<h5 id=\"-2\"><a href=\"#-2\" class=\"headerlink\" title=\"\"></a></h5><p>Redis</p>\n<ol>\n<li>Redis</li>\n<li></li>\n</ol>\n<p></p>\n<ol>\n<li></li>\n<li></li>\n</ol>\n"}],"PostAsset":[],"PostCategory":[{"post_id":"cl2bmweeb0006kh6zd7702xgt","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweeh000dkh6z6vpq9241"},{"post_id":"cl2bmwee40001kh6z293w8s5a","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweej000ikh6z2giwgpkw"},{"post_id":"cl2bmweec0007kh6z17ig31vz","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweel000lkh6z2hs22ayj"},{"post_id":"cl2bmweef000bkh6z2prkczq1","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweem000pkh6zap9aaa9d"},{"post_id":"cl2bmwee60002kh6z9x8b4zc0","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweeo000skh6z5kxeexe6"},{"post_id":"cl2bmweeh000ckh6z76kh03mb","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweep000xkh6z8gz84auz"},{"post_id":"cl2bmweej000hkh6zby3u6vtg","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweeq0010kh6z9fcn4xbg"},{"post_id":"cl2bmweea0005kh6zaxdvhck0","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwees0014kh6z8yti35i1"},{"post_id":"cl2bmweek000kkh6z63jgemaa","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwees0017kh6z2e3kcrpy"},{"post_id":"cl2bmween000rkh6za0jh3rau","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweet001akh6z5u5r0c2i"},{"post_id":"cl2bmweep000wkh6z4alr5exx","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweew001ekh6zhrav83xk"},{"post_id":"cl2bmweeq000zkh6z9bvm9cno","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweex001hkh6z3t0ickqc"},{"post_id":"cl2bmweem000okh6zbdy68yey","category_id":"cl2bmweeo000ukh6z0l8s55j0","_id":"cl2bmweey001lkh6z6q40dj35"},{"post_id":"cl2bmweer0013kh6z2aa01snt","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmweez001okh6zbctj6lia"},{"post_id":"cl2bmwees0016kh6z9am6emp7","category_id":"cl2bmweeo000ukh6z0l8s55j0","_id":"cl2bmwef0001qkh6z82im26pz"},{"post_id":"cl2bmweet0019kh6zf5oo7sm1","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwef0001skh6z42j93tih"},{"post_id":"cl2bmweeu001dkh6z4mmhhcm5","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwef0001ukh6z7zhc5zkk"},{"post_id":"cl2bmweew001gkh6z8jw4bi6t","category_id":"cl2bmweeo000ukh6z0l8s55j0","_id":"cl2bmwef1001wkh6zehvf6tqk"},{"post_id":"cl2bmweex001kkh6zaywq4uv2","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwef1001ykh6z9xmg8oz3"},{"post_id":"cl2bmweez001nkh6z0ci5gmnx","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwef10020kh6zfs3h1ufr"},{"post_id":"cl2bmwefh002hkh6zdhkxef79","category_id":"cl2bmwee80003kh6z960h3me2","_id":"cl2bmwefl002mkh6z9ztw5akv"}],"PostTag":[{"post_id":"cl2bmweeb0006kh6zd7702xgt","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweef000akh6z28x1ghod"},{"post_id":"cl2bmweef000bkh6z2prkczq1","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweei000gkh6z0jnx0qdu"},{"post_id":"cl2bmweef000bkh6z2prkczq1","tag_id":"cl2bmweed0009kh6z6fahgko7","_id":"cl2bmweek000jkh6z4gf35uwk"},{"post_id":"cl2bmwee40001kh6z293w8s5a","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweem000nkh6zdg9cgaqi"},{"post_id":"cl2bmwee40001kh6z293w8s5a","tag_id":"cl2bmweed0009kh6z6fahgko7","_id":"cl2bmween000qkh6z1t43b1g5"},{"post_id":"cl2bmweeh000ckh6z76kh03mb","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweep000vkh6z2fhl55ap"},{"post_id":"cl2bmweej000hkh6zby3u6vtg","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweeq000ykh6z1sqkbmut"},{"post_id":"cl2bmwee60002kh6z9x8b4zc0","tag_id":"cl2bmwee90004kh6z3wed5daw","_id":"cl2bmweer0011kh6zhbos3qy8"},{"post_id":"cl2bmweea0005kh6zaxdvhck0","tag_id":"cl2bmweel000mkh6zdki4g6rw","_id":"cl2bmwees0015kh6z6ze486lq"},{"post_id":"cl2bmweer0013kh6z2aa01snt","tag_id":"cl2bmweeo000tkh6z15mt3zsj","_id":"cl2bmweet0018kh6z2l9l2dyq"},{"post_id":"cl2bmweec0007kh6z17ig31vz","tag_id":"cl2bmweeo000tkh6z15mt3zsj","_id":"cl2bmweeu001ckh6z87f005s5"},{"post_id":"cl2bmweec0007kh6z17ig31vz","tag_id":"cl2bmweer0012kh6zg25pc261","_id":"cl2bmweew001fkh6zdv1k0kjq"},{"post_id":"cl2bmweeu001dkh6z4mmhhcm5","tag_id":"cl2bmweeo000tkh6z15mt3zsj","_id":"cl2bmweex001jkh6z56l790ap"},{"post_id":"cl2bmweek000kkh6z63jgemaa","tag_id":"cl2bmweet001bkh6zfnm14en8","_id":"cl2bmweey001mkh6z71ij4e4d"},{"post_id":"cl2bmweem000okh6zbdy68yey","tag_id":"cl2bmweex001ikh6zgveu1z5e","_id":"cl2bmwef0001rkh6z6tv89ipn"},{"post_id":"cl2bmween000rkh6za0jh3rau","tag_id":"cl2bmweez001pkh6zdtzl5lzi","_id":"cl2bmwef1001vkh6zhjqtgep3"},{"post_id":"cl2bmweep000wkh6z4alr5exx","tag_id":"cl2bmweez001pkh6zdtzl5lzi","_id":"cl2bmwef1001zkh6zdi1w9d61"},{"post_id":"cl2bmweeq000zkh6z9bvm9cno","tag_id":"cl2bmweez001pkh6zdtzl5lzi","_id":"cl2bmwef20022kh6z892nbvp1"},{"post_id":"cl2bmwees0016kh6z9am6emp7","tag_id":"cl2bmwef10021kh6z6xtz8r1q","_id":"cl2bmwef20024kh6z8tl16f4h"},{"post_id":"cl2bmweet0019kh6zf5oo7sm1","tag_id":"cl2bmwef20023kh6z7r925tdb","_id":"cl2bmwef30026kh6z06lgbtbv"},{"post_id":"cl2bmweew001gkh6z8jw4bi6t","tag_id":"cl2bmwef10021kh6z6xtz8r1q","_id":"cl2bmwef30028kh6zg9cp4sri"},{"post_id":"cl2bmweex001kkh6zaywq4uv2","tag_id":"cl2bmwef30027kh6z9qarhwmc","_id":"cl2bmwef4002ckh6zgqns9o77"},{"post_id":"cl2bmweex001kkh6zaywq4uv2","tag_id":"cl2bmwef30029kh6zbb788e2d","_id":"cl2bmwef4002dkh6zgq7t8hi9"},{"post_id":"cl2bmweex001kkh6zaywq4uv2","tag_id":"cl2bmwef3002akh6z1axhed5q","_id":"cl2bmwef4002ekh6z0lxc0x7f"},{"post_id":"cl2bmweex001kkh6zaywq4uv2","tag_id":"cl2bmweel000mkh6zdki4g6rw","_id":"cl2bmwef4002fkh6zeyn61dat"},{"post_id":"cl2bmweez001nkh6z0ci5gmnx","tag_id":"cl2bmwef4002bkh6z3l8ldj8p","_id":"cl2bmwef4002gkh6z1trv5g3b"},{"post_id":"cl2bmwefh002hkh6zdhkxef79","tag_id":"cl2bmwefk002kkh6z28tg629j","_id":"cl2bmwefn002pkh6z8zbzepa7"}],"Tag":[{"name":"algorithm","_id":"cl2bmwee90004kh6z3wed5daw"},{"name":"data structure","_id":"cl2bmweed0009kh6z6fahgko7"},{"name":"http","_id":"cl2bmweel000mkh6zdki4g6rw"},{"name":"IO","_id":"cl2bmweeo000tkh6z15mt3zsj"},{"name":"netty","_id":"cl2bmweer0012kh6zg25pc261"},{"name":"tools","_id":"cl2bmweet001bkh6zfnm14en8"},{"name":"map","_id":"cl2bmweex001ikh6zgveu1z5e"},{"name":"git","_id":"cl2bmweez001pkh6zdtzl5lzi"},{"name":"finance","_id":"cl2bmwef10021kh6z6xtz8r1q"},{"name":"nginx","_id":"cl2bmwef20023kh6z7r925tdb"},{"name":"java","_id":"cl2bmwef30027kh6z9qarhwmc"},{"name":"spring","_id":"cl2bmwef30029kh6zbb788e2d"},{"name":"mysql","_id":"cl2bmwef3002akh6z1axhed5q"},{"name":"source code","_id":"cl2bmwef4002bkh6z3l8ldj8p"},{"name":"redis","_id":"cl2bmwefk002kkh6z28tg629j"}]}}